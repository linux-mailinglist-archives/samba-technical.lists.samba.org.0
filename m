Return-Path: <samba-technical-bounces@lists.samba.org>
X-Original-To: lists+samba-technical@lfdr.de
Delivered-To: lists+samba-technical@lfdr.de
Received: from hr1.samba.org (hr1.samba.org [IPv6:2a01:4f8:192:486::1:0])
	by mail.lfdr.de (Postfix) with ESMTPS id B72D081CF92
	for <lists+samba-technical@lfdr.de>; Fri, 22 Dec 2023 22:53:44 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.samba.org; s=2954282; h=Cc:From:List-Id:To:Subject:Date;
	bh=3XHrjFecmyEVD+JdGZ7LnGc0MvM6n8AffIqjprDrGPM=; b=6Uf37V/wjk4plzPdhCWql+kO/t
	QfMboXR6IQDEjkBL33BSWgCy5KV6segzJw8N1bufY46Bi7SiHsJ6QFj8nmxA5muSunVtN0Rb3kNuU
	+LMUMKYDK8YLzxbuiIxJMdCFttCX0E9L9KIuQDNGAfGXWQC3EIf7NSZLVu2NxvL6p2xvzGyK0tFRr
	3qRH6mm8yQjtoKWk2wojEGtG7Lq7eM1udwCiPTvNJlCMS/ECsRNayUZMa9SEoJF8p3Yv6sdP5ANON
	040MJGydDJjE2jSYg1oiXOyU1vvw74qGXhl6tm7YJkrIHoa1Od5/BJzjYrOXsPr8oH8XoZIH1RJ+0
	fsEjIK/Q==;
Received: from ip6-localhost ([::1]:45692 helo=hr1.samba.org) 
	by hr1.samba.org with esmtp (Exim)
	id 1rGnS7-008ieW-H1; Fri, 22 Dec 2023 21:53:07 +0000
Received: from mail-lj1-x22c.google.com ([2a00:1450:4864:20::22c]:54492) 
 by hr1.samba.org with esmtps (TLS1.3:ECDHE_RSA_CHACHA20_POLY1305:256)
 (Exim) id 1rGnS0-008ieM-0P
 for samba-technical@lists.samba.org; Fri, 22 Dec 2023 21:53:05 +0000
Received: by mail-lj1-x22c.google.com with SMTP id
 38308e7fff4ca-2ccaf5955aeso7629321fa.0
 for <samba-technical@lists.samba.org>; Fri, 22 Dec 2023 13:52:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20230601; t=1703281978; x=1703886778; darn=lists.samba.org;
 h=cc:to:subject:message-id:date:from:mime-version:from:to:cc:subject
 :date:message-id:reply-to;
 bh=3XHrjFecmyEVD+JdGZ7LnGc0MvM6n8AffIqjprDrGPM=;
 b=es/becfBz0aASLULgiaeBd9FH12hFWuSg65kpLWHRAwCHLPnuBM+DmnA9zLAq8fho1
 ynuJxRqwXU/truVw8D8LsD7ZVOVh0+vTFXBrNlgBubjSbjY6+POgSAPbkzlIK1liKOiP
 CMTO18qnhGdTbEf+BXc9F7t2n2oXS5MRwPaElN3yKWzDoXaQR4w6v6zOn8BsK/5i1nOm
 qdqxnGfZf6s/llaGjwPSnJu16tnXQw/CI5DAnU/pzcD3kmNzT4YbGQtFZShxHNZrgDYw
 ULy6sLpeM3YOEM0hYenWZHGiTYbDtwuDfpkx+wOO1T9/WsnKMVLaZ3UnBz6zyJOR+RxQ
 ONmA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1703281978; x=1703886778;
 h=cc:to:subject:message-id:date:from:mime-version:x-gm-message-state
 :from:to:cc:subject:date:message-id:reply-to;
 bh=3XHrjFecmyEVD+JdGZ7LnGc0MvM6n8AffIqjprDrGPM=;
 b=k7fqbQ9kI72sQGhlwShhM14zDd5srNvrEKwyHI3LEG4heC/ih9lJbIY3GijcDIhZXk
 hqo8Jarib410sop4zOPKh356ll+wOpNafrnpcNVkXM7INd6Vi6jB7U56+uSrQolx/HLR
 trx3j5uI6Si5XdrgUQA0+VsCmqtNFtwykqdINvymknsYP8ECyenu234r2TR9dPPLmk4I
 VV/VpDM5B6eIcb+0Y+2V7cb3uL8HHWmH1/jNZGdC+zOPfhsTKfwX527NlUuVMAHhiZyv
 mpyGxSoEn3WLPL0/2ls+WaQcwiulNcO3VYJqcVkQwjcRzU9Zvnf4W97Cfi3SW4IlNG7d
 OLzw==
X-Gm-Message-State: AOJu0YxLQ3cpcX0aN2bE/qy4yRWeNVzhC5qWT9jglo6ZxXUfbxPl02RE
 DsS1dbNqWmxkSwWsx+VKK2uPGQyNkNlgtFK2/E7kcOefjYw=
X-Google-Smtp-Source: AGHT+IHZESqHFPwBwHj16Lql5FJYLSMmHktCPGNnmgaF522NGAkk79rvrPqBldRDAklq0qeDQeOilen3vS3CIPUusbM=
X-Received: by 2002:a2e:d11:0:b0:2cc:63e4:8852 with SMTP id
 17-20020a2e0d11000000b002cc63e48852mr889056ljn.70.1703281978147; Fri, 22 Dec
 2023 13:52:58 -0800 (PST)
MIME-Version: 1.0
Date: Fri, 22 Dec 2023 15:52:45 -0600
Message-ID: <CAH2r5msvdRk3A4VZNmHReKqb3JpCLO0JsPNB06ovjKSNqHwbmQ@mail.gmail.com>
Subject: Various reparse point and special file handling patches
To: samba-technical <samba-technical@lists.samba.org>,
 CIFS <linux-cifs@vger.kernel.org>
Content-Type: multipart/mixed; boundary="00000000000042b2a9060d203dce"
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
 subscribe to the list samba@lists.samba.org"
 <samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/options/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/pipermail/samba-technical/>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=subscribe>
From: Steve French via samba-technical <samba-technical@lists.samba.org>
Reply-To: Steve French <smfrench@gmail.com>
Cc: Paulo Alcantara <pc@manguebit.com>
Errors-To: samba-technical-bounces@lists.samba.org
Sender: "samba-technical" <samba-technical-bounces@lists.samba.org>

--00000000000042b2a9060d203dce
Content-Type: text/plain; charset="UTF-8"

I have updated cifs-2.6.git for-next with Paulo's updated versions of
his reparse point, symlink and special file handling patches (pending
additional testing and review of this series).  See attached.


76d03a1b24c3 (HEAD -> for-next, origin/for-next) smb: client: handle
special files and symlinks in SMB3 POSIX
e2e4f945ac39 smb: client: cleanup smb2_query_reparse_point()
5e29c5fefc03 smb: client: allow creating symlinks via reparse points
021686ce17c7 smb: client: fix hardlinking of reparse points
fe352ef91f90 smb: client: fix renaming of reparse points
cfb35128720b smb: client: optimise reparse point querying
8ed4bb748a02 smb: client: allow creating special files via reparse points
8a5c653c128f smb: client: extend smb2_compound_op() to accept more commands

-- 
Thanks,

Steve

--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0006-smb-client-allow-creating-symlinks-via-reparse-point.patch"
Content-Disposition: attachment; 
	filename="0006-smb-client-allow-creating-symlinks-via-reparse-point.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f562>
X-Attachment-Id: f_lqh63f562

RnJvbSA1ZTI5YzVmZWZjMDNhNjRiOTMyNDJkNTI2ZDE3MjE3MmY1ODBkOTUwIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDQgLTAzMDAKU3ViamVjdDogW1BBVENIIDYvOF0g
c21iOiBjbGllbnQ6IGFsbG93IGNyZWF0aW5nIHN5bWxpbmtzIHZpYSByZXBhcnNlIHBvaW50cwoK
QWRkIHN1cHBvcnQgZm9yIGNyZWF0aW5nIHN5bWxpbmtzIHZpYSBJT19SRVBBUlNFX1RBR19TWU1M
SU5LIHJlcGFyc2UKcG9pbnRzIGluIFNNQjIrLgoKVGhlc2UgYXJlIGZ1bGx5IHN1cHBvcnRlZCBi
eSBtb3N0IFNNQiBzZXJ2ZXJzIGFuZCBkb2N1bWVudGVkIGluCk1TLUZTQ0MuICBBbHNvIGhhdmUg
dGhlIGFkdmFudGFnZSBvZiByZXF1aXJpbmcgZmV3ZXIgcm91bmR0cmlwcyBhcwp0aGVpciBzeW1s
aW5rIHRhcmdldHMgY2FuIGJlIHBhcnNlZCBkaXJlY3RseSBmcm9tIENSRUFURSByZXNwb25zZXMg
b24KU1RBVFVTX1NUT1BQRURfT05fU1lNTElOSyBlcnJvcnMuCgpSZXBvcnRlZC1ieToga2VybmVs
IHRlc3Qgcm9ib3QgPGxrcEBpbnRlbC5jb20+CkNsb3NlczogaHR0cHM6Ly9sb3JlLmtlcm5lbC5v
cmcvb2Uta2J1aWxkLWFsbC8yMDIzMTEyNjA4Mzgubng1bWtqMWotbGtwQGludGVsLmNvbS8KU2ln
bmVkLW9mZi1ieTogUGF1bG8gQWxjYW50YXJhIChTVVNFKSA8cGNAbWFuZ3VlYml0LmNvbT4KLS0t
CiBmcy9zbWIvY2xpZW50L2NpZnNnbG9iLmggfCAgNiArKysrCiBmcy9zbWIvY2xpZW50L2xpbmsu
YyAgICAgfCAxNSArKysrKystLS0KIGZzL3NtYi9jbGllbnQvc21iMm9wcy5jICB8IDcwICsrKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwgODYg
aW5zZXJ0aW9ucygrKSwgNSBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50
L2NpZnNnbG9iLmggYi9mcy9zbWIvY2xpZW50L2NpZnNnbG9iLmgKaW5kZXggMzcyZGE3ZTg2NWIz
Li5iYTgwYzg1NGM5Y2EgMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaAorKysg
Yi9mcy9zbWIvY2xpZW50L2NpZnNnbG9iLmgKQEAgLTU3NCw2ICs1NzQsMTIgQEAgc3RydWN0IHNt
Yl92ZXJzaW9uX29wZXJhdGlvbnMgewogCWludCAoKnBhcnNlX3JlcGFyc2VfcG9pbnQpKHN0cnVj
dCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsCiAJCQkJICAgc3RydWN0IGt2ZWMgKnJzcF9pb3YsCiAJ
CQkJICAgc3RydWN0IGNpZnNfb3Blbl9pbmZvX2RhdGEgKmRhdGEpOworCWludCAoKmNyZWF0ZV9y
ZXBhcnNlX3N5bWxpbmspKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCQkJICAgICAgc3RydWN0
IGlub2RlICppbm9kZSwKKwkJCQkgICAgICBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksCisJCQkJICAg
ICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJCQkgICAgICBjb25zdCBjaGFyICpmdWxsX3Bh
dGgsCisJCQkJICAgICAgY29uc3QgY2hhciAqc3ltbmFtZSk7CiB9OwogCiBzdHJ1Y3Qgc21iX3Zl
cnNpb25fdmFsdWVzIHsKZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvbGluay5jIGIvZnMvc21i
L2NsaWVudC9saW5rLmMKaW5kZXggNjkxZjQzYTFlYzJiLi5kODZkYTk0OWE5MTkgMTAwNjQ0Ci0t
LSBhL2ZzL3NtYi9jbGllbnQvbGluay5jCisrKyBiL2ZzL3NtYi9jbGllbnQvbGluay5jCkBAIC01
NjksNiArNTY5LDcgQEAgY2lmc19zeW1saW5rKHN0cnVjdCBtbnRfaWRtYXAgKmlkbWFwLCBzdHJ1
Y3QgaW5vZGUgKmlub2RlLAogCWludCByYyA9IC1FT1BOT1RTVVBQOwogCXVuc2lnbmVkIGludCB4
aWQ7CiAJc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiA9IENJRlNfU0IoaW5vZGUtPmlfc2Ip
OworCXN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlcjsKIAlzdHJ1Y3QgdGNvbl9saW5rICp0
bGluazsKIAlzdHJ1Y3QgY2lmc190Y29uICpwVGNvbjsKIAljb25zdCBjaGFyICpmdWxsX3BhdGg7
CkBAIC01OTAsNiArNTkxLDcgQEAgY2lmc19zeW1saW5rKHN0cnVjdCBtbnRfaWRtYXAgKmlkbWFw
LCBzdHJ1Y3QgaW5vZGUgKmlub2RlLAogCQlnb3RvIHN5bWxpbmtfZXhpdDsKIAl9CiAJcFRjb24g
PSB0bGlua190Y29uKHRsaW5rKTsKKwlzZXJ2ZXIgPSBjaWZzX3BpY2tfY2hhbm5lbChwVGNvbi0+
c2VzKTsKIAogCWZ1bGxfcGF0aCA9IGJ1aWxkX3BhdGhfZnJvbV9kZW50cnkoZGlyZW50cnksIHBh
Z2UpOwogCWlmIChJU19FUlIoZnVsbF9wYXRoKSkgewpAQCAtNjAxLDE3ICs2MDMsMjAgQEAgY2lm
c19zeW1saW5rKHN0cnVjdCBtbnRfaWRtYXAgKmlkbWFwLCBzdHJ1Y3QgaW5vZGUgKmlub2RlLAog
CWNpZnNfZGJnKEZZSSwgInN5bW5hbWUgaXMgJXNcbiIsIHN5bW5hbWUpOwogCiAJLyogQkIgd2hh
dCBpZiBERlMgYW5kIHRoaXMgdm9sdW1lIGlzIG9uIGRpZmZlcmVudCBzaGFyZT8gQkIgKi8KLQlp
ZiAoY2lmc19zYi0+bW50X2NpZnNfZmxhZ3MgJiBDSUZTX01PVU5UX01GX1NZTUxJTktTKQorCWlm
IChjaWZzX3NiLT5tbnRfY2lmc19mbGFncyAmIENJRlNfTU9VTlRfTUZfU1lNTElOS1MpIHsKIAkJ
cmMgPSBjcmVhdGVfbWZfc3ltbGluayh4aWQsIHBUY29uLCBjaWZzX3NiLCBmdWxsX3BhdGgsIHN5
bW5hbWUpOwogI2lmZGVmIENPTkZJR19DSUZTX0FMTE9XX0lOU0VDVVJFX0xFR0FDWQotCWVsc2Ug
aWYgKHBUY29uLT51bml4X2V4dCkKKwl9IGVsc2UgaWYgKHBUY29uLT51bml4X2V4dCkgewogCQly
YyA9IENJRlNVbml4Q3JlYXRlU3ltTGluayh4aWQsIHBUY29uLCBmdWxsX3BhdGgsIHN5bW5hbWUs
CiAJCQkJCSAgIGNpZnNfc2ItPmxvY2FsX25scywKIAkJCQkJICAgY2lmc19yZW1hcChjaWZzX3Ni
KSk7CiAjZW5kaWYgLyogQ09ORklHX0NJRlNfQUxMT1dfSU5TRUNVUkVfTEVHQUNZICovCi0JLyog
ZWxzZQotCSAgIHJjID0gQ0lGU0NyZWF0ZVJlcGFyc2VTeW1MaW5rKHhpZCwgcFRjb24sIGZyb21O
YW1lLCB0b05hbWUsCi0JCQkJCWNpZnNfc2JfdGFyZ2V0LT5sb2NhbF9ubHMpOyAqLworCX0gZWxz
ZSBpZiAoc2VydmVyLT5vcHMtPmNyZWF0ZV9yZXBhcnNlX3N5bWxpbmspIHsKKwkJcmMgPSAgc2Vy
dmVyLT5vcHMtPmNyZWF0ZV9yZXBhcnNlX3N5bWxpbmsoeGlkLCBpbm9kZSwgZGlyZW50cnksCisJ
CQkJCQkJICBwVGNvbiwgZnVsbF9wYXRoLAorCQkJCQkJCSAgc3ltbmFtZSk7CisJCWdvdG8gc3lt
bGlua19leGl0OworCX0KIAogCWlmIChyYyA9PSAwKSB7CiAJCWlmIChwVGNvbi0+cG9zaXhfZXh0
ZW5zaW9ucykgewpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9zbWIyb3BzLmMgYi9mcy9zbWIv
Y2xpZW50L3NtYjJvcHMuYwppbmRleCA3NGZlNTcxMjE5NzkuLjg1YTZlNjdjNzNkYyAxMDA2NDQK
LS0tIGEvZnMvc21iL2NsaWVudC9zbWIyb3BzLmMKKysrIGIvZnMvc21iL2NsaWVudC9zbWIyb3Bz
LmMKQEAgLTUyMzUsNiArNTIzNSw3MiBAQCBzdGF0aWMgaW50IG5mc19tYWtlX25vZGUodW5zaWdu
ZWQgaW50IHhpZCwgc3RydWN0IGlub2RlICppbm9kZSwKIAlyZXR1cm4gcmM7CiB9CiAKK3N0YXRp
YyBpbnQgc21iMl9jcmVhdGVfcmVwYXJzZV9zeW1saW5rKGNvbnN0IHVuc2lnbmVkIGludCB4aWQs
CisJCQkJICAgICAgIHN0cnVjdCBpbm9kZSAqaW5vZGUsCisJCQkJICAgICAgIHN0cnVjdCBkZW50
cnkgKmRlbnRyeSwKKwkJCQkgICAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJCQkgICAg
ICAgY29uc3QgY2hhciAqZnVsbF9wYXRoLAorCQkJCSAgICAgICBjb25zdCBjaGFyICpzeW1uYW1l
KQoreworCXN0cnVjdCByZXBhcnNlX3N5bWxpbmtfZGF0YV9idWZmZXIgKmJ1ZiA9IE5VTEw7CisJ
c3RydWN0IGNpZnNfb3Blbl9pbmZvX2RhdGEgZGF0YTsKKwlzdHJ1Y3QgY2lmc19zYl9pbmZvICpj
aWZzX3NiID0gQ0lGU19TQihpbm9kZS0+aV9zYik7CisJc3RydWN0IGlub2RlICpuZXc7CisJc3Ry
dWN0IGt2ZWMgaW92OworCV9fbGUxNiAqcGF0aDsKKwljaGFyICpzeW07CisJdTE2IGxlbiwgcGxl
bjsKKwlpbnQgcmMgPSAwOworCisJc3ltID0ga3N0cmR1cChzeW1uYW1lLCBHRlBfS0VSTkVMKTsK
KwlpZiAoIXN5bSkKKwkJcmV0dXJuIC1FTk9NRU07CisKKwlkYXRhID0gKHN0cnVjdCBjaWZzX29w
ZW5faW5mb19kYXRhKSB7CisJCS5yZXBhcnNlX3BvaW50ID0gdHJ1ZSwKKwkJLnJlcGFyc2UgPSB7
IC50YWcgPSBJT19SRVBBUlNFX1RBR19TWU1MSU5LLCB9LAorCQkuc3ltbGlua190YXJnZXQgPSBz
eW0sCisJfTsKKworCXBhdGggPSBjaWZzX2NvbnZlcnRfcGF0aF90b191dGYxNihzeW1uYW1lLCBj
aWZzX3NiKTsKKwlpZiAoIXBhdGgpIHsKKwkJcmMgPSAtRU5PTUVNOworCQlnb3RvIG91dDsKKwl9
CisKKwlwbGVuID0gMiAqIFVuaVN0cm5sZW4oKHdjaGFyX3QgKilwYXRoLCBQQVRIX01BWCk7CisJ
bGVuID0gc2l6ZW9mKCpidWYpICsgcGxlbiAqIDI7CisJYnVmID0ga3phbGxvYyhsZW4sIEdGUF9L
RVJORUwpOworCWlmICghYnVmKSB7CisJCXJjID0gLUVOT01FTTsKKwkJZ290byBvdXQ7CisJfQor
CisJYnVmLT5SZXBhcnNlVGFnID0gY3B1X3RvX2xlMzIoSU9fUkVQQVJTRV9UQUdfU1lNTElOSyk7
CisJYnVmLT5SZXBhcnNlRGF0YUxlbmd0aCA9IGNwdV90b19sZTE2KGxlbiAtIHNpemVvZihzdHJ1
Y3QgcmVwYXJzZV9kYXRhX2J1ZmZlcikpOworCWJ1Zi0+U3Vic3RpdHV0ZU5hbWVPZmZzZXQgPSBj
cHVfdG9fbGUxNihwbGVuKTsKKwlidWYtPlN1YnN0aXR1dGVOYW1lTGVuZ3RoID0gY3B1X3RvX2xl
MTYocGxlbik7CisJbWVtY3B5KCZidWYtPlBhdGhCdWZmZXJbcGxlbl0sIHBhdGgsIHBsZW4pOwor
CWJ1Zi0+UHJpbnROYW1lT2Zmc2V0ID0gMDsKKwlidWYtPlByaW50TmFtZUxlbmd0aCA9IGNwdV90
b19sZTE2KHBsZW4pOworCW1lbWNweShidWYtPlBhdGhCdWZmZXIsIHBhdGgsIHBsZW4pOworCWJ1
Zi0+RmxhZ3MgPSBjcHVfdG9fbGUzMigqc3ltbmFtZSAhPSAnLycgPyBTWU1MSU5LX0ZMQUdfUkVM
QVRJVkUgOiAwKTsKKworCWlvdi5pb3ZfYmFzZSA9IGJ1ZjsKKwlpb3YuaW92X2xlbiA9IGxlbjsK
KwluZXcgPSBzbWIyX2dldF9yZXBhcnNlX2lub2RlKCZkYXRhLCBpbm9kZS0+aV9zYiwgeGlkLAor
CQkJCSAgICAgdGNvbiwgZnVsbF9wYXRoLCAmaW92KTsKKwlpZiAoIUlTX0VSUihuZXcpKQorCQlk
X2luc3RhbnRpYXRlKGRlbnRyeSwgbmV3KTsKKwllbHNlCisJCXJjID0gUFRSX0VSUihuZXcpOwor
b3V0OgorCWtmcmVlKHBhdGgpOworCWNpZnNfZnJlZV9vcGVuX2luZm8oJmRhdGEpOworCWtmcmVl
KGJ1Zik7CisJcmV0dXJuIHJjOworfQorCiBzdGF0aWMgaW50IHNtYjJfbWFrZV9ub2RlKHVuc2ln
bmVkIGludCB4aWQsIHN0cnVjdCBpbm9kZSAqaW5vZGUsCiAJCQkgIHN0cnVjdCBkZW50cnkgKmRl
bnRyeSwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCSAgY29uc3QgY2hhciAqZnVsbF9wYXRo
LCB1bW9kZV90IG1vZGUsIGRldl90IGRldikKQEAgLTUzMTEsNiArNTM3Nyw3IEBAIHN0cnVjdCBz
bWJfdmVyc2lvbl9vcGVyYXRpb25zIHNtYjIwX29wZXJhdGlvbnMgPSB7CiAJLnBhcnNlX3JlcGFy
c2VfcG9pbnQgPSBzbWIyX3BhcnNlX3JlcGFyc2VfcG9pbnQsCiAJLnF1ZXJ5X21mX3N5bWxpbmsg
PSBzbWIzX3F1ZXJ5X21mX3N5bWxpbmssCiAJLmNyZWF0ZV9tZl9zeW1saW5rID0gc21iM19jcmVh
dGVfbWZfc3ltbGluaywKKwkuY3JlYXRlX3JlcGFyc2Vfc3ltbGluayA9IHNtYjJfY3JlYXRlX3Jl
cGFyc2Vfc3ltbGluaywKIAkub3BlbiA9IHNtYjJfb3Blbl9maWxlLAogCS5zZXRfZmlkID0gc21i
Ml9zZXRfZmlkLAogCS5jbG9zZSA9IHNtYjJfY2xvc2VfZmlsZSwKQEAgLTU0MTMsNiArNTQ4MCw3
IEBAIHN0cnVjdCBzbWJfdmVyc2lvbl9vcGVyYXRpb25zIHNtYjIxX29wZXJhdGlvbnMgPSB7CiAJ
LnBhcnNlX3JlcGFyc2VfcG9pbnQgPSBzbWIyX3BhcnNlX3JlcGFyc2VfcG9pbnQsCiAJLnF1ZXJ5
X21mX3N5bWxpbmsgPSBzbWIzX3F1ZXJ5X21mX3N5bWxpbmssCiAJLmNyZWF0ZV9tZl9zeW1saW5r
ID0gc21iM19jcmVhdGVfbWZfc3ltbGluaywKKwkuY3JlYXRlX3JlcGFyc2Vfc3ltbGluayA9IHNt
YjJfY3JlYXRlX3JlcGFyc2Vfc3ltbGluaywKIAkub3BlbiA9IHNtYjJfb3Blbl9maWxlLAogCS5z
ZXRfZmlkID0gc21iMl9zZXRfZmlkLAogCS5jbG9zZSA9IHNtYjJfY2xvc2VfZmlsZSwKQEAgLTU1
MTgsNiArNTU4Niw3IEBAIHN0cnVjdCBzbWJfdmVyc2lvbl9vcGVyYXRpb25zIHNtYjMwX29wZXJh
dGlvbnMgPSB7CiAJLnBhcnNlX3JlcGFyc2VfcG9pbnQgPSBzbWIyX3BhcnNlX3JlcGFyc2VfcG9p
bnQsCiAJLnF1ZXJ5X21mX3N5bWxpbmsgPSBzbWIzX3F1ZXJ5X21mX3N5bWxpbmssCiAJLmNyZWF0
ZV9tZl9zeW1saW5rID0gc21iM19jcmVhdGVfbWZfc3ltbGluaywKKwkuY3JlYXRlX3JlcGFyc2Vf
c3ltbGluayA9IHNtYjJfY3JlYXRlX3JlcGFyc2Vfc3ltbGluaywKIAkub3BlbiA9IHNtYjJfb3Bl
bl9maWxlLAogCS5zZXRfZmlkID0gc21iMl9zZXRfZmlkLAogCS5jbG9zZSA9IHNtYjJfY2xvc2Vf
ZmlsZSwKQEAgLTU2MzIsNiArNTcwMSw3IEBAIHN0cnVjdCBzbWJfdmVyc2lvbl9vcGVyYXRpb25z
IHNtYjMxMV9vcGVyYXRpb25zID0gewogCS5wYXJzZV9yZXBhcnNlX3BvaW50ID0gc21iMl9wYXJz
ZV9yZXBhcnNlX3BvaW50LAogCS5xdWVyeV9tZl9zeW1saW5rID0gc21iM19xdWVyeV9tZl9zeW1s
aW5rLAogCS5jcmVhdGVfbWZfc3ltbGluayA9IHNtYjNfY3JlYXRlX21mX3N5bWxpbmssCisJLmNy
ZWF0ZV9yZXBhcnNlX3N5bWxpbmsgPSBzbWIyX2NyZWF0ZV9yZXBhcnNlX3N5bWxpbmssCiAJLm9w
ZW4gPSBzbWIyX29wZW5fZmlsZSwKIAkuc2V0X2ZpZCA9IHNtYjJfc2V0X2ZpZCwKIAkuY2xvc2Ug
PSBzbWIyX2Nsb3NlX2ZpbGUsCi0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0007-smb-client-cleanup-smb2_query_reparse_point.patch"
Content-Disposition: attachment; 
	filename="0007-smb-client-cleanup-smb2_query_reparse_point.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f541>
X-Attachment-Id: f_lqh63f541

RnJvbSBlMmU0Zjk0NWFjMzkzMGEwMTY3MGI3NjA1ZDk1MjllOWQxZmZhOWE5IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDggLTAzMDAKU3ViamVjdDogW1BBVENIIDcvOF0g
c21iOiBjbGllbnQ6IGNsZWFudXAgc21iMl9xdWVyeV9yZXBhcnNlX3BvaW50KCkKClVzZSBzbWIy
X2NvbXBvdW5kX29wKCkgd2l0aCBTTUIyX09QX0dFVF9SRVBBUlNFIHRvIGdldCByZXBhcnNlIHBv
aW50LgoKU2lnbmVkLW9mZi1ieTogUGF1bG8gQWxjYW50YXJhIChTVVNFKSA8cGNAbWFuZ3VlYml0
LmNvbT4KLS0tCiBmcy9zbWIvY2xpZW50L3NtYjJpbm9kZS5jIHwgIDMzICsrKysrKysrKwogZnMv
c21iL2NsaWVudC9zbWIyb3BzLmMgICB8IDEzOSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLQogZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaCB8ICAgNiArKwogMyBmaWxlcyBj
aGFuZ2VkLCAzOSBpbnNlcnRpb25zKCspLCAxMzkgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
ZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYyBiL2ZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMKaW5k
ZXggOTE5Zjc3OGJlODRkLi41MDUzYTU1NTBhYmUgMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQv
c21iMmlub2RlLmMKKysrIGIvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYwpAQCAtMTA1MywzICsx
MDUzLDM2IEBAIHN0cnVjdCBpbm9kZSAqc21iMl9nZXRfcmVwYXJzZV9pbm9kZShzdHJ1Y3QgY2lm
c19vcGVuX2luZm9fZGF0YSAqZGF0YSwKIAl9CiAJcmV0dXJuIHJjID8gRVJSX1BUUihyYykgOiBu
ZXc7CiB9CisKK2ludCBzbWIyX3F1ZXJ5X3JlcGFyc2VfcG9pbnQoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwKKwkJCSAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJCSAgICAgc3RydWN0IGNp
ZnNfc2JfaW5mbyAqY2lmc19zYiwKKwkJCSAgICAgY29uc3QgY2hhciAqZnVsbF9wYXRoLAorCQkJ
ICAgICB1MzIgKnRhZywgc3RydWN0IGt2ZWMgKnJzcCwKKwkJCSAgICAgaW50ICpyc3BfYnVmdHlw
ZSkKK3sKKwlzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSBkYXRhID0ge307CisJc3RydWN0IGNp
ZnNGaWxlSW5mbyAqY2ZpbGU7CisJc3RydWN0IGt2ZWMgaW5faW92ID0geyAuaW92X2Jhc2UgPSAm
ZGF0YSwgLmlvdl9sZW4gPSBzaXplb2YoZGF0YSksIH07CisJaW50IHJjOworCisJY2lmc19kYmco
RllJLCAiJXM6IHBhdGg6ICVzXG4iLCBfX2Z1bmNfXywgZnVsbF9wYXRoKTsKKworCWNpZnNfZ2V0
X3JlYWRhYmxlX3BhdGgodGNvbiwgZnVsbF9wYXRoLCAmY2ZpbGUpOworCXJjID0gc21iMl9jb21w
b3VuZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIGZ1bGxfcGF0aCwKKwkJCSAgICAgIEZJTEVfUkVB
RF9BVFRSSUJVVEVTLCBGSUxFX09QRU4sCisJCQkgICAgICBPUEVOX1JFUEFSU0VfUE9JTlQsIEFD
TF9OT19NT0RFLCAmaW5faW92LAorCQkJICAgICAgJihpbnQpe1NNQjJfT1BfR0VUX1JFUEFSU0V9
LCAxLCBjZmlsZSwKKwkJCSAgICAgIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwpOworCWlmIChyYykK
KwkJZ290byBvdXQ7CisKKwkqdGFnID0gZGF0YS5yZXBhcnNlLnRhZzsKKwkqcnNwID0gZGF0YS5y
ZXBhcnNlLmlvLmlvdjsKKwkqcnNwX2J1ZnR5cGUgPSBkYXRhLnJlcGFyc2UuaW8uYnVmdHlwZTsK
KwltZW1zZXQoJmRhdGEucmVwYXJzZS5pby5pb3YsIDAsIHNpemVvZihkYXRhLnJlcGFyc2UuaW8u
aW92KSk7CisJZGF0YS5yZXBhcnNlLmlvLmJ1ZnR5cGUgPSBDSUZTX05PX0JVRkZFUjsKK291dDoK
KwljaWZzX2ZyZWVfb3Blbl9pbmZvKCZkYXRhKTsKKwlyZXR1cm4gcmM7Cit9CmRpZmYgLS1naXQg
YS9mcy9zbWIvY2xpZW50L3NtYjJvcHMuYyBiL2ZzL3NtYi9jbGllbnQvc21iMm9wcy5jCmluZGV4
IDg1YTZlNjdjNzNkYy4uNDQxZDE0NGJkNzEyIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50L3Nt
YjJvcHMuYworKysgYi9mcy9zbWIvY2xpZW50L3NtYjJvcHMuYwpAQCAtMjk4NSwxNDUgKzI5ODUs
NiBAQCBzdGF0aWMgaW50IHNtYjJfcGFyc2VfcmVwYXJzZV9wb2ludChzdHJ1Y3QgY2lmc19zYl9p
bmZvICpjaWZzX3NiLAogCXJldHVybiBwYXJzZV9yZXBhcnNlX3BvaW50KGJ1ZiwgcGxlbiwgY2lm
c19zYiwgdHJ1ZSwgZGF0YSk7CiB9CiAKLXN0YXRpYyBpbnQgc21iMl9xdWVyeV9yZXBhcnNlX3Bv
aW50KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCi0JCQkJICAgIHN0cnVjdCBjaWZzX3Rjb24gKnRj
b24sCi0JCQkJICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsCi0JCQkJICAgIGNvbnN0
IGNoYXIgKmZ1bGxfcGF0aCwKLQkJCQkgICAgdTMyICp0YWcsIHN0cnVjdCBrdmVjICpyc3AsCi0J
CQkJICAgIGludCAqcnNwX2J1ZnR5cGUpCi17Ci0Jc3RydWN0IHNtYjJfY29tcG91bmRfdmFycyAq
dmFyczsKLQlpbnQgcmM7Ci0JX19sZTE2ICp1dGYxNl9wYXRoID0gTlVMTDsKLQlfX3U4IG9wbG9j
ayA9IFNNQjJfT1BMT0NLX0xFVkVMX05PTkU7Ci0Jc3RydWN0IGNpZnNfb3Blbl9wYXJtcyBvcGFy
bXM7Ci0Jc3RydWN0IGNpZnNfZmlkIGZpZDsKLQlzdHJ1Y3QgVENQX1NlcnZlcl9JbmZvICpzZXJ2
ZXIgPSBjaWZzX3BpY2tfY2hhbm5lbCh0Y29uLT5zZXMpOwotCWludCBmbGFncyA9IENJRlNfQ1Bf
Q1JFQVRFX0NMT1NFX09QOwotCXN0cnVjdCBzbWJfcnFzdCAqcnFzdDsKLQlpbnQgcmVzcF9idWZ0
eXBlWzNdOwotCXN0cnVjdCBrdmVjICpyc3BfaW92OwotCXN0cnVjdCBzbWIyX2lvY3RsX3JzcCAq
aW9jdGxfcnNwOwotCXN0cnVjdCByZXBhcnNlX2RhdGFfYnVmZmVyICpyZXBhcnNlX2J1ZjsKLQl1
MzIgb2ZmLCBjb3VudCwgbGVuOwotCi0JY2lmc19kYmcoRllJLCAiJXM6IHBhdGg6ICVzXG4iLCBf
X2Z1bmNfXywgZnVsbF9wYXRoKTsKLQotCWlmIChzbWIzX2VuY3J5cHRpb25fcmVxdWlyZWQodGNv
bikpCi0JCWZsYWdzIHw9IENJRlNfVFJBTlNGT1JNX1JFUTsKLQotCXV0ZjE2X3BhdGggPSBjaWZz
X2NvbnZlcnRfcGF0aF90b191dGYxNihmdWxsX3BhdGgsIGNpZnNfc2IpOwotCWlmICghdXRmMTZf
cGF0aCkKLQkJcmV0dXJuIC1FTk9NRU07Ci0KLQlyZXNwX2J1ZnR5cGVbMF0gPSByZXNwX2J1ZnR5
cGVbMV0gPSByZXNwX2J1ZnR5cGVbMl0gPSBDSUZTX05PX0JVRkZFUjsKLQl2YXJzID0ga3phbGxv
YyhzaXplb2YoKnZhcnMpLCBHRlBfS0VSTkVMKTsKLQlpZiAoIXZhcnMpIHsKLQkJcmMgPSAtRU5P
TUVNOwotCQlnb3RvIG91dF9mcmVlX3BhdGg7Ci0JfQotCXJxc3QgPSB2YXJzLT5ycXN0OwotCXJz
cF9pb3YgPSB2YXJzLT5yc3BfaW92OwotCi0JLyoKLQkgKiBzZXR1cCBzbWIyb3BlbiAtIFRPRE8g
YWRkIG9wdGltaXphdGlvbiB0byBjYWxsIGNpZnNfZ2V0X3JlYWRhYmxlX3BhdGgKLQkgKiB0byBz
ZWUgaWYgdGhlcmUgaXMgYSBoYW5kbGUgYWxyZWFkeSBvcGVuIHRoYXQgd2UgY2FuIHVzZQotCSAq
LwotCXJxc3RbMF0ucnFfaW92ID0gdmFycy0+b3Blbl9pb3Y7Ci0JcnFzdFswXS5ycV9udmVjID0g
U01CMl9DUkVBVEVfSU9WX1NJWkU7Ci0KLQlvcGFybXMgPSAoc3RydWN0IGNpZnNfb3Blbl9wYXJt
cykgewotCQkudGNvbiA9IHRjb24sCi0JCS5wYXRoID0gZnVsbF9wYXRoLAotCQkuZGVzaXJlZF9h
Y2Nlc3MgPSBGSUxFX1JFQURfQVRUUklCVVRFUywKLQkJLmRpc3Bvc2l0aW9uID0gRklMRV9PUEVO
LAotCQkuY3JlYXRlX29wdGlvbnMgPSBjaWZzX2NyZWF0ZV9vcHRpb25zKGNpZnNfc2IsIE9QRU5f
UkVQQVJTRV9QT0lOVCksCi0JCS5maWQgPSAmZmlkLAotCX07Ci0KLQlyYyA9IFNNQjJfb3Blbl9p
bml0KHRjb24sIHNlcnZlciwKLQkJCSAgICAmcnFzdFswXSwgJm9wbG9jaywgJm9wYXJtcywgdXRm
MTZfcGF0aCk7Ci0JaWYgKHJjKQotCQlnb3RvIHF1ZXJ5X3JwX2V4aXQ7Ci0Jc21iMl9zZXRfbmV4
dF9jb21tYW5kKHRjb24sICZycXN0WzBdKTsKLQotCi0JLyogSU9DVEwgKi8KLQlycXN0WzFdLnJx
X2lvdiA9IHZhcnMtPmlvX2lvdjsKLQlycXN0WzFdLnJxX252ZWMgPSBTTUIyX0lPQ1RMX0lPVl9T
SVpFOwotCi0JcmMgPSBTTUIyX2lvY3RsX2luaXQodGNvbiwgc2VydmVyLAotCQkJICAgICAmcnFz
dFsxXSwgQ09NUE9VTkRfRklELAotCQkJICAgICBDT01QT1VORF9GSUQsIEZTQ1RMX0dFVF9SRVBB
UlNFX1BPSU5ULCBOVUxMLCAwLAotCQkJICAgICBDSUZTTWF4QnVmU2l6ZSAtCi0JCQkgICAgIE1B
WF9TTUIyX0NSRUFURV9SRVNQT05TRV9TSVpFIC0KLQkJCSAgICAgTUFYX1NNQjJfQ0xPU0VfUkVT
UE9OU0VfU0laRSk7Ci0JaWYgKHJjKQotCQlnb3RvIHF1ZXJ5X3JwX2V4aXQ7Ci0KLQlzbWIyX3Nl
dF9uZXh0X2NvbW1hbmQodGNvbiwgJnJxc3RbMV0pOwotCXNtYjJfc2V0X3JlbGF0ZWQoJnJxc3Rb
MV0pOwotCi0JLyogQ2xvc2UgKi8KLQlycXN0WzJdLnJxX2lvdiA9ICZ2YXJzLT5jbG9zZV9pb3Y7
Ci0JcnFzdFsyXS5ycV9udmVjID0gMTsKLQotCXJjID0gU01CMl9jbG9zZV9pbml0KHRjb24sIHNl
cnZlciwKLQkJCSAgICAgJnJxc3RbMl0sIENPTVBPVU5EX0ZJRCwgQ09NUE9VTkRfRklELCBmYWxz
ZSk7Ci0JaWYgKHJjKQotCQlnb3RvIHF1ZXJ5X3JwX2V4aXQ7Ci0KLQlzbWIyX3NldF9yZWxhdGVk
KCZycXN0WzJdKTsKLQotCXJjID0gY29tcG91bmRfc2VuZF9yZWN2KHhpZCwgdGNvbi0+c2VzLCBz
ZXJ2ZXIsCi0JCQkJZmxhZ3MsIDMsIHJxc3QsCi0JCQkJcmVzcF9idWZ0eXBlLCByc3BfaW92KTsK
LQotCWlvY3RsX3JzcCA9IHJzcF9pb3ZbMV0uaW92X2Jhc2U7Ci0KLQkvKgotCSAqIE9wZW4gd2Fz
IHN1Y2Nlc3NmdWwgYW5kIHdlIGdvdCBhbiBpb2N0bCByZXNwb25zZS4KLQkgKi8KLQlpZiAocmMg
PT0gMCkgewotCQkvKiBTZWUgTVMtRlNDQyAyLjMuMjMgKi8KLQkJb2ZmID0gbGUzMl90b19jcHUo
aW9jdGxfcnNwLT5PdXRwdXRPZmZzZXQpOwotCQljb3VudCA9IGxlMzJfdG9fY3B1KGlvY3RsX3Jz
cC0+T3V0cHV0Q291bnQpOwotCQlpZiAoY2hlY2tfYWRkX292ZXJmbG93KG9mZiwgY291bnQsICZs
ZW4pIHx8Ci0JCSAgICBsZW4gPiByc3BfaW92WzFdLmlvdl9sZW4pIHsKLQkJCWNpZnNfdGNvbl9k
YmcoVkZTLCAiJXM6IGludmFsaWQgaW9jdGw6IG9mZj0lZCBjb3VudD0lZFxuIiwKLQkJCQkgICAg
ICBfX2Z1bmNfXywgb2ZmLCBjb3VudCk7Ci0JCQlyYyA9IC1FSU87Ci0JCQlnb3RvIHF1ZXJ5X3Jw
X2V4aXQ7Ci0JCX0KLQotCQlyZXBhcnNlX2J1ZiA9ICh2b2lkICopKCh1OCAqKWlvY3RsX3JzcCAr
IG9mZik7Ci0JCWxlbiA9IHNpemVvZigqcmVwYXJzZV9idWYpOwotCQlpZiAoY291bnQgPCBsZW4g
fHwKLQkJICAgIGNvdW50IDwgbGUxNl90b19jcHUocmVwYXJzZV9idWYtPlJlcGFyc2VEYXRhTGVu
Z3RoKSArIGxlbikgewotCQkJY2lmc190Y29uX2RiZyhWRlMsICIlczogaW52YWxpZCBpb2N0bDog
b2ZmPSVkIGNvdW50PSVkXG4iLAotCQkJCSAgICAgIF9fZnVuY19fLCBvZmYsIGNvdW50KTsKLQkJ
CXJjID0gLUVJTzsKLQkJCWdvdG8gcXVlcnlfcnBfZXhpdDsKLQkJfQotCQkqdGFnID0gbGUzMl90
b19jcHUocmVwYXJzZV9idWYtPlJlcGFyc2VUYWcpOwotCQkqcnNwID0gcnNwX2lvdlsxXTsKLQkJ
KnJzcF9idWZ0eXBlID0gcmVzcF9idWZ0eXBlWzFdOwotCQlyZXNwX2J1ZnR5cGVbMV0gPSBDSUZT
X05PX0JVRkZFUjsKLQl9Ci0KLSBxdWVyeV9ycF9leGl0OgotCVNNQjJfb3Blbl9mcmVlKCZycXN0
WzBdKTsKLQlTTUIyX2lvY3RsX2ZyZWUoJnJxc3RbMV0pOwotCVNNQjJfY2xvc2VfZnJlZSgmcnFz
dFsyXSk7Ci0JZnJlZV9yc3BfYnVmKHJlc3BfYnVmdHlwZVswXSwgcnNwX2lvdlswXS5pb3ZfYmFz
ZSk7Ci0JZnJlZV9yc3BfYnVmKHJlc3BfYnVmdHlwZVsxXSwgcnNwX2lvdlsxXS5pb3ZfYmFzZSk7
Ci0JZnJlZV9yc3BfYnVmKHJlc3BfYnVmdHlwZVsyXSwgcnNwX2lvdlsyXS5pb3ZfYmFzZSk7Ci0J
a2ZyZWUodmFycyk7Ci1vdXRfZnJlZV9wYXRoOgotCWtmcmVlKHV0ZjE2X3BhdGgpOwotCXJldHVy
biByYzsKLX0KLQogc3RhdGljIHN0cnVjdCBjaWZzX250c2QgKgogZ2V0X3NtYjJfYWNsX2J5X2Zp
ZChzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLAogCQkgICAgY29uc3Qgc3RydWN0IGNpZnNf
ZmlkICpjaWZzZmlkLCB1MzIgKnBhY2xsZW4sIHUzMiBpbmZvKQpkaWZmIC0tZ2l0IGEvZnMvc21i
L2NsaWVudC9zbWIycHJvdG8uaCBiL2ZzL3NtYi9jbGllbnQvc21iMnByb3RvLmgKaW5kZXggZWZh
MmY4ZmUyMzQ0Li4xZTIwZjg3YTVmNTggMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvc21iMnBy
b3RvLmgKKysrIGIvZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaApAQCAtNjIsNiArNjIsMTIgQEAg
c3RydWN0IGlub2RlICpzbWIyX2dldF9yZXBhcnNlX2lub2RlKHN0cnVjdCBjaWZzX29wZW5faW5m
b19kYXRhICpkYXRhLAogCQkJCSAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCQkgICAg
IGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKIAkJCQkgICAgIHN0cnVjdCBrdmVjICppb3YpOworaW50
IHNtYjJfcXVlcnlfcmVwYXJzZV9wb2ludChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAorCQkJICAg
ICBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCQkJICAgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpj
aWZzX3NiLAorCQkJICAgICBjb25zdCBjaGFyICpmdWxsX3BhdGgsCisJCQkgICAgIHUzMiAqdGFn
LCBzdHJ1Y3Qga3ZlYyAqcnNwLAorCQkJICAgICBpbnQgKnJzcF9idWZ0eXBlKTsKIGludCBzbWIy
X3F1ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCQkJIHN0cnVjdCBjaWZz
X3Rjb24gKnRjb24sCiAJCQkgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwKLS0gCjIuNDAu
MQoK
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0005-smb-client-fix-hardlinking-of-reparse-points.patch"
Content-Disposition: attachment; 
	filename="0005-smb-client-fix-hardlinking-of-reparse-points.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f5b3>
X-Attachment-Id: f_lqh63f5b3

RnJvbSAwMjE2ODZjZTE3Yzc2NTgxNzNmM2M3YzRiNjQyYTU5ZDc1ZTI5MWZlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDcgLTAzMDAKU3ViamVjdDogW1BBVENIIDUvOF0g
c21iOiBjbGllbnQ6IGZpeCBoYXJkbGlua2luZyBvZiByZXBhcnNlIHBvaW50cwoKVGhlIGNsaWVu
dCB3YXMgc2VuZGluZyBhbiBTTUIyX0NSRUFURSByZXF1ZXN0IHdpdGhvdXQgc2V0dGluZwpPUEVO
X1JFUEFSU0VfUE9JTlQgZmxhZyB0aHVzIGZhaWxpbmcgdGhlIGVudGlyZSBoYXJkbGluayBvcGVy
YXRpb24uCgpGaXggdGhpcyBieSBzZXR0aW5nIE9QRU5fUkVQQVJTRV9QT0lOVCBpbiBjcmVhdGUg
b3B0aW9ucyBmb3IKU01CMl9DUkVBVEUgcmVxdWVzdCB3aGVuIHRoZSBzb3VyY2UgaW5vZGUgaXMg
YSByZXBhc2UgcG9pbnQuCgpTaWduZWQtb2ZmLWJ5OiBQYXVsbyBBbGNhbnRhcmEgKFNVU0UpIDxw
Y0BtYW5ndWViaXQuY29tPgotLS0KIGZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaCAgfCAgOCArKysr
Ky0tLQogZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaCB8ICA4ICsrKysrLS0tCiBmcy9zbWIvY2xp
ZW50L2NpZnNzbWIuYyAgIHwgIDkgKysrKystLS0tCiBmcy9zbWIvY2xpZW50L2xpbmsuYyAgICAg
IHwgIDQgKystLQogZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYyB8IDMzICsrKysrKysrKysrKysr
KysrKysrKy0tLS0tLS0tLS0tLQogZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaCB8ICA4ICsrKysr
LS0tCiA2IGZpbGVzIGNoYW5nZWQsIDQzIGluc2VydGlvbnMoKyksIDI3IGRlbGV0aW9ucygtKQoK
ZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaCBiL2ZzL3NtYi9jbGllbnQvY2lm
c2dsb2IuaAppbmRleCA0NWYxMWNiNjNmYTguLjM3MmRhN2U4NjViMyAxMDA2NDQKLS0tIGEvZnMv
c21iL2NsaWVudC9jaWZzZ2xvYi5oCisrKyBiL2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaApAQCAt
NDA1LDkgKzQwNSwxMSBAQCBzdHJ1Y3Qgc21iX3ZlcnNpb25fb3BlcmF0aW9ucyB7CiAJCSAgICAg
IGNvbnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hhciAqdG9fbmFtZSwKIAkJICAgICAgc3Ry
dWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYik7CiAJLyogc2VuZCBjcmVhdGUgaGFyZGxpbmsgcmVx
dWVzdCAqLwotCWludCAoKmNyZWF0ZV9oYXJkbGluaykoY29uc3QgdW5zaWduZWQgaW50LCBzdHJ1
Y3QgY2lmc190Y29uICosCi0JCQkgICAgICAgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosCi0J
CQkgICAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqKTsKKwlpbnQgKCpjcmVhdGVfaGFyZGxpbmsp
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCQkgICAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNv
biwKKwkJCSAgICAgICBzdHJ1Y3QgZGVudHJ5ICpzb3VyY2VfZGVudHJ5LAorCQkJICAgICAgIGNv
bnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hhciAqdG9fbmFtZSwKKwkJCSAgICAgICBzdHJ1
Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiKTsKIAkvKiBxdWVyeSBzeW1saW5rIHRhcmdldCAqLwog
CWludCAoKnF1ZXJ5X3N5bWxpbmspKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJCQkgICAgIHN0
cnVjdCBjaWZzX3Rjb24gKnRjb24sCmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L2NpZnNwcm90
by5oIGIvZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaAppbmRleCBlNjgwZmU0NmQ0ZTguLmFmYmFi
ODYzMzFhMSAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaAorKysgYi9mcy9z
bWIvY2xpZW50L2NpZnNwcm90by5oCkBAIC00NDcsOSArNDQ3LDExIEBAIGV4dGVybiBpbnQgQ0lG
U1NNQlJlbmFtZU9wZW5GaWxlKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rj
b24gKnRjb24sCiAJCQkJIGludCBuZXRmaWQsIGNvbnN0IGNoYXIgKnRhcmdldF9uYW1lLAogCQkJ
CSBjb25zdCBzdHJ1Y3QgbmxzX3RhYmxlICpubHNfY29kZXBhZ2UsCiAJCQkJIGludCByZW1hcF9z
cGVjaWFsX2NoYXJzKTsKLWV4dGVybiBpbnQgQ0lGU0NyZWF0ZUhhcmRMaW5rKGNvbnN0IHVuc2ln
bmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCi0JCQkgICAgICBjb25zdCBjaGFy
ICpmcm9tX25hbWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCi0JCQkgICAgICBzdHJ1Y3QgY2lmc19z
Yl9pbmZvICpjaWZzX3NiKTsKK2ludCBDSUZTQ3JlYXRlSGFyZExpbmsoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwKKwkJICAgICAgIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJCSAgICAgICBzdHJ1
Y3QgZGVudHJ5ICpzb3VyY2VfZGVudHJ5LAorCQkgICAgICAgY29uc3QgY2hhciAqZnJvbV9uYW1l
LCBjb25zdCBjaGFyICp0b19uYW1lLAorCQkgICAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lm
c19zYik7CiBleHRlcm4gaW50IENJRlNVbml4Q3JlYXRlSGFyZExpbmsoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwKIAkJCXN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCQljb25zdCBjaGFyICpmcm9t
TmFtZSwgY29uc3QgY2hhciAqdG9OYW1lLApkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9jaWZz
c21iLmMgYi9mcy9zbWIvY2xpZW50L2NpZnNzbWIuYwppbmRleCA1YmRlYTAxOTE5ZTguLmU5ZTMz
YjBiM2FjNCAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9jaWZzc21iLmMKKysrIGIvZnMvc21i
L2NsaWVudC9jaWZzc21iLmMKQEAgLTI1MzAsMTAgKzI1MzAsMTEgQEAgQ0lGU1VuaXhDcmVhdGVI
YXJkTGluayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAog
CXJldHVybiByYzsKIH0KIAotaW50Ci1DSUZTQ3JlYXRlSGFyZExpbmsoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKLQkJICAgY29uc3QgY2hhciAqZnJvbV9u
YW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAotCQkgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZz
X3NiKQoraW50IENJRlNDcmVhdGVIYXJkTGluayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAorCQkg
ICAgICAgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKKwkJICAgICAgIHN0cnVjdCBkZW50cnkgKnNv
dXJjZV9kZW50cnksCisJCSAgICAgICBjb25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIg
KnRvX25hbWUsCisJCSAgICAgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiKQogewogCWlu
dCByYyA9IDA7CiAJTlRfUkVOQU1FX1JFUSAqcFNNQiA9IE5VTEw7CmRpZmYgLS1naXQgYS9mcy9z
bWIvY2xpZW50L2xpbmsuYyBiL2ZzL3NtYi9jbGllbnQvbGluay5jCmluZGV4IDVjZTBmNzRiZTRl
Yy4uNjkxZjQzYTFlYzJiIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50L2xpbmsuYworKysgYi9m
cy9zbWIvY2xpZW50L2xpbmsuYwpAQCAtNTEwLDggKzUxMCw4IEBAIGNpZnNfaGFyZGxpbmsoc3Ry
dWN0IGRlbnRyeSAqb2xkX2ZpbGUsIHN0cnVjdCBpbm9kZSAqaW5vZGUsCiAJCQlyYyA9IC1FTk9T
WVM7CiAJCQlnb3RvIGNpZnNfaGxfZXhpdDsKIAkJfQotCQlyYyA9IHNlcnZlci0+b3BzLT5jcmVh
dGVfaGFyZGxpbmsoeGlkLCB0Y29uLCBmcm9tX25hbWUsIHRvX25hbWUsCi0JCQkJCQkgIGNpZnNf
c2IpOworCQlyYyA9IHNlcnZlci0+b3BzLT5jcmVhdGVfaGFyZGxpbmsoeGlkLCB0Y29uLCBvbGRf
ZmlsZSwKKwkJCQkJCSAgZnJvbV9uYW1lLCB0b19uYW1lLCBjaWZzX3NiKTsKIAkJaWYgKChyYyA9
PSAtRUlPKSB8fCAocmMgPT0gLUVJTlZBTCkpCiAJCQlyYyA9IC1FT1BOT1RTVVBQOwogCX0KZGlm
ZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMgYi9mcy9zbWIvY2xpZW50L3NtYjJp
bm9kZS5jCmluZGV4IDJkOWNkYzE5NDQwMy4uOTE5Zjc3OGJlODRkIDEwMDY0NAotLS0gYS9mcy9z
bWIvY2xpZW50L3NtYjJpbm9kZS5jCisrKyBiL2ZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMKQEAg
LTQ0LDYgKzQ0LDE4IEBAIHN0YXRpYyBzdHJ1Y3QgcmVwYXJzZV9kYXRhX2J1ZmZlciAqcmVwYXJz
ZV9idWZfcHRyKHN0cnVjdCBrdmVjICppb3YpCiAJcmV0dXJuIGJ1ZjsKIH0KIAorc3RhdGljIGlu
bGluZSBfX3UzMiBmaWxlX2NyZWF0ZV9vcHRpb25zKHN0cnVjdCBkZW50cnkgKmRlbnRyeSkKK3sK
KwlzdHJ1Y3QgY2lmc0lub2RlSW5mbyAqY2k7CisKKwlpZiAoZGVudHJ5KSB7CisJCWNpID0gQ0lG
U19JKGRfaW5vZGUoZGVudHJ5KSk7CisJCWlmIChjaS0+Y2lmc0F0dHJzICYgQVRUUl9SRVBBUlNF
KQorCQkJcmV0dXJuIE9QRU5fUkVQQVJTRV9QT0lOVDsKKwl9CisJcmV0dXJuIDA7Cit9CisKIC8q
CiAgKiBub3RlOiBJZiBjZmlsZSBpcyBwYXNzZWQsIHRoZSByZWZlcmVuY2UgdG8gaXQgaXMgZHJv
cHBlZCBoZXJlLgogICogU28gbWFrZSBzdXJlIHRoYXQgeW91IGRvIG5vdCByZXVzZSBjZmlsZSBh
ZnRlciByZXR1cm4gZnJvbSB0aGlzIGZ1bmMuCkBAIC05MjAsMTUgKzkzMiw5IEBAIGludCBzbWIy
X3JlbmFtZV9wYXRoKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJCSAgICAgY29uc3QgY2hhciAq
ZnJvbV9uYW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAogCQkgICAgIHN0cnVjdCBjaWZzX3NiX2lu
Zm8gKmNpZnNfc2IpCiB7Ci0Jc3RydWN0IGNpZnNJbm9kZUluZm8gKmNpOwogCXN0cnVjdCBjaWZz
RmlsZUluZm8gKmNmaWxlOwotCV9fdTMyIGNvID0gMDsKKwlfX3UzMiBjbyA9IGZpbGVfY3JlYXRl
X29wdGlvbnMoc291cmNlX2RlbnRyeSk7CiAKLQlpZiAoc291cmNlX2RlbnRyeSkgewotCQljaSA9
IENJRlNfSShkX2lub2RlKHNvdXJjZV9kZW50cnkpKTsKLQkJaWYgKGNpLT5jaWZzQXR0cnMgJiBB
VFRSX1JFUEFSU0UpCi0JCQljbyB8PSBPUEVOX1JFUEFSU0VfUE9JTlQ7Ci0JfQogCWRyb3BfY2Fj
aGVkX2Rpcl9ieV9uYW1lKHhpZCwgdGNvbiwgZnJvbV9uYW1lLCBjaWZzX3NiKTsKIAljaWZzX2dl
dF93cml0YWJsZV9wYXRoKHRjb24sIGZyb21fbmFtZSwgRklORF9XUl9XSVRIX0RFTEVURSwgJmNm
aWxlKTsKIApAQCAtOTM2LDEzICs5NDIsMTYgQEAgaW50IHNtYjJfcmVuYW1lX3BhdGgoY29uc3Qg
dW5zaWduZWQgaW50IHhpZCwKIAkJCQkgIGNvLCBERUxFVEUsIFNNQjJfT1BfUkVOQU1FLCBjZmls
ZSk7CiB9CiAKLWludAotc21iMl9jcmVhdGVfaGFyZGxpbmsoY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKLQkJICAgICBjb25zdCBjaGFyICpmcm9tX25hbWUs
IGNvbnN0IGNoYXIgKnRvX25hbWUsCi0JCSAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19z
YikKK2ludCBzbWIyX2NyZWF0ZV9oYXJkbGluayhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAorCQkJ
IHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJCQkgc3RydWN0IGRlbnRyeSAqc291cmNlX2RlbnRy
eSwKKwkJCSBjb25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCisJCQkg
c3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYikKIHsKKwlfX3UzMiBjbyA9IGZpbGVfY3JlYXRl
X29wdGlvbnMoc291cmNlX2RlbnRyeSk7CisKIAlyZXR1cm4gc21iMl9zZXRfcGF0aF9hdHRyKHhp
ZCwgdGNvbiwgZnJvbV9uYW1lLCB0b19uYW1lLAotCQkJCSAgY2lmc19zYiwgMCwgRklMRV9SRUFE
X0FUVFJJQlVURVMsCisJCQkJICBjaWZzX3NiLCBjbywgRklMRV9SRUFEX0FUVFJJQlVURVMsCiAJ
CQkJICBTTUIyX09QX0hBUkRMSU5LLCBOVUxMKTsKIH0KIApkaWZmIC0tZ2l0IGEvZnMvc21iL2Ns
aWVudC9zbWIycHJvdG8uaCBiL2ZzL3NtYi9jbGllbnQvc21iMnByb3RvLmgKaW5kZXggYWVmNTAz
MTY2NzBhLi5lZmEyZjhmZTIzNDQgMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvc21iMnByb3Rv
LmgKKysrIGIvZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaApAQCAtOTEsOSArOTEsMTEgQEAgaW50
IHNtYjJfcmVuYW1lX3BhdGgoY29uc3QgdW5zaWduZWQgaW50IHhpZCwKIAkJICAgICBzdHJ1Y3Qg
ZGVudHJ5ICpzb3VyY2VfZGVudHJ5LAogCQkgICAgIGNvbnN0IGNoYXIgKmZyb21fbmFtZSwgY29u
c3QgY2hhciAqdG9fbmFtZSwKIAkJICAgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiKTsK
LWV4dGVybiBpbnQgc21iMl9jcmVhdGVfaGFyZGxpbmsoY29uc3QgdW5zaWduZWQgaW50IHhpZCwg
c3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKLQkJCQljb25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0
IGNoYXIgKnRvX25hbWUsCi0JCQkJc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYik7CitpbnQg
c21iMl9jcmVhdGVfaGFyZGxpbmsoY29uc3QgdW5zaWduZWQgaW50IHhpZCwKKwkJCSBzdHJ1Y3Qg
Y2lmc190Y29uICp0Y29uLAorCQkJIHN0cnVjdCBkZW50cnkgKnNvdXJjZV9kZW50cnksCisJCQkg
Y29uc3QgY2hhciAqZnJvbV9uYW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAorCQkJIHN0cnVjdCBj
aWZzX3NiX2luZm8gKmNpZnNfc2IpOwogZXh0ZXJuIGludCBzbWIzX2NyZWF0ZV9tZl9zeW1saW5r
KHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCQlzdHJ1Y3QgY2lm
c19zYl9pbmZvICpjaWZzX3NiLCBjb25zdCB1bnNpZ25lZCBjaGFyICpwYXRoLAogCQkJY2hhciAq
cGJ1ZiwgdW5zaWduZWQgaW50ICpwYnl0ZXNfd3JpdHRlbik7Ci0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0008-smb-client-handle-special-files-and-symlinks-in-SMB3.patch"
Content-Disposition: attachment; 
	filename="0008-smb-client-handle-special-files-and-symlinks-in-SMB3.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f4w0>
X-Attachment-Id: f_lqh63f4w0

RnJvbSA3NmQwM2ExYjI0YzMwNzNlNDYxMTlkZGQyOTkyZWMzMTljNTEyYWQ1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFR1ZSwgMjggTm92IDIwMjMgMTg6MjM6MzMgLTAzMDAKU3ViamVjdDogW1BBVENIIDgvOF0g
c21iOiBjbGllbnQ6IGhhbmRsZSBzcGVjaWFsIGZpbGVzIGFuZCBzeW1saW5rcyBpbiBTTUIzCiBQ
T1NJWAoKUGFyc2UgcmVwYXJzZSBwb2ludHMgaW4gU01CMyBwb3NpeCBxdWVyeSBpbmZvIGFzIHRo
ZXkgd2lsbCBiZQpzdXBwb3J0ZWQgYW5kIHJlcXVpcmVkIGJ5IHRoZSBuZXcgc3BlY2lmaWNhdGlv
bi4KClNpZ25lZC1vZmYtYnk6IFBhdWxvIEFsY2FudGFyYSAoU1VTRSkgPHBjQG1hbmd1ZWJpdC5j
b20+Ci0tLQogZnMvc21iL2NsaWVudC9pbm9kZS5jIHwgNTAgKysrKysrKysrKysrKysrKysrKysr
KysrKy0tLS0tLS0tLS0tLS0tLS0tLQogMSBmaWxlIGNoYW5nZWQsIDI5IGluc2VydGlvbnMoKyks
IDIxIGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvaW5vZGUuYyBiL2Zz
L3NtYi9jbGllbnQvaW5vZGUuYwppbmRleCBjYzRjMTQ0ZWE0MGEuLmM1MzJhYTYzYTY1OCAxMDA2
NDQKLS0tIGEvZnMvc21iL2NsaWVudC9pbm9kZS5jCisrKyBiL2ZzL3NtYi9jbGllbnQvaW5vZGUu
YwpAQCAtNjkxLDI5ICs2OTEsMzYgQEAgc3RhdGljIHZvaWQgc21iMzExX3Bvc2l4X2luZm9fdG9f
ZmF0dHIoc3RydWN0IGNpZnNfZmF0dHIgKmZhdHRyLAogCQlmYXR0ci0+Y2ZfbXRpbWUudHZfc2Vj
ICs9IHRjb24tPnNlcy0+c2VydmVyLT50aW1lQWRqOwogCX0KIAorCS8qCisJICogVGhlIHNydiBm
cyBkZXZpY2UgaWQgaXMgb3ZlcnJpZGRlbiBvbiBuZXR3b3JrIG1vdW50IHNvIHNldHRpbmcKKwkg
KiBAZmF0dHItPmNmX3JkZXYgaXNuJ3QgbmVlZGVkIGhlcmUuCisJICovCiAJZmF0dHItPmNmX2Vv
ZiA9IGxlNjRfdG9fY3B1KGluZm8tPkVuZE9mRmlsZSk7CiAJZmF0dHItPmNmX2J5dGVzID0gbGU2
NF90b19jcHUoaW5mby0+QWxsb2NhdGlvblNpemUpOwogCWZhdHRyLT5jZl9jcmVhdGV0aW1lID0g
bGU2NF90b19jcHUoaW5mby0+Q3JlYXRpb25UaW1lKTsKLQogCWZhdHRyLT5jZl9ubGluayA9IGxl
MzJfdG9fY3B1KGluZm8tPkhhcmRMaW5rcyk7CiAJZmF0dHItPmNmX21vZGUgPSAodW1vZGVfdCkg
bGUzMl90b19jcHUoaW5mby0+TW9kZSk7Ci0JLyogVGhlIHNydiBmcyBkZXZpY2UgaWQgaXMgb3Zl
cnJpZGRlbiBvbiBuZXR3b3JrIG1vdW50IHNvIHNldHRpbmcgcmRldiBpc24ndCBuZWVkZWQgaGVy
ZSAqLwotCS8qIGZhdHRyLT5jZl9yZGV2ID0gbGUzMl90b19jcHUoaW5mby0+RGV2aWNlSWQpOyAq
LwogCi0JaWYgKGRhdGEtPnN5bWxpbmspIHsKLQkJZmF0dHItPmNmX21vZGUgfD0gU19JRkxOSzsK
LQkJZmF0dHItPmNmX2R0eXBlID0gRFRfTE5LOwotCQlmYXR0ci0+Y2Zfc3ltbGlua190YXJnZXQg
PSBkYXRhLT5zeW1saW5rX3RhcmdldDsKLQkJZGF0YS0+c3ltbGlua190YXJnZXQgPSBOVUxMOwot
CX0gZWxzZSBpZiAoZmF0dHItPmNmX2NpZnNhdHRycyAmIEFUVFJfRElSRUNUT1JZKSB7CisJaWYg
KGNpZnNfb3Blbl9kYXRhX3JlcGFyc2UoZGF0YSkgJiYKKwkgICAgY2lmc19yZXBhcnNlX3BvaW50
X3RvX2ZhdHRyKGNpZnNfc2IsIGZhdHRyLCBkYXRhKSkKKwkJZ290byBvdXRfcmVwYXJzZTsKKwor
CWZhdHRyLT5jZl9tb2RlICY9IH5TX0lGTVQ7CisJaWYgKGZhdHRyLT5jZl9jaWZzYXR0cnMgJiBB
VFRSX0RJUkVDVE9SWSkgewogCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGRElSOwogCQlmYXR0ci0+
Y2ZfZHR5cGUgPSBEVF9ESVI7CiAJfSBlbHNlIHsgLyogZmlsZSAqLwogCQlmYXR0ci0+Y2ZfbW9k
ZSB8PSBTX0lGUkVHOwogCQlmYXR0ci0+Y2ZfZHR5cGUgPSBEVF9SRUc7CiAJfQotCS8qIGVsc2Ug
aWYgcmVwYXJzZSBwb2ludCAuLi4gVE9ETzogYWRkIHN1cHBvcnQgZm9yIEZJRk8gYW5kIGJsayBk
ZXY7IHNwZWNpYWwgZmlsZSB0eXBlcyAqLwogCitvdXRfcmVwYXJzZToKKwlpZiAoU19JU0xOSyhm
YXR0ci0+Y2ZfbW9kZSkpIHsKKwkJaWYgKGxpa2VseShkYXRhLT5zeW1saW5rX3RhcmdldCkpCisJ
CQlmYXR0ci0+Y2ZfZW9mID0gc3RybmxlbihkYXRhLT5zeW1saW5rX3RhcmdldCwgUEFUSF9NQVgp
OworCQlmYXR0ci0+Y2Zfc3ltbGlua190YXJnZXQgPSBkYXRhLT5zeW1saW5rX3RhcmdldDsKKwkJ
ZGF0YS0+c3ltbGlua190YXJnZXQgPSBOVUxMOworCX0KIAlzaWRfdG9faWQoY2lmc19zYiwgb3du
ZXIsIGZhdHRyLCBTSURPV05FUik7CiAJc2lkX3RvX2lkKGNpZnNfc2IsIGdyb3VwLCBmYXR0ciwg
U0lER1JPVVApOwogCkBAIC03MzgsMjUgKzc0NSwyNSBAQCBib29sIGNpZnNfcmVwYXJzZV9wb2lu
dF90b19mYXR0cihzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLAogCWlmICh0YWcgPT0gSU9f
UkVQQVJTRV9UQUdfTkZTICYmIGJ1ZikgewogCQlzd2l0Y2ggKGxlNjRfdG9fY3B1KGJ1Zi0+SW5v
ZGVUeXBlKSkgewogCQljYXNlIE5GU19TUEVDRklMRV9DSFI6Ci0JCQlmYXR0ci0+Y2ZfbW9kZSB8
PSBTX0lGQ0hSIHwgY2lmc19zYi0+Y3R4LT5maWxlX21vZGU7CisJCQlmYXR0ci0+Y2ZfbW9kZSB8
PSBTX0lGQ0hSOwogCQkJZmF0dHItPmNmX2R0eXBlID0gRFRfQ0hSOwogCQkJZmF0dHItPmNmX3Jk
ZXYgPSBuZnNfbWtkZXYoYnVmKTsKIAkJCWJyZWFrOwogCQljYXNlIE5GU19TUEVDRklMRV9CTEs6
Ci0JCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGQkxLIHwgY2lmc19zYi0+Y3R4LT5maWxlX21vZGU7
CisJCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGQkxLOwogCQkJZmF0dHItPmNmX2R0eXBlID0gRFRf
QkxLOwogCQkJZmF0dHItPmNmX3JkZXYgPSBuZnNfbWtkZXYoYnVmKTsKIAkJCWJyZWFrOwogCQlj
YXNlIE5GU19TUEVDRklMRV9GSUZPOgotCQkJZmF0dHItPmNmX21vZGUgfD0gU19JRklGTyB8IGNp
ZnNfc2ItPmN0eC0+ZmlsZV9tb2RlOworCQkJZmF0dHItPmNmX21vZGUgfD0gU19JRklGTzsKIAkJ
CWZhdHRyLT5jZl9kdHlwZSA9IERUX0ZJRk87CiAJCQlicmVhazsKIAkJY2FzZSBORlNfU1BFQ0ZJ
TEVfU09DSzoKLQkJCWZhdHRyLT5jZl9tb2RlIHw9IFNfSUZTT0NLIHwgY2lmc19zYi0+Y3R4LT5m
aWxlX21vZGU7CisJCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGU09DSzsKIAkJCWZhdHRyLT5jZl9k
dHlwZSA9IERUX1NPQ0s7CiAJCQlicmVhazsKIAkJY2FzZSBORlNfU1BFQ0ZJTEVfTE5LOgotCQkJ
ZmF0dHItPmNmX21vZGUgPSBTX0lGTE5LIHwgY2lmc19zYi0+Y3R4LT5maWxlX21vZGU7CisJCQlm
YXR0ci0+Y2ZfbW9kZSB8PSBTX0lGTE5LOwogCQkJZmF0dHItPmNmX2R0eXBlID0gRFRfTE5LOwog
CQkJYnJlYWs7CiAJCWRlZmF1bHQ6CkBAIC03NjgsMjkgKzc3NSwyOSBAQCBib29sIGNpZnNfcmVw
YXJzZV9wb2ludF90b19mYXR0cihzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLAogCiAJc3dp
dGNoICh0YWcpIHsKIAljYXNlIElPX1JFUEFSU0VfVEFHX0xYX1NZTUxJTks6Ci0JCWZhdHRyLT5j
Zl9tb2RlIHw9IFNfSUZMTksgfCBjaWZzX3NiLT5jdHgtPmZpbGVfbW9kZTsKKwkJZmF0dHItPmNm
X21vZGUgfD0gU19JRkxOSzsKIAkJZmF0dHItPmNmX2R0eXBlID0gRFRfTE5LOwogCQlicmVhazsK
IAljYXNlIElPX1JFUEFSU0VfVEFHX0xYX0ZJRk86Ci0JCWZhdHRyLT5jZl9tb2RlIHw9IFNfSUZJ
Rk8gfCBjaWZzX3NiLT5jdHgtPmZpbGVfbW9kZTsKKwkJZmF0dHItPmNmX21vZGUgfD0gU19JRklG
TzsKIAkJZmF0dHItPmNmX2R0eXBlID0gRFRfRklGTzsKIAkJYnJlYWs7CiAJY2FzZSBJT19SRVBB
UlNFX1RBR19BRl9VTklYOgotCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGU09DSyB8IGNpZnNfc2It
PmN0eC0+ZmlsZV9tb2RlOworCQlmYXR0ci0+Y2ZfbW9kZSB8PSBTX0lGU09DSzsKIAkJZmF0dHIt
PmNmX2R0eXBlID0gRFRfU09DSzsKIAkJYnJlYWs7CiAJY2FzZSBJT19SRVBBUlNFX1RBR19MWF9D
SFI6Ci0JCWZhdHRyLT5jZl9tb2RlIHw9IFNfSUZDSFIgfCBjaWZzX3NiLT5jdHgtPmZpbGVfbW9k
ZTsKKwkJZmF0dHItPmNmX21vZGUgfD0gU19JRkNIUjsKIAkJZmF0dHItPmNmX2R0eXBlID0gRFRf
Q0hSOwogCQlicmVhazsKIAljYXNlIElPX1JFUEFSU0VfVEFHX0xYX0JMSzoKLQkJZmF0dHItPmNm
X21vZGUgfD0gU19JRkJMSyB8IGNpZnNfc2ItPmN0eC0+ZmlsZV9tb2RlOworCQlmYXR0ci0+Y2Zf
bW9kZSB8PSBTX0lGQkxLOwogCQlmYXR0ci0+Y2ZfZHR5cGUgPSBEVF9CTEs7CiAJCWJyZWFrOwog
CWNhc2UgMDogLyogU01CMSBzeW1saW5rICovCiAJY2FzZSBJT19SRVBBUlNFX1RBR19TWU1MSU5L
OgogCWNhc2UgSU9fUkVQQVJTRV9UQUdfTkZTOgotCQlmYXR0ci0+Y2ZfbW9kZSA9IFNfSUZMTksg
fCBjaWZzX3NiLT5jdHgtPmZpbGVfbW9kZTsKKwkJZmF0dHItPmNmX21vZGUgfD0gU19JRkxOSzsK
IAkJZmF0dHItPmNmX2R0eXBlID0gRFRfTE5LOwogCQlicmVhazsKIAlkZWZhdWx0OgpAQCAtODMw
LDYgKzgzNyw3IEBAIHN0YXRpYyB2b2lkIGNpZnNfb3Blbl9pbmZvX3RvX2ZhdHRyKHN0cnVjdCBj
aWZzX2ZhdHRyICpmYXR0ciwKIAlmYXR0ci0+Y2ZfY3JlYXRldGltZSA9IGxlNjRfdG9fY3B1KGlu
Zm8tPkNyZWF0aW9uVGltZSk7CiAJZmF0dHItPmNmX25saW5rID0gbGUzMl90b19jcHUoaW5mby0+
TnVtYmVyT2ZMaW5rcyk7CiAKKwlmYXR0ci0+Y2ZfbW9kZSA9IGNpZnNfc2ItPmN0eC0+ZmlsZV9t
b2RlOwogCWlmIChjaWZzX29wZW5fZGF0YV9yZXBhcnNlKGRhdGEpICYmCiAJICAgIGNpZnNfcmVw
YXJzZV9wb2ludF90b19mYXR0cihjaWZzX3NiLCBmYXR0ciwgZGF0YSkpCiAJCWdvdG8gb3V0X3Jl
cGFyc2U7Ci0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0004-smb-client-fix-renaming-of-reparse-points.patch"
Content-Disposition: attachment; 
	filename="0004-smb-client-fix-renaming-of-reparse-points.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f5e4>
X-Attachment-Id: f_lqh63f5e4

RnJvbSBmZTM1MmVmOTFmOTBmNjBhZTNlNjRjNjYzMDNlYWRjMjc2MWRlZWJjIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDYgLTAzMDAKU3ViamVjdDogW1BBVENIIDQvOF0g
c21iOiBjbGllbnQ6IGZpeCByZW5hbWluZyBvZiByZXBhcnNlIHBvaW50cwoKVGhlIGNsaWVudCB3
YXMgc2VuZGluZyBhbiBTTUIyX0NSRUFURSByZXF1ZXN0IHdpdGhvdXQgc2V0dGluZwpPUEVOX1JF
UEFSU0VfUE9JTlQgZmxhZyB0aHVzIGZhaWxpbmcgdGhlIGVudGlyZSByZW5hbWUgb3BlcmF0aW9u
LgoKRml4IHRoaXMgYnkgc2V0dGluZyBPUEVOX1JFUEFSU0VfUE9JTlQgaW4gY3JlYXRlIG9wdGlv
bnMgZm9yClNNQjJfQ1JFQVRFIHJlcXVlc3Qgd2hlbiB0aGUgc291cmNlIGlub2RlIGlzIGEgcmVw
YXNlIHBvaW50LgoKU2lnbmVkLW9mZi1ieTogUGF1bG8gQWxjYW50YXJhIChTVVNFKSA8cGNAbWFu
Z3VlYml0LmNvbT4KLS0tCiBmcy9zbWIvY2xpZW50L2NpZnNnbG9iLmggIHwgMjIgKysrKysrKysr
KysrKysrKystLS0tLQogZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaCB8ICA3ICsrKystLS0KIGZz
L3NtYi9jbGllbnQvY2lmc3NtYi5jICAgfCAgOCArKysrLS0tLQogZnMvc21iL2NsaWVudC9pbm9k
ZS5jICAgICB8ICAzICsrLQogZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYyB8IDM4ICsrKysrKysr
KysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tCiBmcy9zbWIvY2xpZW50L3NtYjJwcm90by5o
IHwgIDggKysrKystLS0KIDYgZmlsZXMgY2hhbmdlZCwgNTUgaW5zZXJ0aW9ucygrKSwgMzEgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9jaWZzZ2xvYi5oIGIvZnMvc21i
L2NsaWVudC9jaWZzZ2xvYi5oCmluZGV4IDgxMGQ5MjljMDE5MC4uNDVmMTFjYjYzZmE4IDEwMDY0
NAotLS0gYS9mcy9zbWIvY2xpZW50L2NpZnNnbG9iLmgKKysrIGIvZnMvc21iL2NsaWVudC9jaWZz
Z2xvYi5oCkBAIC0yMTAsOSArMjEwLDE4IEBAIHN0cnVjdCBjaWZzX29wZW5faW5mb19kYXRhIHsK
IAl9OwogfTsKIAotI2RlZmluZSBjaWZzX29wZW5fZGF0YV9yZXBhcnNlKGQpIFwKLQkoKGQpLT5y
ZXBhcnNlX3BvaW50IHx8IFwKLQkgKGxlMzJfdG9fY3B1KChkKS0+ZmkuQXR0cmlidXRlcykgJiBB
VFRSX1JFUEFSU0UpKQorc3RhdGljIGlubGluZSBib29sIGNpZnNfb3Blbl9kYXRhX3JlcGFyc2Uo
c3RydWN0IGNpZnNfb3Blbl9pbmZvX2RhdGEgKmRhdGEpCit7CisJc3RydWN0IHNtYjJfZmlsZV9h
bGxfaW5mbyAqZmkgPSAmZGF0YS0+Zmk7CisJdTMyIGF0dHJzID0gbGUzMl90b19jcHUoZmktPkF0
dHJpYnV0ZXMpOworCWJvb2wgcmV0OworCisJcmV0ID0gZGF0YS0+cmVwYXJzZV9wb2ludCB8fCAo
YXR0cnMgJiBBVFRSX1JFUEFSU0UpOworCWlmIChyZXQpCisJCWF0dHJzIHw9IEFUVFJfUkVQQVJT
RTsKKwlmaS0+QXR0cmlidXRlcyA9IGNwdV90b19sZTMyKGF0dHJzKTsKKwlyZXR1cm4gcmV0Owor
fQogCiAvKgogICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCkBAIC0zOTAsOCArMzk5LDExIEBAIHN0cnVjdCBzbWJfdmVyc2lv
bl9vcGVyYXRpb25zIHsKIAlpbnQgKCpyZW5hbWVfcGVuZGluZ19kZWxldGUpKGNvbnN0IGNoYXIg
Kiwgc3RydWN0IGRlbnRyeSAqLAogCQkJCSAgICAgY29uc3QgdW5zaWduZWQgaW50KTsKIAkvKiBz
ZW5kIHJlbmFtZSByZXF1ZXN0ICovCi0JaW50ICgqcmVuYW1lKShjb25zdCB1bnNpZ25lZCBpbnQs
IHN0cnVjdCBjaWZzX3Rjb24gKiwgY29uc3QgY2hhciAqLAotCQkgICAgICBjb25zdCBjaGFyICos
IHN0cnVjdCBjaWZzX3NiX2luZm8gKik7CisJaW50ICgqcmVuYW1lKShjb25zdCB1bnNpZ25lZCBp
bnQgeGlkLAorCQkgICAgICBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCQkgICAgICBzdHJ1Y3Qg
ZGVudHJ5ICpzb3VyY2VfZGVudHJ5LAorCQkgICAgICBjb25zdCBjaGFyICpmcm9tX25hbWUsIGNv
bnN0IGNoYXIgKnRvX25hbWUsCisJCSAgICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2Ip
OwogCS8qIHNlbmQgY3JlYXRlIGhhcmRsaW5rIHJlcXVlc3QgKi8KIAlpbnQgKCpjcmVhdGVfaGFy
ZGxpbmspKGNvbnN0IHVuc2lnbmVkIGludCwgc3RydWN0IGNpZnNfdGNvbiAqLAogCQkJICAgICAg
IGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLApkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9j
aWZzcHJvdG8uaCBiL2ZzL3NtYi9jbGllbnQvY2lmc3Byb3RvLmgKaW5kZXggNGM1ZDUzM2Q5OGEz
Li5lNjgwZmU0NmQ0ZTggMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvY2lmc3Byb3RvLmgKKysr
IGIvZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaApAQCAtNDM5LDkgKzQzOSwxMCBAQCBleHRlcm4g
aW50IENJRlNQT1NJWERlbEZpbGUoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
dGNvbiAqdGNvbiwKIAkJCWludCByZW1hcF9zcGVjaWFsX2NoYXJzKTsKIGV4dGVybiBpbnQgQ0lG
U1NNQkRlbEZpbGUoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNv
biwKIAkJCSAgY29uc3QgY2hhciAqbmFtZSwgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYik7
Ci1leHRlcm4gaW50IENJRlNTTUJSZW5hbWUoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0
IGNpZnNfdGNvbiAqdGNvbiwKLQkJCSBjb25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIg
KnRvX25hbWUsCi0JCQkgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYik7CitpbnQgQ0lGU1NN
QlJlbmFtZShjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAor
CQkgIHN0cnVjdCBkZW50cnkgKnNvdXJjZV9kZW50cnksCisJCSAgY29uc3QgY2hhciAqZnJvbV9u
YW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAorCQkgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNf
c2IpOwogZXh0ZXJuIGludCBDSUZTU01CUmVuYW1lT3BlbkZpbGUoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCQkgaW50IG5ldGZpZCwgY29uc3QgY2hh
ciAqdGFyZ2V0X25hbWUsCiAJCQkJIGNvbnN0IHN0cnVjdCBubHNfdGFibGUgKm5sc19jb2RlcGFn
ZSwKZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvY2lmc3NtYi5jIGIvZnMvc21iL2NsaWVudC9j
aWZzc21iLmMKaW5kZXggOWVlMzQ4ZTZkMTA2Li41YmRlYTAxOTE5ZTggMTAwNjQ0Ci0tLSBhL2Zz
L3NtYi9jbGllbnQvY2lmc3NtYi5jCisrKyBiL2ZzL3NtYi9jbGllbnQvY2lmc3NtYi5jCkBAIC0y
MTQ5LDEwICsyMTQ5LDEwIEBAIENJRlNTTUJGbHVzaChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBz
dHJ1Y3QgY2lmc190Y29uICp0Y29uLCBpbnQgc21iX2ZpbGVfaWQpCiAJcmV0dXJuIHJjOwogfQog
Ci1pbnQKLUNJRlNTTUJSZW5hbWUoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
dGNvbiAqdGNvbiwKLQkgICAgICBjb25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIgKnRv
X25hbWUsCi0JICAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYikKK2ludCBDSUZTU01C
UmVuYW1lKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCisJ
CSAgc3RydWN0IGRlbnRyeSAqc291cmNlX2RlbnRyeSwKKwkJICBjb25zdCBjaGFyICpmcm9tX25h
bWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCisJCSAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19z
YikKIHsKIAlpbnQgcmMgPSAwOwogCVJFTkFNRV9SRVEgKnBTTUIgPSBOVUxMOwpkaWZmIC0tZ2l0
IGEvZnMvc21iL2NsaWVudC9pbm9kZS5jIGIvZnMvc21iL2NsaWVudC9pbm9kZS5jCmluZGV4IDhk
NjI4MmJiYzdlZC4uY2M0YzE0NGVhNDBhIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50L2lub2Rl
LmMKKysrIGIvZnMvc21iL2NsaWVudC9pbm9kZS5jCkBAIC0yMjQ0LDcgKzIyNDQsOCBAQCBjaWZz
X2RvX3JlbmFtZShjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgZGVudHJ5ICpmcm9tX2Rl
bnRyeSwKIAkJcmV0dXJuIC1FTk9TWVM7CiAKIAkvKiB0cnkgcGF0aC1iYXNlZCByZW5hbWUgZmly
c3QgKi8KLQlyYyA9IHNlcnZlci0+b3BzLT5yZW5hbWUoeGlkLCB0Y29uLCBmcm9tX3BhdGgsIHRv
X3BhdGgsIGNpZnNfc2IpOworCXJjID0gc2VydmVyLT5vcHMtPnJlbmFtZSh4aWQsIHRjb24sIGZy
b21fZGVudHJ5LAorCQkJCSBmcm9tX3BhdGgsIHRvX3BhdGgsIGNpZnNfc2IpOwogCiAJLyoKIAkg
KiBEb24ndCBib3RoZXIgd2l0aCByZW5hbWUgYnkgZmlsZWhhbmRsZSB1bmxlc3MgZmlsZSBpcyBi
dXN5IGFuZApkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYyBiL2ZzL3NtYi9j
bGllbnQvc21iMmlub2RlLmMKaW5kZXggMGYwOTZmYjQxYjNlLi4yZDljZGMxOTQ0MDMgMTAwNjQ0
Ci0tLSBhL2ZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMKKysrIGIvZnMvc21iL2NsaWVudC9zbWIy
aW5vZGUuYwpAQCAtODg5LDExICs4ODksMTEgQEAgc21iMl91bmxpbmsoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwgY29uc3QgY2hhciAqbmFtZSwKIAkJCQlO
VUxMLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKIH0KIAotc3RhdGljIGludAotc21iMl9zZXRf
cGF0aF9hdHRyKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24s
Ci0JCSAgIGNvbnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hhciAqdG9fbmFtZSwKLQkJICAg
c3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwgX191MzIgYWNjZXNzLCBpbnQgY29tbWFuZCwK
LQkJICAgc3RydWN0IGNpZnNGaWxlSW5mbyAqY2ZpbGUpCitzdGF0aWMgaW50IHNtYjJfc2V0X3Bh
dGhfYXR0cihjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAor
CQkJICAgICAgY29uc3QgY2hhciAqZnJvbV9uYW1lLCBjb25zdCBjaGFyICp0b19uYW1lLAorCQkJ
ICAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwKKwkJCSAgICAgIF9fdTMyIGNyZWF0
ZV9vcHRpb25zLCBfX3UzMiBhY2Nlc3MsCisJCQkgICAgICBpbnQgY29tbWFuZCwgc3RydWN0IGNp
ZnNGaWxlSW5mbyAqY2ZpbGUpCiB7CiAJc3RydWN0IGt2ZWMgaW5faW92OwogCV9fbGUxNiAqc21i
Ml90b19uYW1lID0gTlVMTDsKQEAgLTkwNywyNSArOTA3LDMzIEBAIHNtYjJfc2V0X3BhdGhfYXR0
cihjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCWluX2lv
di5pb3ZfYmFzZSA9IHNtYjJfdG9fbmFtZTsKIAlpbl9pb3YuaW92X2xlbiA9IDIgKiBVbmlTdHJu
bGVuKCh3Y2hhcl90ICopc21iMl90b19uYW1lLCBQQVRIX01BWCk7CiAJcmMgPSBzbWIyX2NvbXBv
dW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnJvbV9uYW1lLCBhY2Nlc3MsCi0JCQkgICAgICBG
SUxFX09QRU4sIDAsIEFDTF9OT19NT0RFLCAmaW5faW92LAorCQkJICAgICAgRklMRV9PUEVOLCBj
cmVhdGVfb3B0aW9ucywgQUNMX05PX01PREUsICZpbl9pb3YsCiAJCQkgICAgICAmY29tbWFuZCwg
MSwgY2ZpbGUsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwpOwogc21iMl9yZW5hbWVfcGF0aDoKIAlr
ZnJlZShzbWIyX3RvX25hbWUpOwogCXJldHVybiByYzsKIH0KIAotaW50Ci1zbWIyX3JlbmFtZV9w
YXRoKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCi0JCSBj
b25zdCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCi0JCSBzdHJ1Y3QgY2lm
c19zYl9pbmZvICpjaWZzX3NiKQoraW50IHNtYjJfcmVuYW1lX3BhdGgoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwKKwkJICAgICBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCQkgICAgIHN0cnVjdCBk
ZW50cnkgKnNvdXJjZV9kZW50cnksCisJCSAgICAgY29uc3QgY2hhciAqZnJvbV9uYW1lLCBjb25z
dCBjaGFyICp0b19uYW1lLAorCQkgICAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IpCiB7
CisJc3RydWN0IGNpZnNJbm9kZUluZm8gKmNpOwogCXN0cnVjdCBjaWZzRmlsZUluZm8gKmNmaWxl
OworCV9fdTMyIGNvID0gMDsKIAorCWlmIChzb3VyY2VfZGVudHJ5KSB7CisJCWNpID0gQ0lGU19J
KGRfaW5vZGUoc291cmNlX2RlbnRyeSkpOworCQlpZiAoY2ktPmNpZnNBdHRycyAmIEFUVFJfUkVQ
QVJTRSkKKwkJCWNvIHw9IE9QRU5fUkVQQVJTRV9QT0lOVDsKKwl9CiAJZHJvcF9jYWNoZWRfZGly
X2J5X25hbWUoeGlkLCB0Y29uLCBmcm9tX25hbWUsIGNpZnNfc2IpOwogCWNpZnNfZ2V0X3dyaXRh
YmxlX3BhdGgodGNvbiwgZnJvbV9uYW1lLCBGSU5EX1dSX1dJVEhfREVMRVRFLCAmY2ZpbGUpOwog
Ci0JcmV0dXJuIHNtYjJfc2V0X3BhdGhfYXR0cih4aWQsIHRjb24sIGZyb21fbmFtZSwgdG9fbmFt
ZSwKLQkJCQkgIGNpZnNfc2IsIERFTEVURSwgU01CMl9PUF9SRU5BTUUsIGNmaWxlKTsKKwlyZXR1
cm4gc21iMl9zZXRfcGF0aF9hdHRyKHhpZCwgdGNvbiwgZnJvbV9uYW1lLCB0b19uYW1lLCBjaWZz
X3NiLAorCQkJCSAgY28sIERFTEVURSwgU01CMl9PUF9SRU5BTUUsIGNmaWxlKTsKIH0KIAogaW50
CkBAIC05MzMsOSArOTQxLDkgQEAgc21iMl9jcmVhdGVfaGFyZGxpbmsoY29uc3QgdW5zaWduZWQg
aW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgICBjb25zdCBjaGFyICpmcm9t
X25hbWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCiAJCSAgICAgc3RydWN0IGNpZnNfc2JfaW5mbyAq
Y2lmc19zYikKIHsKLQlyZXR1cm4gc21iMl9zZXRfcGF0aF9hdHRyKHhpZCwgdGNvbiwgZnJvbV9u
YW1lLCB0b19uYW1lLCBjaWZzX3NiLAotCQkJCSAgRklMRV9SRUFEX0FUVFJJQlVURVMsIFNNQjJf
T1BfSEFSRExJTkssCi0JCQkJICBOVUxMKTsKKwlyZXR1cm4gc21iMl9zZXRfcGF0aF9hdHRyKHhp
ZCwgdGNvbiwgZnJvbV9uYW1lLCB0b19uYW1lLAorCQkJCSAgY2lmc19zYiwgMCwgRklMRV9SRUFE
X0FUVFJJQlVURVMsCisJCQkJICBTTUIyX09QX0hBUkRMSU5LLCBOVUxMKTsKIH0KIAogaW50CmRp
ZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L3NtYjJwcm90by5oIGIvZnMvc21iL2NsaWVudC9zbWIy
cHJvdG8uaAppbmRleCA3MDkzMjRjZmY3MTIuLmFlZjUwMzE2NjcwYSAxMDA2NDQKLS0tIGEvZnMv
c21iL2NsaWVudC9zbWIycHJvdG8uaAorKysgYi9mcy9zbWIvY2xpZW50L3NtYjJwcm90by5oCkBA
IC04Niw5ICs4NiwxMSBAQCBleHRlcm4gaW50IHNtYjJfcm1kaXIoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgICAgY29uc3QgY2hhciAqbmFtZSwg
c3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYik7CiBleHRlcm4gaW50IHNtYjJfdW5saW5rKGNv
bnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJCSAgICAgICBj
b25zdCBjaGFyICpuYW1lLCBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiKTsKLWV4dGVybiBp
bnQgc21iMl9yZW5hbWVfcGF0aChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190
Y29uICp0Y29uLAotCQkJICAgIGNvbnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hhciAqdG9f
bmFtZSwKLQkJCSAgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiKTsKK2ludCBzbWIyX3Jl
bmFtZV9wYXRoKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCSAgICAgc3RydWN0IGNpZnNfdGNv
biAqdGNvbiwKKwkJICAgICBzdHJ1Y3QgZGVudHJ5ICpzb3VyY2VfZGVudHJ5LAorCQkgICAgIGNv
bnN0IGNoYXIgKmZyb21fbmFtZSwgY29uc3QgY2hhciAqdG9fbmFtZSwKKwkJICAgICBzdHJ1Y3Qg
Y2lmc19zYl9pbmZvICpjaWZzX3NiKTsKIGV4dGVybiBpbnQgc21iMl9jcmVhdGVfaGFyZGxpbmso
Y29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCQljb25z
dCBjaGFyICpmcm9tX25hbWUsIGNvbnN0IGNoYXIgKnRvX25hbWUsCiAJCQkJc3RydWN0IGNpZnNf
c2JfaW5mbyAqY2lmc19zYik7Ci0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0003-smb-client-optimise-reparse-point-querying.patch"
Content-Disposition: attachment; 
	filename="0003-smb-client-optimise-reparse-point-querying.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f5h5>
X-Attachment-Id: f_lqh63f5h5

RnJvbSBjZmIzNTEyODcyMGI5NTQ4MzY2NTkyNGViMzExMWFmNTFiNjU0YTU1IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDUgLTAzMDAKU3ViamVjdDogW1BBVENIIDMvOF0g
c21iOiBjbGllbnQ6IG9wdGltaXNlIHJlcGFyc2UgcG9pbnQgcXVlcnlpbmcKClJlZHVjZSBudW1i
ZXIgb2Ygcm91bmR0cmlwcyB0byBzZXJ2ZXIgd2hlbiBxdWVyeWluZyByZXBhcnNlIHBvaW50cyBp
bgotPnF1ZXJ5X3BhdGhfaW5mbygpIGJ5IHNlbmRpbmcgYSBzaW5nbGUgY29tcG91bmQgcmVxdWVz
dCBvZgpjcmVhdGUrZ2V0X3JlcGFyc2UrZ2V0X2luZm8rY2xvc2UuCgpTaWduZWQtb2ZmLWJ5OiBQ
YXVsbyBBbGNhbnRhcmEgKFNVU0UpIDxwY0BtYW5ndWViaXQuY29tPgotLS0KIGZzL3NtYi9jbGll
bnQvY2lmc2dsb2IuaCAgfCAgMTAgKystLQogZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaCB8ICAg
NyArKysKIGZzL3NtYi9jbGllbnQvaW5vZGUuYyAgICAgfCAgIDUgKy0KIGZzL3NtYi9jbGllbnQv
c21iMmdsb2IuaCAgfCAgIDMgKy0KIGZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMgfCAxMjIgKysr
KysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tLS0tLS0KIGZzL3NtYi9jbGllbnQvdHJhY2Uu
aCAgICAgfCAgIDMgKwogNiBmaWxlcyBjaGFuZ2VkLCAxMTkgaW5zZXJ0aW9ucygrKSwgMzEgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9jaWZzZ2xvYi5oIGIvZnMvc21i
L2NsaWVudC9jaWZzZ2xvYi5oCmluZGV4IDI0ZWVhM2M0ZDcyMy4uODEwZDkyOWMwMTkwIDEwMDY0
NAotLS0gYS9mcy9zbWIvY2xpZW50L2NpZnNnbG9iLmgKKysrIGIvZnMvc21iL2NsaWVudC9jaWZz
Z2xvYi5oCkBAIC0xOTIsNiArMTkyLDExIEBAIHN0cnVjdCBjaWZzX29wZW5faW5mb19kYXRhIHsK
IAkJYm9vbCBzeW1saW5rOwogCX07CiAJc3RydWN0IHsKKwkJLyogaW9jdGwgcmVzcG9uc2UgYnVm
ZmVyICovCisJCXN0cnVjdCB7CisJCQlpbnQgYnVmdHlwZTsKKwkJCXN0cnVjdCBrdmVjIGlvdjsK
KwkJfSBpbzsKIAkJX191MzIgdGFnOwogCQl1bmlvbiB7CiAJCQlzdHJ1Y3QgcmVwYXJzZV9kYXRh
X2J1ZmZlciAqYnVmOwpAQCAtMjA5LDExICsyMTQsNiBAQCBzdHJ1Y3QgY2lmc19vcGVuX2luZm9f
ZGF0YSB7CiAJKChkKS0+cmVwYXJzZV9wb2ludCB8fCBcCiAJIChsZTMyX3RvX2NwdSgoZCktPmZp
LkF0dHJpYnV0ZXMpICYgQVRUUl9SRVBBUlNFKSkKIAotc3RhdGljIGlubGluZSB2b2lkIGNpZnNf
ZnJlZV9vcGVuX2luZm8oc3RydWN0IGNpZnNfb3Blbl9pbmZvX2RhdGEgKmRhdGEpCi17Ci0Ja2Zy
ZWUoZGF0YS0+c3ltbGlua190YXJnZXQpOwotfQotCiAvKgogICoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgKiBFeGNlcHQg
dGhlIENJRlMgUERVcyB0aGVtc2VsdmVzIGFsbCB0aGUKZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGll
bnQvY2lmc3Byb3RvLmggYi9mcy9zbWIvY2xpZW50L2NpZnNwcm90by5oCmluZGV4IDBhZGVhYTg0
YjY2Mi4uNGM1ZDUzM2Q5OGEzIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50L2NpZnNwcm90by5o
CisrKyBiL2ZzL3NtYi9jbGllbnQvY2lmc3Byb3RvLmgKQEAgLTc2NCw0ICs3NjQsMTEgQEAgc3Rh
dGljIGlubGluZSB2b2lkIHJlbGVhc2VfbWlkKHN0cnVjdCBtaWRfcV9lbnRyeSAqbWlkKQogCWty
ZWZfcHV0KCZtaWQtPnJlZmNvdW50LCBfX3JlbGVhc2VfbWlkKTsKIH0KIAorc3RhdGljIGlubGlu
ZSB2b2lkIGNpZnNfZnJlZV9vcGVuX2luZm8oc3RydWN0IGNpZnNfb3Blbl9pbmZvX2RhdGEgKmRh
dGEpCit7CisJa2ZyZWUoZGF0YS0+c3ltbGlua190YXJnZXQpOworCWZyZWVfcnNwX2J1ZihkYXRh
LT5yZXBhcnNlLmlvLmJ1ZnR5cGUsIGRhdGEtPnJlcGFyc2UuaW8uaW92Lmlvdl9iYXNlKTsKKwlt
ZW1zZXQoZGF0YSwgMCwgc2l6ZW9mKCpkYXRhKSk7Cit9CisKICNlbmRpZgkJCS8qIF9DSUZTUFJP
VE9fSCAqLwpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9pbm9kZS5jIGIvZnMvc21iL2NsaWVu
dC9pbm9kZS5jCmluZGV4IGI3M2JmOGE5MzQ0My4uOGQ2MjgyYmJjN2VkIDEwMDY0NAotLS0gYS9m
cy9zbWIvY2xpZW50L2lub2RlLmMKKysrIGIvZnMvc21iL2NsaWVudC9pbm9kZS5jCkBAIC0xMDc4
LDYgKzEwNzgsOSBAQCBzdGF0aWMgaW50IHJlcGFyc2VfaW5mb190b19mYXR0cihzdHJ1Y3QgY2lm
c19vcGVuX2luZm9fZGF0YSAqZGF0YSwKIAkJCQkJCSAgICAgICZyc3BfaW92LCAmcnNwX2J1ZnR5
cGUpOwogCQlpZiAoIXJjKQogCQkJaW92ID0gJnJzcF9pb3Y7CisJfSBlbHNlIGlmIChkYXRhLT5y
ZXBhcnNlLmlvLmJ1ZnR5cGUgIT0gQ0lGU19OT19CVUZGRVIgJiYKKwkJICAgZGF0YS0+cmVwYXJz
ZS5pby5pb3YuaW92X2Jhc2UpIHsKKwkJaW92ID0gJmRhdGEtPnJlcGFyc2UuaW8uaW92OwogCX0K
IAogCXJjID0gLUVPUE5PVFNVUFA7CkBAIC0xMDk3LDcgKzExMDAsNyBAQCBzdGF0aWMgaW50IHJl
cGFyc2VfaW5mb190b19mYXR0cihzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSAqZGF0YSwKIAkJ
LyogQ2hlY2sgZm9yIGNhY2hlZCByZXBhcnNlIHBvaW50IGRhdGEgKi8KIAkJaWYgKGRhdGEtPnN5
bWxpbmtfdGFyZ2V0IHx8IGRhdGEtPnJlcGFyc2UuYnVmKSB7CiAJCQlyYyA9IDA7Ci0JCX0gZWxz
ZSBpZiAoc2VydmVyLT5vcHMtPnBhcnNlX3JlcGFyc2VfcG9pbnQpIHsKKwkJfSBlbHNlIGlmIChp
b3YgJiYgc2VydmVyLT5vcHMtPnBhcnNlX3JlcGFyc2VfcG9pbnQpIHsKIAkJCXJjID0gc2VydmVy
LT5vcHMtPnBhcnNlX3JlcGFyc2VfcG9pbnQoY2lmc19zYiwKIAkJCQkJCQkgICAgICBpb3YsIGRh
dGEpOwogCQl9CmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L3NtYjJnbG9iLmggYi9mcy9zbWIv
Y2xpZW50L3NtYjJnbG9iLmgKaW5kZXggY2E4N2EwMDExYzMzLi5hMGMxNTY5OTZmYzUgMTAwNjQ0
Ci0tLSBhL2ZzL3NtYi9jbGllbnQvc21iMmdsb2IuaAorKysgYi9mcy9zbWIvY2xpZW50L3NtYjJn
bG9iLmgKQEAgLTM1LDcgKzM1LDggQEAgZW51bSBzbWIyX2NvbXBvdW5kX29wcyB7CiAJU01CMl9P
UF9TRVRfRU9GLAogCVNNQjJfT1BfUk1ESVIsCiAJU01CMl9PUF9QT1NJWF9RVUVSWV9JTkZPLAot
CVNNQjJfT1BfU0VUX1JFUEFSU0UKKwlTTUIyX09QX1NFVF9SRVBBUlNFLAorCVNNQjJfT1BfR0VU
X1JFUEFSU0UKIH07CiAKIC8qIFVzZWQgd2hlbiBjb25zdHJ1Y3RpbmcgY2hhaW5lZCByZWFkIHJl
cXVlc3RzLiAqLwpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYyBiL2ZzL3Nt
Yi9jbGllbnQvc21iMmlub2RlLmMKaW5kZXggZDY2MmJhZDNiNzAzLi4wZjA5NmZiNDFiM2UgMTAw
NjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvc21iMmlub2RlLmMKKysrIGIvZnMvc21iL2NsaWVudC9z
bWIyaW5vZGUuYwpAQCAtMjYsNiArMjYsMjQgQEAKICNpbmNsdWRlICJjYWNoZWRfZGlyLmgiCiAj
aW5jbHVkZSAic21iMnN0YXR1cy5oIgogCitzdGF0aWMgc3RydWN0IHJlcGFyc2VfZGF0YV9idWZm
ZXIgKnJlcGFyc2VfYnVmX3B0cihzdHJ1Y3Qga3ZlYyAqaW92KQoreworCXN0cnVjdCByZXBhcnNl
X2RhdGFfYnVmZmVyICpidWY7CisJc3RydWN0IHNtYjJfaW9jdGxfcnNwICppbyA9IGlvdi0+aW92
X2Jhc2U7CisJdTMyIG9mZiwgY291bnQsIGxlbjsKKworCWNvdW50ID0gbGUzMl90b19jcHUoaW8t
Pk91dHB1dENvdW50KTsKKwlvZmYgPSBsZTMyX3RvX2NwdShpby0+T3V0cHV0T2Zmc2V0KTsKKwlp
ZiAoY2hlY2tfYWRkX292ZXJmbG93KG9mZiwgY291bnQsICZsZW4pIHx8IGxlbiA+IGlvdi0+aW92
X2xlbikKKwkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7CisKKwlidWYgPSAoc3RydWN0IHJlcGFyc2Vf
ZGF0YV9idWZmZXIgKikoKHU4ICopaW8gKyBvZmYpOworCWxlbiA9IHNpemVvZigqYnVmKTsKKwlp
ZiAoY291bnQgPCBsZW4gfHwgY291bnQgPCBsZTE2X3RvX2NwdShidWYtPlJlcGFyc2VEYXRhTGVu
Z3RoKSArIGxlbikKKwkJcmV0dXJuIEVSUl9QVFIoLUVJTyk7CisJcmV0dXJuIGJ1ZjsKK30KKwog
LyoKICAqIG5vdGU6IElmIGNmaWxlIGlzIHBhc3NlZCwgdGhlIHJlZmVyZW5jZSB0byBpdCBpcyBk
cm9wcGVkIGhlcmUuCiAgKiBTbyBtYWtlIHN1cmUgdGhhdCB5b3UgZG8gbm90IHJldXNlIGNmaWxl
IGFmdGVyIHJldHVybiBmcm9tIHRoaXMgZnVuYy4KQEAgLTQyLDggKzYwLDEwIEBAIHN0YXRpYyBp
bnQgc21iMl9jb21wb3VuZF9vcChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190
Y29uICp0Y29uLAogCQkJICAgIF9fdTggKipleHRidWYsIHNpemVfdCAqZXh0YnVmbGVuLAogCQkJ
ICAgIHN0cnVjdCBrdmVjICpvdXRfaW92LCBpbnQgKm91dF9idWZ0eXBlKQogeworCisJc3RydWN0
IHJlcGFyc2VfZGF0YV9idWZmZXIgKnJidWY7CiAJc3RydWN0IHNtYjJfY29tcG91bmRfdmFycyAq
dmFycyA9IE5VTEw7Ci0Jc3RydWN0IGt2ZWMgKnJzcF9pb3Y7CisJc3RydWN0IGt2ZWMgKnJzcF9p
b3YsICppb3Y7CiAJc3RydWN0IHNtYl9ycXN0ICpycXN0OwogCWludCByYzsKIAlfX2xlMTYgKnV0
ZjE2X3BhdGggPSBOVUxMOwpAQCAtMzYzLDYgKzM4MywyMSBAQCBzdGF0aWMgaW50IHNtYjJfY29t
cG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwK
IAkJCXRyYWNlX3NtYjNfc2V0X3JlcGFyc2VfY29tcG91bmRfZW50ZXIoeGlkLCBzZXMtPlN1aWQs
CiAJCQkJCQkJICAgICAgdGNvbi0+dGlkLCBmdWxsX3BhdGgpOwogCQkJYnJlYWs7CisJCWNhc2Ug
U01CMl9PUF9HRVRfUkVQQVJTRToKKwkJCXJxc3RbbnVtX3Jxc3RdLnJxX2lvdiA9IHZhcnMtPmlv
X2lvdjsKKwkJCXJxc3RbbnVtX3Jxc3RdLnJxX252ZWMgPSBBUlJBWV9TSVpFKHZhcnMtPmlvX2lv
dik7CisKKwkJCXJjID0gU01CMl9pb2N0bF9pbml0KHRjb24sIHNlcnZlciwgJnJxc3RbbnVtX3Jx
c3RdLAorCQkJCQkgICAgIENPTVBPVU5EX0ZJRCwgQ09NUE9VTkRfRklELAorCQkJCQkgICAgIEZT
Q1RMX0dFVF9SRVBBUlNFX1BPSU5ULAorCQkJCQkgICAgIE5VTEwsIDAsIENJRlNNYXhCdWZTaXpl
KTsKKwkJCWlmIChyYykKKwkJCQlnb3RvIGZpbmlzaGVkOworCQkJc21iMl9zZXRfbmV4dF9jb21t
YW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7CisJCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251
bV9ycXN0KytdKTsKKwkJCXRyYWNlX3NtYjNfZ2V0X3JlcGFyc2VfY29tcG91bmRfZW50ZXIoeGlk
LCBzZXMtPlN1aWQsCisJCQkJCQkJICAgICAgdGNvbi0+dGlkLCBmdWxsX3BhdGgpOworCQkJYnJl
YWs7CiAJCWRlZmF1bHQ6CiAJCQljaWZzX2RiZyhWRlMsICJJbnZhbGlkIGNvbW1hbmRcbiIpOwog
CQkJcmMgPSAtRUlOVkFMOwpAQCAtNTI5LDYgKzU2NCwzMCBAQCBzdGF0aWMgaW50IHNtYjJfY29t
cG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwK
IAkJCX0KIAkJCVNNQjJfaW9jdGxfZnJlZSgmcnFzdFtudW1fcnFzdCsrXSk7CiAJCQlicmVhazsK
KwkJY2FzZSBTTUIyX09QX0dFVF9SRVBBUlNFOgorCQkJaWYgKCFyYykgeworCQkJCWlvdiA9ICZy
c3BfaW92W2kgKyAxXTsKKwkJCQlpZGF0YSA9IGluX2lvdltpXS5pb3ZfYmFzZTsKKwkJCQlpZGF0
YS0+cmVwYXJzZS5pby5pb3YgPSAqaW92OworCQkJCWlkYXRhLT5yZXBhcnNlLmlvLmJ1ZnR5cGUg
PSByZXNwX2J1ZnR5cGVbaSArIDFdOworCQkJCXJidWYgPSByZXBhcnNlX2J1Zl9wdHIoaW92KTsK
KwkJCQlpZiAoSVNfRVJSKHJidWYpKSB7CisJCQkJCXJjID0gUFRSX0VSUihyYnVmKTsKKwkJCQkJ
dHJhY2Vfc21iM19zZXRfcmVwYXJzZV9jb21wb3VuZF9lcnIoeGlkLCAgc2VzLT5TdWlkLAorCQkJ
CQkJCQkJICAgIHRjb24tPnRpZCwgcmMpOworCQkJCX0gZWxzZSB7CisJCQkJCWlkYXRhLT5yZXBh
cnNlLnRhZyA9IGxlMzJfdG9fY3B1KHJidWYtPlJlcGFyc2VUYWcpOworCQkJCQl0cmFjZV9zbWIz
X3NldF9yZXBhcnNlX2NvbXBvdW5kX2RvbmUoeGlkLCBzZXMtPlN1aWQsCisJCQkJCQkJCQkgICAg
IHRjb24tPnRpZCk7CisJCQkJfQorCQkJCW1lbXNldChpb3YsIDAsIHNpemVvZigqaW92KSk7CisJ
CQkJcmVzcF9idWZ0eXBlW2kgKyAxXSA9IENJRlNfTk9fQlVGRkVSOworCQkJfSBlbHNlIHsKKwkJ
CQl0cmFjZV9zbWIzX3NldF9yZXBhcnNlX2NvbXBvdW5kX2Vycih4aWQsICBzZXMtPlN1aWQsCisJ
CQkJCQkJCSAgICB0Y29uLT50aWQsIHJjKTsKKwkJCX0KKwkJCVNNQjJfaW9jdGxfZnJlZSgmcnFz
dFtudW1fcnFzdCsrXSk7CisJCQlicmVhazsKIAkJfQogCX0KIAlTTUIyX2Nsb3NlX2ZyZWUoJnJx
c3RbbnVtX3Jxc3RdKTsKQEAgLTU4OSwxMCArNjQ4LDExIEBAIGludCBzbWIyX3F1ZXJ5X3BhdGhf
aW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCXN0cnVjdCBjaWZzRmlsZUluZm8gKmNmaWxl
OwogCXN0cnVjdCBjYWNoZWRfZmlkICpjZmlkID0gTlVMTDsKIAlzdHJ1Y3Qgc21iMl9oZHIgKmhk
cjsKLQlzdHJ1Y3Qga3ZlYyBpbl9pb3YsIG91dF9pb3ZbM10gPSB7fTsKKwlzdHJ1Y3Qga3ZlYyBp
bl9pb3ZbMl0sIG91dF9pb3ZbM10gPSB7fTsKIAlpbnQgb3V0X2J1ZnR5cGVbM10gPSB7fTsKKwlp
bnQgY21kc1syXSA9IHsgU01CMl9PUF9RVUVSWV9JTkZPLCAgfTsKIAlib29sIGlzbGluazsKLQlp
bnQgY21kID0gU01CMl9PUF9RVUVSWV9JTkZPOworCWludCBpLCBudW1fY21kczsKIAlpbnQgcmMs
IHJjMjsKIAogCWRhdGEtPmFkanVzdF90eiA9IGZhbHNlOwpAQCAtNjE0LDE0ICs2NzQsMTYgQEAg
aW50IHNtYjJfcXVlcnlfcGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJCXJldHVy
biByYzsKIAl9CiAKLQlpbl9pb3YuaW92X2Jhc2UgPSBkYXRhOwotCWluX2lvdi5pb3ZfbGVuID0g
c2l6ZW9mKCpkYXRhKTsKKwlpbl9pb3ZbMF0uaW92X2Jhc2UgPSBkYXRhOworCWluX2lvdlswXS5p
b3ZfbGVuID0gc2l6ZW9mKCpkYXRhKTsKKwlpbl9pb3ZbMV0gPSBpbl9pb3ZbMF07CiAKIAljaWZz
X2dldF9yZWFkYWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwgJmNmaWxlKTsKIAlyYyA9IHNtYjJf
Y29tcG91bmRfb3AoeGlkLCB0Y29uLCBjaWZzX3NiLCBmdWxsX3BhdGgsCiAJCQkgICAgICBGSUxF
X1JFQURfQVRUUklCVVRFUywgRklMRV9PUEVOLAotCQkJICAgICAgY3JlYXRlX29wdGlvbnMsIEFD
TF9OT19NT0RFLCAmaW5faW92LAotCQkJICAgICAgJmNtZCwgMSwgY2ZpbGUsIE5VTEwsIE5VTEws
IG91dF9pb3YsIG91dF9idWZ0eXBlKTsKKwkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9f
TU9ERSwKKwkJCSAgICAgIGluX2lvdiwgY21kcywgMSwgY2ZpbGUsCisJCQkgICAgICBOVUxMLCBO
VUxMLCBvdXRfaW92LCBvdXRfYnVmdHlwZSk7CiAJaGRyID0gb3V0X2lvdlswXS5pb3ZfYmFzZTsK
IAkvKgogCSAqIElmIGZpcnN0IGlvdiBpcyB1bnNldCwgdGhlbiBTTUIgc2Vzc2lvbiB3YXMgZHJv
cHBlZCBvciB3ZSd2ZSBnb3QgYQpAQCAtNjM3LDEzICs2OTksMTkgQEAgaW50IHNtYjJfcXVlcnlf
cGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJCWlmIChyYyB8fCAhZGF0YS0+cmVw
YXJzZV9wb2ludCkKIAkJCWdvdG8gb3V0OwogCisJCWlmIChkYXRhLT5yZXBhcnNlLnRhZyA9PSBJ
T19SRVBBUlNFX1RBR19TWU1MSU5LKSB7CisJCQkvKiBzeW1saW5rIGFscmVhZHkgcGFyc2VkIGlu
IGNyZWF0ZSByZXNwb25zZSAqLworCQkJbnVtX2NtZHMgPSAxOworCQl9IGVsc2UgeworCQkJY21k
c1sxXSA9IFNNQjJfT1BfR0VUX1JFUEFSU0U7CisJCQludW1fY21kcyA9IDI7CisJCX0KIAkJY3Jl
YXRlX29wdGlvbnMgfD0gT1BFTl9SRVBBUlNFX1BPSU5UOwotCQkvKiBGYWlsZWQgb24gYSBzeW1i
b2xpYyBsaW5rIC0gcXVlcnkgYSByZXBhcnNlIHBvaW50IGluZm8gKi8KIAkJY2lmc19nZXRfcmVh
ZGFibGVfcGF0aCh0Y29uLCBmdWxsX3BhdGgsICZjZmlsZSk7CiAJCXJjID0gc21iMl9jb21wb3Vu
ZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIGZ1bGxfcGF0aCwKIAkJCQkgICAgICBGSUxFX1JFQURf
QVRUUklCVVRFUywgRklMRV9PUEVOLAotCQkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9f
TU9ERSwgJmluX2lvdiwKLQkJCQkgICAgICAmY21kLCAxLCBjZmlsZSwgTlVMTCwgTlVMTCwgTlVM
TCwgTlVMTCk7CisJCQkJICAgICAgY3JlYXRlX29wdGlvbnMsIEFDTF9OT19NT0RFLCBpbl9pb3Ys
IGNtZHMsCisJCQkJICAgICAgbnVtX2NtZHMsIGNmaWxlLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxM
KTsKIAkJYnJlYWs7CiAJY2FzZSAtRVJFTU9URToKIAkJYnJlYWs7CkBAIC02NjEsOSArNzI5LDgg
QEAgaW50IHNtYjJfcXVlcnlfcGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJfQog
CiBvdXQ6Ci0JZnJlZV9yc3BfYnVmKG91dF9idWZ0eXBlWzBdLCBvdXRfaW92WzBdLmlvdl9iYXNl
KTsKLQlmcmVlX3JzcF9idWYob3V0X2J1ZnR5cGVbMV0sIG91dF9pb3ZbMV0uaW92X2Jhc2UpOwot
CWZyZWVfcnNwX2J1ZihvdXRfYnVmdHlwZVsyXSwgb3V0X2lvdlsyXS5pb3ZfYmFzZSk7CisJZm9y
IChpID0gMDsgaSA8IEFSUkFZX1NJWkUob3V0X2J1ZnR5cGUpOyBpKyspCisJCWZyZWVfcnNwX2J1
ZihvdXRfYnVmdHlwZVtpXSwgb3V0X2lvdltpXS5pb3ZfYmFzZSk7CiAJcmV0dXJuIHJjOwogfQog
CkBAIC02NzgsMTMgKzc0NSwxNCBAQCBpbnQgc21iMzExX3Bvc2l4X3F1ZXJ5X3BhdGhfaW5mbyhj
b25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCWludCByYzsKIAlfX3UzMiBjcmVhdGVfb3B0aW9ucyA9
IDA7CiAJc3RydWN0IGNpZnNGaWxlSW5mbyAqY2ZpbGU7Ci0Jc3RydWN0IGt2ZWMgaW5faW92LCBv
dXRfaW92WzNdID0ge307CisJc3RydWN0IGt2ZWMgaW5faW92WzJdLCBvdXRfaW92WzNdID0ge307
CiAJaW50IG91dF9idWZ0eXBlWzNdID0ge307CiAJX191OCAqc2lkc2J1ZiA9IE5VTEw7CiAJX191
OCAqc2lkc2J1Zl9lbmQgPSBOVUxMOwogCXNpemVfdCBzaWRzYnVmbGVuID0gMDsKIAlzaXplX3Qg
b3duZXJfbGVuLCBncm91cF9sZW47Ci0JaW50IGNtZCA9IFNNQjJfT1BfUE9TSVhfUVVFUllfSU5G
TzsKKwlpbnQgY21kc1syXSA9IHsgU01CMl9PUF9QT1NJWF9RVUVSWV9JTkZPLCAgfTsKKwlpbnQg
aSwgbnVtX2NtZHM7CiAKIAlkYXRhLT5hZGp1c3RfdHogPSBmYWxzZTsKIAlkYXRhLT5yZXBhcnNl
X3BvaW50ID0gZmFsc2U7CkBAIC02OTUsMTMgKzc2MywxNCBAQCBpbnQgc21iMzExX3Bvc2l4X3F1
ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCSAqIHdoZW4gd2UgYWxyZWFk
eSBoYXZlIGFuIG9wZW4gZmlsZSBoYW5kbGUgZm9yIHRoaXMuIEZvciBub3cgdGhpcyBpcyBmYXN0
IGVub3VnaAogCSAqIChhbHdheXMgdXNpbmcgdGhlIGNvbXBvdW5kZWQgdmVyc2lvbikuCiAJICov
Ci0JaW5faW92Lmlvdl9iYXNlID0gZGF0YTsKLQlpbl9pb3YuaW92X2xlbiA9IHNpemVvZigqZGF0
YSk7CisJaW5faW92WzBdLmlvdl9iYXNlID0gZGF0YTsKKwlpbl9pb3ZbMF0uaW92X2xlbiA9IHNp
emVvZigqZGF0YSk7CisJaW5faW92WzFdID0gaW5faW92WzBdOwogCiAJY2lmc19nZXRfcmVhZGFi
bGVfcGF0aCh0Y29uLCBmdWxsX3BhdGgsICZjZmlsZSk7CiAJcmMgPSBzbWIyX2NvbXBvdW5kX29w
KHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9wYXRoLAogCQkJICAgICAgRklMRV9SRUFEX0FUVFJJ
QlVURVMsIEZJTEVfT1BFTiwKLQkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwg
JmluX2lvdiwgJmNtZCwgMSwKKwkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwg
aW5faW92LCBjbWRzLCAxLAogCQkJICAgICAgY2ZpbGUsICZzaWRzYnVmLCAmc2lkc2J1Zmxlbiwg
b3V0X2lvdiwgb3V0X2J1ZnR5cGUpOwogCS8qCiAJICogSWYgZmlyc3QgaW92IGlzIHVuc2V0LCB0
aGVuIFNNQiBzZXNzaW9uIHdhcyBkcm9wcGVkIG9yIHdlJ3ZlIGdvdCBhCkBAIC03MTgsMTMgKzc4
NywxOSBAQCBpbnQgc21iMzExX3Bvc2l4X3F1ZXJ5X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBp
bnQgeGlkLAogCQlpZiAocmMgfHwgIWRhdGEtPnJlcGFyc2VfcG9pbnQpCiAJCQlnb3RvIG91dDsK
IAorCQlpZiAoZGF0YS0+cmVwYXJzZS50YWcgPT0gSU9fUkVQQVJTRV9UQUdfU1lNTElOSykgewor
CQkJLyogc3ltbGluayBhbHJlYWR5IHBhcnNlZCBpbiBjcmVhdGUgcmVzcG9uc2UgKi8KKwkJCW51
bV9jbWRzID0gMTsKKwkJfSBlbHNlIHsKKwkJCWNtZHNbMV0gPSBTTUIyX09QX0dFVF9SRVBBUlNF
OworCQkJbnVtX2NtZHMgPSAyOworCQl9CiAJCWNyZWF0ZV9vcHRpb25zIHw9IE9QRU5fUkVQQVJT
RV9QT0lOVDsKLQkJLyogRmFpbGVkIG9uIGEgc3ltYm9saWMgbGluayAtIHF1ZXJ5IGEgcmVwYXJz
ZSBwb2ludCBpbmZvICovCiAJCWNpZnNfZ2V0X3JlYWRhYmxlX3BhdGgodGNvbiwgZnVsbF9wYXRo
LCAmY2ZpbGUpOwogCQlyYyA9IHNtYjJfY29tcG91bmRfb3AoeGlkLCB0Y29uLCBjaWZzX3NiLCBm
dWxsX3BhdGgsCiAJCQkJICAgICAgRklMRV9SRUFEX0FUVFJJQlVURVMsIEZJTEVfT1BFTiwKLQkJ
CQkgICAgICBjcmVhdGVfb3B0aW9ucywgQUNMX05PX01PREUsICZpbl9pb3YsICZjbWQsIDEsCi0J
CQkJICAgICAgY2ZpbGUsICZzaWRzYnVmLCAmc2lkc2J1ZmxlbiwgTlVMTCwgTlVMTCk7CisJCQkJ
ICAgICAgY3JlYXRlX29wdGlvbnMsIEFDTF9OT19NT0RFLCBpbl9pb3YsIGNtZHMsCisJCQkJICAg
ICAgbnVtX2NtZHMsIGNmaWxlLCAmc2lkc2J1ZiwgJnNpZHNidWZsZW4sIE5VTEwsIE5VTEwpOwog
CQlicmVhazsKIAl9CiAKQEAgLTc0OSw5ICs4MjQsOCBAQCBpbnQgc21iMzExX3Bvc2l4X3F1ZXJ5
X3BhdGhfaW5mbyhjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCX0KIAogCWtmcmVlKHNpZHNidWYp
OwotCWZyZWVfcnNwX2J1ZihvdXRfYnVmdHlwZVswXSwgb3V0X2lvdlswXS5pb3ZfYmFzZSk7Ci0J
ZnJlZV9yc3BfYnVmKG91dF9idWZ0eXBlWzFdLCBvdXRfaW92WzFdLmlvdl9iYXNlKTsKLQlmcmVl
X3JzcF9idWYob3V0X2J1ZnR5cGVbMl0sIG91dF9pb3ZbMl0uaW92X2Jhc2UpOworCWZvciAoaSA9
IDA7IGkgPCBBUlJBWV9TSVpFKG91dF9idWZ0eXBlKTsgaSsrKQorCQlmcmVlX3JzcF9idWYob3V0
X2J1ZnR5cGVbaV0sIG91dF9pb3ZbaV0uaW92X2Jhc2UpOwogCXJldHVybiByYzsKIH0KIApkaWZm
IC0tZ2l0IGEvZnMvc21iL2NsaWVudC90cmFjZS5oIGIvZnMvc21iL2NsaWVudC90cmFjZS5oCmlu
ZGV4IDM0ZjUwNzU4NDI3NC4uNTIyZmEzODdmY2ZkIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50
L3RyYWNlLmgKKysrIGIvZnMvc21iL2NsaWVudC90cmFjZS5oCkBAIC0zNzEsNiArMzcxLDcgQEAg
REVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKHJtZGlyX2VudGVyKTsKIERFRklO
RV9TTUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVChzZXRfZW9mX2VudGVyKTsKIERFRklORV9T
TUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVChzZXRfaW5mb19jb21wb3VuZF9lbnRlcik7CiBE
RUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRU5URVJfRVZFTlQoc2V0X3JlcGFyc2VfY29tcG91bmRf
ZW50ZXIpOworREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKGdldF9yZXBhcnNl
X2NvbXBvdW5kX2VudGVyKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVChk
ZWxldGVfZW50ZXIpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKG1rZGly
X2VudGVyKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVCh0ZGlzX2VudGVy
KTsKQEAgLTQwOSw2ICs0MTAsNyBAQCBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVO
VChybWRpcl9kb25lKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9ET05FX0VWRU5UKHNldF9l
b2ZfZG9uZSk7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVOVChzZXRfaW5mb19j
b21wb3VuZF9kb25lKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9ET05FX0VWRU5UKHNldF9y
ZXBhcnNlX2NvbXBvdW5kX2RvbmUpOworREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0RPTkVfRVZF
TlQoZ2V0X3JlcGFyc2VfY29tcG91bmRfZG9uZSk7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRf
RE9ORV9FVkVOVChkZWxldGVfZG9uZSk7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRE9ORV9F
VkVOVChta2Rpcl9kb25lKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9ET05FX0VWRU5UKHRk
aXNfZG9uZSk7CkBAIC00NTMsNiArNDU1LDcgQEAgREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VS
Ul9FVkVOVChybWRpcl9lcnIpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VSUl9FVkVOVChz
ZXRfZW9mX2Vycik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJSX0VWRU5UKHNldF9pbmZv
X2NvbXBvdW5kX2Vycik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJSX0VWRU5UKHNldF9y
ZXBhcnNlX2NvbXBvdW5kX2Vycik7CitERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJSX0VWRU5U
KGdldF9yZXBhcnNlX2NvbXBvdW5kX2Vycik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJS
X0VWRU5UKG1rZGlyX2Vycik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJSX0VWRU5UKGRl
bGV0ZV9lcnIpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VSUl9FVkVOVCh0ZGlzX2Vycik7
Ci0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0002-smb-client-allow-creating-special-files-via-reparse-.patch"
Content-Disposition: attachment; 
	filename="0002-smb-client-allow-creating-special-files-via-reparse-.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f5k6>
X-Attachment-Id: f_lqh63f5k6

RnJvbSA4ZWQ0YmI3NDhhMDIzZTQyM2I4Nzk3YTI4MTk1N2RlYWUzMWEzYTdkIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDMgLTAzMDAKU3ViamVjdDogW1BBVENIIDIvOF0g
c21iOiBjbGllbnQ6IGFsbG93IGNyZWF0aW5nIHNwZWNpYWwgZmlsZXMgdmlhIHJlcGFyc2UKIHBv
aW50cwoKQWRkIHN1cHBvcnQgZm9yIGNyZWF0aW5nIHNwZWNpYWwgZmlsZXMgKGUuZy4gY2hhci9i
bG9jayBkZXZpY2VzLApzb2NrZXRzLCBmaWZvcykgdmlhIE5GUyByZXBhcnNlIHBvaW50cyBvbiBT
TUIyKywgd2hpY2ggYXJlIGZ1bGx5CnN1cHBvcnRlZCBieSBtb3N0IFNNQiBzZXJ2ZXJzIGFuZCBk
b2N1bWVudGVkIGluIE1TLUZTQ0MuCgpzbWIyX2dldF9yZXBhcnNlX2lub2RlKCkgY3JlYXRlcyB0
aGUgZmlsZSB3aXRoIGEgY29ycmVzcG9uZGluZyByZXBhcnNlCnBvaW50IGJ1ZmZlciBzZXQgaW4g
QGlvdiB0aHJvdWdoIGEgc2luZ2xlIHJvdW5kdHJpcCB0byB0aGUgc2VydmVyLgoKUmVwb3J0ZWQt
Ynk6IGtlcm5lbCB0ZXN0IHJvYm90IDxsa3BAaW50ZWwuY29tPgpDbG9zZXM6IGh0dHBzOi8vbG9y
ZS5rZXJuZWwub3JnL29lLWtidWlsZC1hbGwvMjAyMzExMjYwNzQ2LkhPSjAzOUJWLWxrcEBpbnRl
bC5jb20vClNpZ25lZC1vZmYtYnk6IFBhdWxvIEFsY2FudGFyYSAoU1VTRSkgPHBjQG1hbmd1ZWJp
dC5jb20+Ci0tLQogZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaCB8ICA4ICsrKy0KIGZzL3NtYi9j
bGllbnQvZGlyLmMgICAgICAgfCAgNyArLS0KIGZzL3NtYi9jbGllbnQvZmlsZS5jICAgICAgfCAx
MCArKystLQogZnMvc21iL2NsaWVudC9pbm9kZS5jICAgICB8IDc2ICsrKysrKysrKysrKysrKysr
KysrLS0tLS0tLS0tLS0KIGZzL3NtYi9jbGllbnQvbGluay5jICAgICAgfCAxMCArKystLQogZnMv
c21iL2NsaWVudC9zbWIyZ2xvYi5oICB8IDI1ICsrKysrKy0tLS0tCiBmcy9zbWIvY2xpZW50L3Nt
YjJpbm9kZS5jIHwgNzUgKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKwogZnMvc21iL2Ns
aWVudC9zbWIyb3BzLmMgICB8IDk0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysr
LS0tLQogZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaCB8ICA3ICsrKwogZnMvc21iL2NsaWVudC90
cmFjZS5oICAgICB8ICA0ICstCiAxMCBmaWxlcyBjaGFuZ2VkLCAyNTYgaW5zZXJ0aW9ucygrKSwg
NjAgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9jaWZzcHJvdG8uaCBi
L2ZzL3NtYi9jbGllbnQvY2lmc3Byb3RvLmgKaW5kZXggNDZmZWFhMDg4MGJkLi4wYWRlYWE4NGI2
NjIgMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQvY2lmc3Byb3RvLmgKKysrIGIvZnMvc21iL2Ns
aWVudC9jaWZzcHJvdG8uaApAQCAtMjExLDggKzIxMSwxMiBAQCBpbnQgY2lmc19nZXRfaW5vZGVf
aW5mbyhzdHJ1Y3QgaW5vZGUgKippbm9kZSwgY29uc3QgY2hhciAqZnVsbF9wYXRoLAogYm9vbCBj
aWZzX3JlcGFyc2VfcG9pbnRfdG9fZmF0dHIoc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwK
IAkJCQkgc3RydWN0IGNpZnNfZmF0dHIgKmZhdHRyLAogCQkJCSBzdHJ1Y3QgY2lmc19vcGVuX2lu
Zm9fZGF0YSAqZGF0YSk7Ci1leHRlcm4gaW50IHNtYjMxMV9wb3NpeF9nZXRfaW5vZGVfaW5mbyhz
dHJ1Y3QgaW5vZGUgKipwaW5vZGUsIGNvbnN0IGNoYXIgKnNlYXJjaF9wYXRoLAotCQkJc3RydWN0
IHN1cGVyX2Jsb2NrICpzYiwgdW5zaWduZWQgaW50IHhpZCk7CisKK2V4dGVybiBpbnQgc21iMzEx
X3Bvc2l4X2dldF9pbm9kZV9pbmZvKHN0cnVjdCBpbm9kZSAqKmlub2RlLAorCQkJCSAgICAgICBj
b25zdCBjaGFyICpmdWxsX3BhdGgsCisJCQkJICAgICAgIHN0cnVjdCBjaWZzX29wZW5faW5mb19k
YXRhICpkYXRhLAorCQkJCSAgICAgICBzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJCSAgICAg
ICBjb25zdCB1bnNpZ25lZCBpbnQgeGlkKTsKIGV4dGVybiBpbnQgY2lmc19nZXRfaW5vZGVfaW5m
b191bml4KHN0cnVjdCBpbm9kZSAqKnBpbm9kZSwKIAkJCWNvbnN0IHVuc2lnbmVkIGNoYXIgKnNl
YXJjaF9wYXRoLAogCQkJc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwgdW5zaWduZWQgaW50IHhpZCk7
CmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L2Rpci5jIGIvZnMvc21iL2NsaWVudC9kaXIuYwpp
bmRleCA1ODBhMjdhM2E3ZTYuLjg5MzMzZDliY2UzNiAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVu
dC9kaXIuYworKysgYi9mcy9zbWIvY2xpZW50L2Rpci5jCkBAIC02ODAsOSArNjgwLDEwIEBAIGNp
ZnNfbG9va3VwKHN0cnVjdCBpbm9kZSAqcGFyZW50X2Rpcl9pbm9kZSwgc3RydWN0IGRlbnRyeSAq
ZGlyZW50cnksCiAJCSBmdWxsX3BhdGgsIGRfaW5vZGUoZGlyZW50cnkpKTsKIAogYWdhaW46Ci0J
aWYgKHBUY29uLT5wb3NpeF9leHRlbnNpb25zKQotCQlyYyA9IHNtYjMxMV9wb3NpeF9nZXRfaW5v
ZGVfaW5mbygmbmV3SW5vZGUsIGZ1bGxfcGF0aCwgcGFyZW50X2Rpcl9pbm9kZS0+aV9zYiwgeGlk
KTsKLQllbHNlIGlmIChwVGNvbi0+dW5peF9leHQpIHsKKwlpZiAocFRjb24tPnBvc2l4X2V4dGVu
c2lvbnMpIHsKKwkJcmMgPSBzbWIzMTFfcG9zaXhfZ2V0X2lub2RlX2luZm8oJm5ld0lub2RlLCBm
dWxsX3BhdGgsIE5VTEwsCisJCQkJCQkgcGFyZW50X2Rpcl9pbm9kZS0+aV9zYiwgeGlkKTsKKwl9
IGVsc2UgaWYgKHBUY29uLT51bml4X2V4dCkgewogCQlyYyA9IGNpZnNfZ2V0X2lub2RlX2luZm9f
dW5peCgmbmV3SW5vZGUsIGZ1bGxfcGF0aCwKIAkJCQkJICAgICAgcGFyZW50X2Rpcl9pbm9kZS0+
aV9zYiwgeGlkKTsKIAl9IGVsc2UgewpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9maWxlLmMg
Yi9mcy9zbWIvY2xpZW50L2ZpbGUuYwppbmRleCAzMmE4NTI1NDE1ZDkuLmQwMzg3OTE2ZGU5NSAx
MDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9maWxlLmMKKysrIGIvZnMvc21iL2NsaWVudC9maWxl
LmMKQEAgLTEwMjAsMTQgKzEwMjAsMTYgQEAgY2lmc19yZW9wZW5fZmlsZShzdHJ1Y3QgY2lmc0Zp
bGVJbmZvICpjZmlsZSwgYm9vbCBjYW5fZmx1c2gpCiAJCWlmICghaXNfaW50ZXJydXB0X2Vycm9y
KHJjKSkKIAkJCW1hcHBpbmdfc2V0X2Vycm9yKGlub2RlLT5pX21hcHBpbmcsIHJjKTsKIAotCQlp
ZiAodGNvbi0+cG9zaXhfZXh0ZW5zaW9ucykKLQkJCXJjID0gc21iMzExX3Bvc2l4X2dldF9pbm9k
ZV9pbmZvKCZpbm9kZSwgZnVsbF9wYXRoLCBpbm9kZS0+aV9zYiwgeGlkKTsKLQkJZWxzZSBpZiAo
dGNvbi0+dW5peF9leHQpCisJCWlmICh0Y29uLT5wb3NpeF9leHRlbnNpb25zKSB7CisJCQlyYyA9
IHNtYjMxMV9wb3NpeF9nZXRfaW5vZGVfaW5mbygmaW5vZGUsIGZ1bGxfcGF0aCwKKwkJCQkJCQkg
TlVMTCwgaW5vZGUtPmlfc2IsIHhpZCk7CisJCX0gZWxzZSBpZiAodGNvbi0+dW5peF9leHQpIHsK
IAkJCXJjID0gY2lmc19nZXRfaW5vZGVfaW5mb191bml4KCZpbm9kZSwgZnVsbF9wYXRoLAogCQkJ
CQkJICAgICAgaW5vZGUtPmlfc2IsIHhpZCk7Ci0JCWVsc2UKKwkJfSBlbHNlIHsKIAkJCXJjID0g
Y2lmc19nZXRfaW5vZGVfaW5mbygmaW5vZGUsIGZ1bGxfcGF0aCwgTlVMTCwKIAkJCQkJCSBpbm9k
ZS0+aV9zYiwgeGlkLCBOVUxMKTsKKwkJfQogCX0KIAkvKgogCSAqIEVsc2Ugd2UgYXJlIHdyaXRp
bmcgb3V0IGRhdGEgdG8gc2VydmVyIGFscmVhZHkgYW5kIGNvdWxkIGRlYWRsb2NrIGlmCmRpZmYg
LS1naXQgYS9mcy9zbWIvY2xpZW50L2lub2RlLmMgYi9mcy9zbWIvY2xpZW50L2lub2RlLmMKaW5k
ZXggMDljNWMwZjVjOTZlLi5iNzNiZjhhOTM0NDMgMTAwNjQ0Ci0tLSBhL2ZzL3NtYi9jbGllbnQv
aW5vZGUuYworKysgYi9mcy9zbWIvY2xpZW50L2lub2RlLmMKQEAgLTEwNjEsNyArMTA2MSw5IEBA
IHN0YXRpYyBpbnQgcmVwYXJzZV9pbmZvX3RvX2ZhdHRyKHN0cnVjdCBjaWZzX29wZW5faW5mb19k
YXRhICpkYXRhLAogCQkJCSBjb25zdCB1bnNpZ25lZCBpbnQgeGlkLAogCQkJCSBzdHJ1Y3QgY2lm
c190Y29uICp0Y29uLAogCQkJCSBjb25zdCBjaGFyICpmdWxsX3BhdGgsCi0JCQkJIHN0cnVjdCBj
aWZzX2ZhdHRyICpmYXR0cikKKwkJCQkgc3RydWN0IGNpZnNfZmF0dHIgKmZhdHRyLAorCQkJCSBz
dHJ1Y3QgY2lmc19zaWQgKm93bmVyLAorCQkJCSBzdHJ1Y3QgY2lmc19zaWQgKmdyb3VwKQogewog
CXN0cnVjdCBUQ1BfU2VydmVyX0luZm8gKnNlcnZlciA9IHRjb24tPnNlcy0+c2VydmVyOwogCXN0
cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IgPSBDSUZTX1NCKHNiKTsKQEAgLTEwOTIsNyArMTA5
NCw4IEBAIHN0YXRpYyBpbnQgcmVwYXJzZV9pbmZvX3RvX2ZhdHRyKHN0cnVjdCBjaWZzX29wZW5f
aW5mb19kYXRhICpkYXRhLAogCQlyYyA9IDA7CiAJCWdvdG8gb3V0OwogCWRlZmF1bHQ6Ci0JCWlm
IChkYXRhLT5zeW1saW5rX3RhcmdldCkgeworCQkvKiBDaGVjayBmb3IgY2FjaGVkIHJlcGFyc2Ug
cG9pbnQgZGF0YSAqLworCQlpZiAoZGF0YS0+c3ltbGlua190YXJnZXQgfHwgZGF0YS0+cmVwYXJz
ZS5idWYpIHsKIAkJCXJjID0gMDsKIAkJfSBlbHNlIGlmIChzZXJ2ZXItPm9wcy0+cGFyc2VfcmVw
YXJzZV9wb2ludCkgewogCQkJcmMgPSBzZXJ2ZXItPm9wcy0+cGFyc2VfcmVwYXJzZV9wb2ludChj
aWZzX3NiLApAQCAtMTEwMSw3ICsxMTA0LDEwIEBAIHN0YXRpYyBpbnQgcmVwYXJzZV9pbmZvX3Rv
X2ZhdHRyKHN0cnVjdCBjaWZzX29wZW5faW5mb19kYXRhICpkYXRhLAogCQlicmVhazsKIAl9CiAK
LQljaWZzX29wZW5faW5mb190b19mYXR0cihmYXR0ciwgZGF0YSwgc2IpOworCWlmICh0Y29uLT5w
b3NpeF9leHRlbnNpb25zKQorCQlzbWIzMTFfcG9zaXhfaW5mb190b19mYXR0cihmYXR0ciwgZGF0
YSwgb3duZXIsIGdyb3VwLCBzYik7CisJZWxzZQorCQljaWZzX29wZW5faW5mb190b19mYXR0cihm
YXR0ciwgZGF0YSwgc2IpOwogb3V0OgogCWZyZWVfcnNwX2J1Zihyc3BfYnVmdHlwZSwgcnNwX2lv
di5pb3ZfYmFzZSk7CiAJcmV0dXJuIHJjOwpAQCAtMTE1Miw3ICsxMTU4LDggQEAgc3RhdGljIGlu
dCBjaWZzX2dldF9mYXR0cihzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSAqZGF0YSwKIAkJICov
CiAJCWlmIChjaWZzX29wZW5fZGF0YV9yZXBhcnNlKGRhdGEpKSB7CiAJCQlyYyA9IHJlcGFyc2Vf
aW5mb190b19mYXR0cihkYXRhLCBzYiwgeGlkLCB0Y29uLAotCQkJCQkJICAgZnVsbF9wYXRoLCBm
YXR0cik7CisJCQkJCQkgICBmdWxsX3BhdGgsIGZhdHRyLAorCQkJCQkJICAgTlVMTCwgTlVMTCk7
CiAJCX0gZWxzZSB7CiAJCQljaWZzX29wZW5faW5mb190b19mYXR0cihmYXR0ciwgZGF0YSwgc2Ip
OwogCQl9CkBAIC0xMjkwLDE4ICsxMjk3LDE5IEBAIGludCBjaWZzX2dldF9pbm9kZV9pbmZvKHN0
cnVjdCBpbm9kZSAqKmlub2RlLAogCXJldHVybiByYzsKIH0KIAotc3RhdGljIGludCBzbWIzMTFf
cG9zaXhfZ2V0X2ZhdHRyKHN0cnVjdCBjaWZzX2ZhdHRyICpmYXR0ciwKK3N0YXRpYyBpbnQgc21i
MzExX3Bvc2l4X2dldF9mYXR0cihzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSAqZGF0YSwKKwkJ
CQkgIHN0cnVjdCBjaWZzX2ZhdHRyICpmYXR0ciwKIAkJCQkgIGNvbnN0IGNoYXIgKmZ1bGxfcGF0
aCwKIAkJCQkgIHN0cnVjdCBzdXBlcl9ibG9jayAqc2IsCiAJCQkJICBjb25zdCB1bnNpZ25lZCBp
bnQgeGlkKQogewotCXN0cnVjdCBjaWZzX29wZW5faW5mb19kYXRhIGRhdGEgPSB7fTsKKwlzdHJ1
Y3QgY2lmc19vcGVuX2luZm9fZGF0YSB0bXBfZGF0YSA9IHt9OwogCXN0cnVjdCBjaWZzX3NiX2lu
Zm8gKmNpZnNfc2IgPSBDSUZTX1NCKHNiKTsKIAlzdHJ1Y3QgY2lmc190Y29uICp0Y29uOwogCXN0
cnVjdCB0Y29uX2xpbmsgKnRsaW5rOwogCXN0cnVjdCBjaWZzX3NpZCBvd25lciwgZ3JvdXA7CiAJ
aW50IHRtcHJjOwotCWludCByYzsKKwlpbnQgcmMgPSAwOwogCiAJdGxpbmsgPSBjaWZzX3NiX3Rs
aW5rKGNpZnNfc2IpOwogCWlmIChJU19FUlIodGxpbmspKQpAQCAtMTMwOSwxMiArMTMxNywxNCBA
QCBzdGF0aWMgaW50IHNtYjMxMV9wb3NpeF9nZXRfZmF0dHIoc3RydWN0IGNpZnNfZmF0dHIgKmZh
dHRyLAogCXRjb24gPSB0bGlua190Y29uKHRsaW5rKTsKIAogCS8qCi0JICogMS4gRmV0Y2ggZmls
ZSBtZXRhZGF0YQorCSAqIDEuIEZldGNoIGZpbGUgbWV0YWRhdGEgaWYgbm90IHByb3ZpZGVkIChk
YXRhKQogCSAqLwotCi0JcmMgPSBzbWIzMTFfcG9zaXhfcXVlcnlfcGF0aF9pbmZvKHhpZCwgdGNv
biwgY2lmc19zYiwKLQkJCQkJICBmdWxsX3BhdGgsICZkYXRhLAotCQkJCQkgICZvd25lciwgJmdy
b3VwKTsKKwlpZiAoIWRhdGEpIHsKKwkJcmMgPSBzbWIzMTFfcG9zaXhfcXVlcnlfcGF0aF9pbmZv
KHhpZCwgdGNvbiwgY2lmc19zYiwKKwkJCQkJCSAgZnVsbF9wYXRoLCAmdG1wX2RhdGEsCisJCQkJ
CQkgICZvd25lciwgJmdyb3VwKTsKKwkJZGF0YSA9ICZ0bXBfZGF0YTsKKwl9CiAKIAkvKgogCSAq
IDIuIENvbnZlcnQgaXQgdG8gaW50ZXJuYWwgY2lmcyBtZXRhZGF0YSAoZmF0dHIpCkBAIC0xMzIy
LDcgKzEzMzIsMTQgQEAgc3RhdGljIGludCBzbWIzMTFfcG9zaXhfZ2V0X2ZhdHRyKHN0cnVjdCBj
aWZzX2ZhdHRyICpmYXR0ciwKIAogCXN3aXRjaCAocmMpIHsKIAljYXNlIDA6Ci0JCXNtYjMxMV9w
b3NpeF9pbmZvX3RvX2ZhdHRyKGZhdHRyLCAmZGF0YSwgJm93bmVyLCAmZ3JvdXAsIHNiKTsKKwkJ
aWYgKGNpZnNfb3Blbl9kYXRhX3JlcGFyc2UoZGF0YSkpIHsKKwkJCXJjID0gcmVwYXJzZV9pbmZv
X3RvX2ZhdHRyKGRhdGEsIHNiLCB4aWQsIHRjb24sCisJCQkJCQkgICBmdWxsX3BhdGgsIGZhdHRy
LAorCQkJCQkJICAgJm93bmVyLCAmZ3JvdXApOworCQl9IGVsc2UgeworCQkJc21iMzExX3Bvc2l4
X2luZm9fdG9fZmF0dHIoZmF0dHIsIGRhdGEsCisJCQkJCQkgICAmb3duZXIsICZncm91cCwgc2Ip
OworCQl9CiAJCWJyZWFrOwogCWNhc2UgLUVSRU1PVEU6CiAJCS8qIERGUyBsaW5rLCBubyBtZXRh
ZGF0YSBhdmFpbGFibGUgb24gdGhpcyBzZXJ2ZXIgKi8KQEAgLTEzNTMsMTIgKzEzNzAsMTUgQEAg
c3RhdGljIGludCBzbWIzMTFfcG9zaXhfZ2V0X2ZhdHRyKHN0cnVjdCBjaWZzX2ZhdHRyICpmYXR0
ciwKIAogb3V0OgogCWNpZnNfcHV0X3RsaW5rKHRsaW5rKTsKLQljaWZzX2ZyZWVfb3Blbl9pbmZv
KCZkYXRhKTsKKwljaWZzX2ZyZWVfb3Blbl9pbmZvKGRhdGEpOwogCXJldHVybiByYzsKIH0KIAot
aW50IHNtYjMxMV9wb3NpeF9nZXRfaW5vZGVfaW5mbyhzdHJ1Y3QgaW5vZGUgKippbm9kZSwgY29u
c3QgY2hhciAqZnVsbF9wYXRoLAotCQkJCXN0cnVjdCBzdXBlcl9ibG9jayAqc2IsIGNvbnN0IHVu
c2lnbmVkIGludCB4aWQpCitpbnQgc21iMzExX3Bvc2l4X2dldF9pbm9kZV9pbmZvKHN0cnVjdCBp
bm9kZSAqKmlub2RlLAorCQkJCWNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKKwkJCQlzdHJ1Y3QgY2lm
c19vcGVuX2luZm9fZGF0YSAqZGF0YSwKKwkJCQlzdHJ1Y3Qgc3VwZXJfYmxvY2sgKnNiLAorCQkJ
CWNvbnN0IHVuc2lnbmVkIGludCB4aWQpCiB7CiAJc3RydWN0IGNpZnNfZmF0dHIgZmF0dHIgPSB7
fTsKIAlpbnQgcmM7CkBAIC0xMzY4LDcgKzEzODgsNyBAQCBpbnQgc21iMzExX3Bvc2l4X2dldF9p
bm9kZV9pbmZvKHN0cnVjdCBpbm9kZSAqKmlub2RlLCBjb25zdCBjaGFyICpmdWxsX3BhdGgsCiAJ
CXJldHVybiAwOwogCX0KIAotCXJjID0gc21iMzExX3Bvc2l4X2dldF9mYXR0cigmZmF0dHIsIGZ1
bGxfcGF0aCwgc2IsIHhpZCk7CisJcmMgPSBzbWIzMTFfcG9zaXhfZ2V0X2ZhdHRyKGRhdGEsICZm
YXR0ciwgZnVsbF9wYXRoLCBzYiwgeGlkKTsKIAlpZiAocmMpCiAJCWdvdG8gb3V0OwogCkBAIC0x
NTE2LDcgKzE1MzYsNyBAQCBzdHJ1Y3QgaW5vZGUgKmNpZnNfcm9vdF9pZ2V0KHN0cnVjdCBzdXBl
cl9ibG9jayAqc2IpCiAKIAljb252ZXJ0X2RlbGltaXRlcihwYXRoLCBDSUZTX0RJUl9TRVAoY2lm
c19zYikpOwogCWlmICh0Y29uLT5wb3NpeF9leHRlbnNpb25zKQotCQlyYyA9IHNtYjMxMV9wb3Np
eF9nZXRfZmF0dHIoJmZhdHRyLCBwYXRoLCBzYiwgeGlkKTsKKwkJcmMgPSBzbWIzMTFfcG9zaXhf
Z2V0X2ZhdHRyKE5VTEwsICZmYXR0ciwgcGF0aCwgc2IsIHhpZCk7CiAJZWxzZQogCQlyYyA9IGNp
ZnNfZ2V0X2ZhdHRyKE5VTEwsIHNiLCB4aWQsIE5VTEwsICZmYXR0ciwgJmlub2RlLCBwYXRoKTsK
IApAQCAtMTg4OSwxNiArMTkwOSwxOCBAQCBjaWZzX21rZGlyX3FpbmZvKHN0cnVjdCBpbm9kZSAq
cGFyZW50LCBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIHVtb2RlX3QgbW9kZSwKIAlpbnQgcmMgPSAw
OwogCXN0cnVjdCBpbm9kZSAqaW5vZGUgPSBOVUxMOwogCi0JaWYgKHRjb24tPnBvc2l4X2V4dGVu
c2lvbnMpCi0JCXJjID0gc21iMzExX3Bvc2l4X2dldF9pbm9kZV9pbmZvKCZpbm9kZSwgZnVsbF9w
YXRoLCBwYXJlbnQtPmlfc2IsIHhpZCk7CisJaWYgKHRjb24tPnBvc2l4X2V4dGVuc2lvbnMpIHsK
KwkJcmMgPSBzbWIzMTFfcG9zaXhfZ2V0X2lub2RlX2luZm8oJmlub2RlLCBmdWxsX3BhdGgsCisJ
CQkJCQkgTlVMTCwgcGFyZW50LT5pX3NiLCB4aWQpOwogI2lmZGVmIENPTkZJR19DSUZTX0FMTE9X
X0lOU0VDVVJFX0xFR0FDWQotCWVsc2UgaWYgKHRjb24tPnVuaXhfZXh0KQorCX0gZWxzZSBpZiAo
dGNvbi0+dW5peF9leHQpIHsKIAkJcmMgPSBjaWZzX2dldF9pbm9kZV9pbmZvX3VuaXgoJmlub2Rl
LCBmdWxsX3BhdGgsIHBhcmVudC0+aV9zYiwKIAkJCQkJICAgICAgeGlkKTsKICNlbmRpZiAvKiBD
T05GSUdfQ0lGU19BTExPV19JTlNFQ1VSRV9MRUdBQ1kgKi8KLQllbHNlCisJfSBlbHNlIHsKIAkJ
cmMgPSBjaWZzX2dldF9pbm9kZV9pbmZvKCZpbm9kZSwgZnVsbF9wYXRoLCBOVUxMLCBwYXJlbnQt
Pmlfc2IsCiAJCQkJCSB4aWQsIE5VTEwpOworCX0KIAogCWlmIChyYykKIAkJcmV0dXJuIHJjOwpA
QCAtMjU3OSwxMyArMjYwMSwxNSBAQCBpbnQgY2lmc19yZXZhbGlkYXRlX2RlbnRyeV9hdHRyKHN0
cnVjdCBkZW50cnkgKmRlbnRyeSkKIAkJIGRlbnRyeSwgY2lmc19nZXRfdGltZShkZW50cnkpLCBq
aWZmaWVzKTsKIAogYWdhaW46Ci0JaWYgKGNpZnNfc2JfbWFzdGVyX3Rjb24oQ0lGU19TQihzYikp
LT5wb3NpeF9leHRlbnNpb25zKQotCQlyYyA9IHNtYjMxMV9wb3NpeF9nZXRfaW5vZGVfaW5mbygm
aW5vZGUsIGZ1bGxfcGF0aCwgc2IsIHhpZCk7Ci0JZWxzZSBpZiAoY2lmc19zYl9tYXN0ZXJfdGNv
bihDSUZTX1NCKHNiKSktPnVuaXhfZXh0KQorCWlmIChjaWZzX3NiX21hc3Rlcl90Y29uKENJRlNf
U0Ioc2IpKS0+cG9zaXhfZXh0ZW5zaW9ucykgeworCQlyYyA9IHNtYjMxMV9wb3NpeF9nZXRfaW5v
ZGVfaW5mbygmaW5vZGUsIGZ1bGxfcGF0aCwKKwkJCQkJCSBOVUxMLCBzYiwgeGlkKTsKKwl9IGVs
c2UgaWYgKGNpZnNfc2JfbWFzdGVyX3Rjb24oQ0lGU19TQihzYikpLT51bml4X2V4dCkgewogCQly
YyA9IGNpZnNfZ2V0X2lub2RlX2luZm9fdW5peCgmaW5vZGUsIGZ1bGxfcGF0aCwgc2IsIHhpZCk7
Ci0JZWxzZQorCX0gZWxzZSB7CiAJCXJjID0gY2lmc19nZXRfaW5vZGVfaW5mbygmaW5vZGUsIGZ1
bGxfcGF0aCwgTlVMTCwgc2IsCiAJCQkJCSB4aWQsIE5VTEwpOworCX0KIAlpZiAocmMgPT0gLUVB
R0FJTiAmJiBjb3VudCsrIDwgMTApCiAJCWdvdG8gYWdhaW47CiBvdXQ6CmRpZmYgLS1naXQgYS9m
cy9zbWIvY2xpZW50L2xpbmsuYyBiL2ZzL3NtYi9jbGllbnQvbGluay5jCmluZGV4IGExZGE1MGU2
NmZiYi4uNWNlMGY3NGJlNGVjIDEwMDY0NAotLS0gYS9mcy9zbWIvY2xpZW50L2xpbmsuYworKysg
Yi9mcy9zbWIvY2xpZW50L2xpbmsuYwpAQCAtNjE0LDE0ICs2MTQsMTYgQEAgY2lmc19zeW1saW5r
KHN0cnVjdCBtbnRfaWRtYXAgKmlkbWFwLCBzdHJ1Y3QgaW5vZGUgKmlub2RlLAogCQkJCQljaWZz
X3NiX3RhcmdldC0+bG9jYWxfbmxzKTsgKi8KIAogCWlmIChyYyA9PSAwKSB7Ci0JCWlmIChwVGNv
bi0+cG9zaXhfZXh0ZW5zaW9ucykKLQkJCXJjID0gc21iMzExX3Bvc2l4X2dldF9pbm9kZV9pbmZv
KCZuZXdpbm9kZSwgZnVsbF9wYXRoLCBpbm9kZS0+aV9zYiwgeGlkKTsKLQkJZWxzZSBpZiAocFRj
b24tPnVuaXhfZXh0KQorCQlpZiAocFRjb24tPnBvc2l4X2V4dGVuc2lvbnMpIHsKKwkJCXJjID0g
c21iMzExX3Bvc2l4X2dldF9pbm9kZV9pbmZvKCZuZXdpbm9kZSwgZnVsbF9wYXRoLAorCQkJCQkJ
CSBOVUxMLCBpbm9kZS0+aV9zYiwgeGlkKTsKKwkJfSBlbHNlIGlmIChwVGNvbi0+dW5peF9leHQp
IHsKIAkJCXJjID0gY2lmc19nZXRfaW5vZGVfaW5mb191bml4KCZuZXdpbm9kZSwgZnVsbF9wYXRo
LAogCQkJCQkJICAgICAgaW5vZGUtPmlfc2IsIHhpZCk7Ci0JCWVsc2UKKwkJfSBlbHNlIHsKIAkJ
CXJjID0gY2lmc19nZXRfaW5vZGVfaW5mbygmbmV3aW5vZGUsIGZ1bGxfcGF0aCwgTlVMTCwKIAkJ
CQkJCSBpbm9kZS0+aV9zYiwgeGlkLCBOVUxMKTsKKwkJfQogCiAJCWlmIChyYyAhPSAwKSB7CiAJ
CQljaWZzX2RiZyhGWUksICJDcmVhdGUgc3ltbGluayBvaywgZ2V0aW5vZGVpbmZvIGZhaWwgcmMg
PSAlZFxuIiwKZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvc21iMmdsb2IuaCBiL2ZzL3NtYi9j
bGllbnQvc21iMmdsb2IuaAppbmRleCA4MmU5MTZhZDE2N2MuLmNhODdhMDAxMWMzMyAxMDA2NDQK
LS0tIGEvZnMvc21iL2NsaWVudC9zbWIyZ2xvYi5oCisrKyBiL2ZzL3NtYi9jbGllbnQvc21iMmds
b2IuaApAQCAtMjMsMTcgKzIzLDIwIEBACiAgKiBJZGVudGlmaWVycyBmb3IgZnVuY3Rpb25zIHRo
YXQgdXNlIHRoZSBvcGVuLCBvcGVyYXRpb24sIGNsb3NlIHBhdHRlcm4KICAqIGluIHNtYjJpbm9k
ZS5jOnNtYjJfY29tcG91bmRfb3AoKQogICovCi0jZGVmaW5lIFNNQjJfT1BfU0VUX0RFTEVURSAx
Ci0jZGVmaW5lIFNNQjJfT1BfU0VUX0lORk8gMgotI2RlZmluZSBTTUIyX09QX1FVRVJZX0lORk8g
MwotI2RlZmluZSBTTUIyX09QX1FVRVJZX0RJUiA0Ci0jZGVmaW5lIFNNQjJfT1BfTUtESVIgNQot
I2RlZmluZSBTTUIyX09QX1JFTkFNRSA2Ci0jZGVmaW5lIFNNQjJfT1BfREVMRVRFIDcKLSNkZWZp
bmUgU01CMl9PUF9IQVJETElOSyA4Ci0jZGVmaW5lIFNNQjJfT1BfU0VUX0VPRiA5Ci0jZGVmaW5l
IFNNQjJfT1BfUk1ESVIgMTAKLSNkZWZpbmUgU01CMl9PUF9QT1NJWF9RVUVSWV9JTkZPIDExCitl
bnVtIHNtYjJfY29tcG91bmRfb3BzIHsKKwlTTUIyX09QX1NFVF9ERUxFVEUgPSAxLAorCVNNQjJf
T1BfU0VUX0lORk8sCisJU01CMl9PUF9RVUVSWV9JTkZPLAorCVNNQjJfT1BfUVVFUllfRElSLAor
CVNNQjJfT1BfTUtESVIsCisJU01CMl9PUF9SRU5BTUUsCisJU01CMl9PUF9ERUxFVEUsCisJU01C
Ml9PUF9IQVJETElOSywKKwlTTUIyX09QX1NFVF9FT0YsCisJU01CMl9PUF9STURJUiwKKwlTTUIy
X09QX1BPU0lYX1FVRVJZX0lORk8sCisJU01CMl9PUF9TRVRfUkVQQVJTRQorfTsKIAogLyogVXNl
ZCB3aGVuIGNvbnN0cnVjdGluZyBjaGFpbmVkIHJlYWQgcmVxdWVzdHMuICovCiAjZGVmaW5lIENI
QUlORURfUkVRVUVTVCAxCmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L3NtYjJpbm9kZS5jIGIv
ZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYwppbmRleCA5OGZhNGYwMmZiZDMuLmQ2NjJiYWQzYjcw
MyAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYworKysgYi9mcy9zbWIvY2xp
ZW50L3NtYjJpbm9kZS5jCkBAIC0zNDcsNiArMzQ3LDIyIEBAIHN0YXRpYyBpbnQgc21iMl9jb21w
b3VuZF9vcChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAog
CQkJc21iMl9zZXRfcmVsYXRlZCgmcnFzdFtudW1fcnFzdCsrXSk7CiAJCQl0cmFjZV9zbWIzX2hh
cmRsaW5rX2VudGVyKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQsIGZ1bGxfcGF0aCk7CiAJCQli
cmVhazsKKwkJY2FzZSBTTUIyX09QX1NFVF9SRVBBUlNFOgorCQkJcnFzdFtudW1fcnFzdF0ucnFf
aW92ID0gdmFycy0+aW9faW92OworCQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IEFSUkFZX1NJ
WkUodmFycy0+aW9faW92KTsKKworCQkJcmMgPSBTTUIyX2lvY3RsX2luaXQodGNvbiwgc2VydmVy
LCAmcnFzdFtudW1fcnFzdF0sCisJCQkJCSAgICAgQ09NUE9VTkRfRklELCBDT01QT1VORF9GSUQs
CisJCQkJCSAgICAgRlNDVExfU0VUX1JFUEFSU0VfUE9JTlQsCisJCQkJCSAgICAgaW5faW92W2ld
Lmlvdl9iYXNlLAorCQkJCQkgICAgIGluX2lvdltpXS5pb3ZfbGVuLCAwKTsKKwkJCWlmIChyYykK
KwkJCQlnb3RvIGZpbmlzaGVkOworCQkJc21iMl9zZXRfbmV4dF9jb21tYW5kKHRjb24sICZycXN0
W251bV9ycXN0XSk7CisJCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251bV9ycXN0KytdKTsKKwkJ
CXRyYWNlX3NtYjNfc2V0X3JlcGFyc2VfY29tcG91bmRfZW50ZXIoeGlkLCBzZXMtPlN1aWQsCisJ
CQkJCQkJICAgICAgdGNvbi0+dGlkLCBmdWxsX3BhdGgpOworCQkJYnJlYWs7CiAJCWRlZmF1bHQ6
CiAJCQljaWZzX2RiZyhWRlMsICJJbnZhbGlkIGNvbW1hbmRcbiIpOwogCQkJcmMgPSAtRUlOVkFM
OwpAQCAtNTAzLDYgKzUxOSwxNiBAQCBzdGF0aWMgaW50IHNtYjJfY29tcG91bmRfb3AoY29uc3Qg
dW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJCQkJCQkJICB0Y29u
LT50aWQpOwogCQkJU01CMl9zZXRfaW5mb19mcmVlKCZycXN0W251bV9ycXN0KytdKTsKIAkJCWJy
ZWFrOworCQljYXNlIFNNQjJfT1BfU0VUX1JFUEFSU0U6CisJCQlpZiAocmMpIHsKKwkJCQl0cmFj
ZV9zbWIzX3NldF9yZXBhcnNlX2NvbXBvdW5kX2Vycih4aWQsICBzZXMtPlN1aWQsCisJCQkJCQkJ
CSAgICB0Y29uLT50aWQsIHJjKTsKKwkJCX0gZWxzZSB7CisJCQkJdHJhY2Vfc21iM19zZXRfcmVw
YXJzZV9jb21wb3VuZF9kb25lKHhpZCwgc2VzLT5TdWlkLAorCQkJCQkJCQkgICAgIHRjb24tPnRp
ZCk7CisJCQl9CisJCQlTTUIyX2lvY3RsX2ZyZWUoJnJxc3RbbnVtX3Jxc3QrK10pOworCQkJYnJl
YWs7CiAJCX0KIAl9CiAJU01CMl9jbG9zZV9mcmVlKCZycXN0W251bV9ycXN0XSk7CkBAIC04ODcs
MyArOTEzLDUyIEBAIHNtYjJfc2V0X2ZpbGVfaW5mbyhzdHJ1Y3QgaW5vZGUgKmlub2RlLCBjb25z
dCBjaGFyICpmdWxsX3BhdGgsCiAJY2lmc19wdXRfdGxpbmsodGxpbmspOwogCXJldHVybiByYzsK
IH0KKworc3RydWN0IGlub2RlICpzbWIyX2dldF9yZXBhcnNlX2lub2RlKHN0cnVjdCBjaWZzX29w
ZW5faW5mb19kYXRhICpkYXRhLAorCQkJCSAgICAgc3RydWN0IHN1cGVyX2Jsb2NrICpzYiwKKwkJ
CQkgICAgIGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCQkJICAgICBzdHJ1Y3QgY2lmc190Y29u
ICp0Y29uLAorCQkJCSAgICAgY29uc3QgY2hhciAqZnVsbF9wYXRoLAorCQkJCSAgICAgc3RydWN0
IGt2ZWMgKmlvdikKK3sKKwlzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiID0gQ0lGU19TQihz
Yik7CisJc3RydWN0IGNpZnNGaWxlSW5mbyAqY2ZpbGU7CisJc3RydWN0IGlub2RlICpuZXcgPSBO
VUxMOworCXN0cnVjdCBrdmVjIGluX2lvdlsyXTsKKwlpbnQgY21kc1syXTsKKwlpbnQgZGEsIGNv
LCBjZDsKKwlpbnQgcmM7CisKKwlkYSA9IFNZTkNIUk9OSVpFIHwgREVMRVRFIHwKKwkJRklMRV9S
RUFEX0FUVFJJQlVURVMgfAorCQlGSUxFX1dSSVRFX0FUVFJJQlVURVM7CisJY28gPSBDUkVBVEVf
Tk9UX0RJUiB8IE9QRU5fUkVQQVJTRV9QT0lOVDsKKwljZCA9IEZJTEVfQ1JFQVRFOworCWNtZHNb
MF0gPSBTTUIyX09QX1NFVF9SRVBBUlNFOworCWluX2lvdlswXSA9ICppb3Y7CisJaW5faW92WzFd
Lmlvdl9iYXNlID0gZGF0YTsKKwlpbl9pb3ZbMV0uaW92X2xlbiA9IHNpemVvZigqZGF0YSk7CisK
KwlpZiAodGNvbi0+cG9zaXhfZXh0ZW5zaW9ucykgeworCQljbWRzWzFdID0gU01CMl9PUF9QT1NJ
WF9RVUVSWV9JTkZPOworCQljaWZzX2dldF93cml0YWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwg
RklORF9XUl9BTlksICZjZmlsZSk7CisJCXJjID0gc21iMl9jb21wb3VuZF9vcCh4aWQsIHRjb24s
IGNpZnNfc2IsIGZ1bGxfcGF0aCwKKwkJCQkgICAgICBkYSwgY2QsIGNvLCBBQ0xfTk9fTU9ERSwg
aW5faW92LAorCQkJCSAgICAgIGNtZHMsIDIsIGNmaWxlLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxM
KTsKKwkJaWYgKCFyYykgeworCQkJcmMgPSBzbWIzMTFfcG9zaXhfZ2V0X2lub2RlX2luZm8oJm5l
dywgZnVsbF9wYXRoLAorCQkJCQkJCSBkYXRhLCBzYiwgeGlkKTsKKwkJfQorCX0gZWxzZSB7CisJ
CWNtZHNbMV0gPSBTTUIyX09QX1FVRVJZX0lORk87CisJCWNpZnNfZ2V0X3dyaXRhYmxlX3BhdGgo
dGNvbiwgZnVsbF9wYXRoLCBGSU5EX1dSX0FOWSwgJmNmaWxlKTsKKwkJcmMgPSBzbWIyX2NvbXBv
dW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9wYXRoLAorCQkJCSAgICAgIGRhLCBjZCwg
Y28sIEFDTF9OT19NT0RFLCBpbl9pb3YsCisJCQkJICAgICAgY21kcywgMiwgY2ZpbGUsIE5VTEws
IE5VTEwsIE5VTEwsIE5VTEwpOworCQlpZiAoIXJjKSB7CisJCQlyYyA9IGNpZnNfZ2V0X2lub2Rl
X2luZm8oJm5ldywgZnVsbF9wYXRoLAorCQkJCQkJIGRhdGEsIHNiLCB4aWQsIE5VTEwpOworCQl9
CisJfQorCXJldHVybiByYyA/IEVSUl9QVFIocmMpIDogbmV3OworfQpkaWZmIC0tZ2l0IGEvZnMv
c21iL2NsaWVudC9zbWIyb3BzLmMgYi9mcy9zbWIvY2xpZW50L3NtYjJvcHMuYwppbmRleCA2NmIz
MTAyMDg1NDUuLjc0ZmU1NzEyMTk3OSAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9zbWIyb3Bz
LmMKKysrIGIvZnMvc21iL2NsaWVudC9zbWIyb3BzLmMKQEAgLTUxNTksMTEgKzUxNTksODggQEAg
aW50IGNpZnNfc2Z1X21ha2Vfbm9kZSh1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgaW5vZGUgKmlu
b2RlLAogCXJldHVybiByYzsKIH0KIAorc3RhdGljIGlubGluZSB1NjQgbW9kZV9uZnNfdHlwZSht
b2RlX3QgbW9kZSkKK3sKKwlzd2l0Y2ggKG1vZGUgJiBTX0lGTVQpIHsKKwljYXNlIFNfSUZCTEs6
IHJldHVybiBORlNfU1BFQ0ZJTEVfQkxLOworCWNhc2UgU19JRkNIUjogcmV0dXJuIE5GU19TUEVD
RklMRV9DSFI7CisJY2FzZSBTX0lGSUZPOiByZXR1cm4gTkZTX1NQRUNGSUxFX0ZJRk87CisJY2Fz
ZSBTX0lGU09DSzogcmV0dXJuIE5GU19TUEVDRklMRV9TT0NLOworCX0KKwlyZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCBuZnNfc2V0X3JlcGFyc2VfYnVmKHN0cnVjdCByZXBhcnNlX3Bvc2l4X2Rh
dGEgKmJ1ZiwKKwkJCSAgICAgICBtb2RlX3QgbW9kZSwgZGV2X3QgZGV2LAorCQkJICAgICAgIHN0
cnVjdCBrdmVjICppb3YpCit7CisJdTY0IHR5cGU7CisJdTE2IGxlbiwgZGxlbjsKKworCWxlbiA9
IHNpemVvZigqYnVmKTsKKworCXN3aXRjaCAoKHR5cGUgPSBtb2RlX25mc190eXBlKG1vZGUpKSkg
eworCWNhc2UgTkZTX1NQRUNGSUxFX0JMSzoKKwljYXNlIE5GU19TUEVDRklMRV9DSFI6CisJCWRs
ZW4gPSBzaXplb2YoX19sZTY0KTsKKwkJYnJlYWs7CisJY2FzZSBORlNfU1BFQ0ZJTEVfRklGTzoK
KwljYXNlIE5GU19TUEVDRklMRV9TT0NLOgorCQlkbGVuID0gMDsKKwkJYnJlYWs7CisJZGVmYXVs
dDoKKwkJcmV0dXJuIC1FT1BOT1RTVVBQOworCX0KKworCWJ1Zi0+UmVwYXJzZVRhZyA9IGNwdV90
b19sZTMyKElPX1JFUEFSU0VfVEFHX05GUyk7CisJYnVmLT5SZXNlcnZlZCA9IDA7CisJYnVmLT5J
bm9kZVR5cGUgPSBjcHVfdG9fbGU2NCh0eXBlKTsKKwlidWYtPlJlcGFyc2VEYXRhTGVuZ3RoID0g
Y3B1X3RvX2xlMTYobGVuICsgZGxlbiAtCisJCQkJCSAgICAgc2l6ZW9mKHN0cnVjdCByZXBhcnNl
X2RhdGFfYnVmZmVyKSk7CisJKihfX2xlNjQgKilidWYtPkRhdGFCdWZmZXIgPSBjcHVfdG9fbGU2
NCgoKHU2NClNQUpPUihkZXYpIDw8IDMyKSB8CisJCQkJCQkgTUlOT1IoZGV2KSk7CisJaW92LT5p
b3ZfYmFzZSA9IGJ1ZjsKKwlpb3YtPmlvdl9sZW4gPSBsZW4gKyBkbGVuOworCXJldHVybiAwOwor
fQorCitzdGF0aWMgaW50IG5mc19tYWtlX25vZGUodW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGlu
b2RlICppbm9kZSwKKwkJCSBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIHN0cnVjdCBjaWZzX3Rjb24g
KnRjb24sCisJCQkgY29uc3QgY2hhciAqZnVsbF9wYXRoLCB1bW9kZV90IG1vZGUsIGRldl90IGRl
dikKK3sKKwlzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSBkYXRhOworCXN0cnVjdCByZXBhcnNl
X3Bvc2l4X2RhdGEgKnA7CisJc3RydWN0IGlub2RlICpuZXc7CisJc3RydWN0IGt2ZWMgaW92Owor
CV9fdTggYnVmW3NpemVvZigqcCkgKyBzaXplb2YoX19sZTY0KV07CisJaW50IHJjOworCisJcCA9
IChzdHJ1Y3QgcmVwYXJzZV9wb3NpeF9kYXRhICopYnVmOworCXJjID0gbmZzX3NldF9yZXBhcnNl
X2J1ZihwLCBtb2RlLCBkZXYsICZpb3YpOworCWlmIChyYykKKwkJcmV0dXJuIHJjOworCisJZGF0
YSA9IChzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSkgeworCQkucmVwYXJzZV9wb2ludCA9IHRy
dWUsCisJCS5yZXBhcnNlID0geyAudGFnID0gSU9fUkVQQVJTRV9UQUdfTkZTLCAucG9zaXggPSBw
LCB9LAorCX07CisKKwluZXcgPSBzbWIyX2dldF9yZXBhcnNlX2lub2RlKCZkYXRhLCBpbm9kZS0+
aV9zYiwgeGlkLAorCQkJCSAgICAgdGNvbiwgZnVsbF9wYXRoLCAmaW92KTsKKwlpZiAoIUlTX0VS
UihuZXcpKQorCQlkX2luc3RhbnRpYXRlKGRlbnRyeSwgbmV3KTsKKwllbHNlCisJCXJjID0gUFRS
X0VSUihuZXcpOworCWNpZnNfZnJlZV9vcGVuX2luZm8oJmRhdGEpOworCXJldHVybiByYzsKK30K
Kwogc3RhdGljIGludCBzbWIyX21ha2Vfbm9kZSh1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgaW5v
ZGUgKmlub2RlLAogCQkJICBzdHJ1Y3QgZGVudHJ5ICpkZW50cnksIHN0cnVjdCBjaWZzX3Rjb24g
KnRjb24sCiAJCQkgIGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwgdW1vZGVfdCBtb2RlLCBkZXZfdCBk
ZXYpCiB7CiAJc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiA9IENJRlNfU0IoaW5vZGUtPmlf
c2IpOworCWludCByYzsKIAogCS8qCiAJICogQ2hlY2sgaWYgbW91bnRlZCB3aXRoIG1vdW50IHBh
cm0gJ3NmdScgbW91bnQgcGFybS4KQEAgLTUxNzEsMTUgKzUyNDgsMTQgQEAgc3RhdGljIGludCBz
bWIyX21ha2Vfbm9kZSh1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgaW5vZGUgKmlub2RlLAogCSAq
IHN1cHBvcnRzIGJsb2NrIGFuZCBjaGFyIGRldmljZSAobm8gc29ja2V0ICYgZmlmbyksCiAJICog
YW5kIHdhcyB1c2VkIGJ5IGRlZmF1bHQgaW4gZWFybGllciB2ZXJzaW9ucyBvZiBXaW5kb3dzCiAJ
ICovCi0JaWYgKCEoY2lmc19zYi0+bW50X2NpZnNfZmxhZ3MgJiBDSUZTX01PVU5UX1VOWF9FTVVM
KSkKLQkJcmV0dXJuIC1FUEVSTTsKLQkvKgotCSAqIFRPRE86IEFkZCBhYmlsaXR5IHRvIGNyZWF0
ZSBpbnN0ZWFkIHZpYSByZXBhcnNlIHBvaW50LiBXaW5kb3dzIChlLmcuCi0JICogdGhlaXIgY3Vy
cmVudCBORlMgc2VydmVyKSB1c2VzIHRoaXMgYXBwcm9hY2ggdG8gZXhwb3NlIHNwZWNpYWwgZmls
ZXMKLQkgKiBvdmVyIFNNQjIvU01CMyBhbmQgU2FtYmEgd2lsbCBkbyB0aGlzIHdpdGggU01CMy4x
LjEgUE9TSVggRXh0ZW5zaW9ucwotCSAqLwotCXJldHVybiBjaWZzX3NmdV9tYWtlX25vZGUoeGlk
LCBpbm9kZSwgZGVudHJ5LCB0Y29uLAotCQkJCSAgZnVsbF9wYXRoLCBtb2RlLCBkZXYpOworCWlm
IChjaWZzX3NiLT5tbnRfY2lmc19mbGFncyAmIENJRlNfTU9VTlRfVU5YX0VNVUwpIHsKKwkJcmMg
PSBjaWZzX3NmdV9tYWtlX25vZGUoeGlkLCBpbm9kZSwgZGVudHJ5LCB0Y29uLAorCQkJCQlmdWxs
X3BhdGgsIG1vZGUsIGRldik7CisJfSBlbHNlIHsKKwkJcmMgPSBuZnNfbWFrZV9ub2RlKHhpZCwg
aW5vZGUsIGRlbnRyeSwgdGNvbiwKKwkJCQkgICBmdWxsX3BhdGgsIG1vZGUsIGRldik7CisJfQor
CXJldHVybiByYzsKIH0KIAogI2lmZGVmIENPTkZJR19DSUZTX0FMTE9XX0lOU0VDVVJFX0xFR0FD
WQpkaWZmIC0tZ2l0IGEvZnMvc21iL2NsaWVudC9zbWIycHJvdG8uaCBiL2ZzL3NtYi9jbGllbnQv
c21iMnByb3RvLmgKaW5kZXggMGUzNzFmN2UyODU0Li43MDkzMjRjZmY3MTIgMTAwNjQ0Ci0tLSBh
L2ZzL3NtYi9jbGllbnQvc21iMnByb3RvLmgKKysrIGIvZnMvc21iL2NsaWVudC9zbWIycHJvdG8u
aApAQCAtNTYsNiArNTYsMTIgQEAgZXh0ZXJuIGludCBzbWIzX2hhbmRsZV9yZWFkX2RhdGEoc3Ry
dWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyLAogZXh0ZXJuIGludCBzbWIyX3F1ZXJ5X3JlcGFy
c2VfdGFnKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJ
CQkJc3RydWN0IGNpZnNfc2JfaW5mbyAqY2lmc19zYiwgY29uc3QgY2hhciAqcGF0aCwKIAkJCQlf
X3UzMiAqcmVwYXJzZV90YWcpOworc3RydWN0IGlub2RlICpzbWIyX2dldF9yZXBhcnNlX2lub2Rl
KHN0cnVjdCBjaWZzX29wZW5faW5mb19kYXRhICpkYXRhLAorCQkJCSAgICAgc3RydWN0IHN1cGVy
X2Jsb2NrICpzYiwKKwkJCQkgICAgIGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCisJCQkJICAgICBz
dHJ1Y3QgY2lmc190Y29uICp0Y29uLAorCQkJCSAgICAgY29uc3QgY2hhciAqZnVsbF9wYXRoLAor
CQkJCSAgICAgc3RydWN0IGt2ZWMgKmlvdik7CiBpbnQgc21iMl9xdWVyeV9wYXRoX2luZm8oY29u
c3QgdW5zaWduZWQgaW50IHhpZCwKIAkJCSBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQkJIHN0
cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsCkBAIC0yODksNCArMjk1LDUgQEAgaW50IHNtYjMx
MV9wb3NpeF9xdWVyeV9wYXRoX2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwKIGludCBwb3Np
eF9pbmZvX3BhcnNlKGNvbnN0IHZvaWQgKmJlZywgY29uc3Qgdm9pZCAqZW5kLAogCQkgICAgIHN0
cnVjdCBzbWIyX3Bvc2l4X2luZm9fcGFyc2VkICpvdXQpOwogaW50IHBvc2l4X2luZm9fc2lkX3Np
emUoY29uc3Qgdm9pZCAqYmVnLCBjb25zdCB2b2lkICplbmQpOworCiAjZW5kaWYJCQkvKiBfU01C
MlBST1RPX0ggKi8KZGlmZiAtLWdpdCBhL2ZzL3NtYi9jbGllbnQvdHJhY2UuaCBiL2ZzL3NtYi9j
bGllbnQvdHJhY2UuaAppbmRleCBkZTE5OWVjOWY3MjYuLjM0ZjUwNzU4NDI3NCAxMDA2NDQKLS0t
IGEvZnMvc21iL2NsaWVudC90cmFjZS5oCisrKyBiL2ZzL3NtYi9jbGllbnQvdHJhY2UuaApAQCAt
MzcwLDExICszNzAsMTEgQEAgREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKHJl
bmFtZV9lbnRlcik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRU5URVJfRVZFTlQocm1kaXJf
ZW50ZXIpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKHNldF9lb2ZfZW50
ZXIpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0VOVEVSX0VWRU5UKHNldF9pbmZvX2NvbXBv
dW5kX2VudGVyKTsKK0RFRklORV9TTUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVChzZXRfcmVw
YXJzZV9jb21wb3VuZF9lbnRlcik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRU5URVJfRVZF
TlQoZGVsZXRlX2VudGVyKTsKIERFRklORV9TTUIzX0lORl9DT01QT1VORF9FTlRFUl9FVkVOVCht
a2Rpcl9lbnRlcik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRU5URVJfRVZFTlQodGRpc19l
bnRlcik7CiAKLQogREVDTEFSRV9FVkVOVF9DTEFTUyhzbWIzX2luZl9jb21wb3VuZF9kb25lX2Ns
YXNzLAogCVRQX1BST1RPKHVuc2lnbmVkIGludCB4aWQsCiAJCV9fdTMyCXRpZCwKQEAgLTQwOCw2
ICs0MDgsNyBAQCBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVOVChyZW5hbWVfZG9u
ZSk7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVOVChybWRpcl9kb25lKTsKIERF
RklORV9TTUIzX0lORl9DT01QT1VORF9ET05FX0VWRU5UKHNldF9lb2ZfZG9uZSk7CiBERUZJTkVf
U01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVOVChzZXRfaW5mb19jb21wb3VuZF9kb25lKTsKK0RF
RklORV9TTUIzX0lORl9DT01QT1VORF9ET05FX0VWRU5UKHNldF9yZXBhcnNlX2NvbXBvdW5kX2Rv
bmUpOwogREVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0RPTkVfRVZFTlQoZGVsZXRlX2RvbmUpOwog
REVGSU5FX1NNQjNfSU5GX0NPTVBPVU5EX0RPTkVfRVZFTlQobWtkaXJfZG9uZSk7CiBERUZJTkVf
U01CM19JTkZfQ09NUE9VTkRfRE9ORV9FVkVOVCh0ZGlzX2RvbmUpOwpAQCAtNDUxLDYgKzQ1Miw3
IEBAIERFRklORV9TTUIzX0lORl9DT01QT1VORF9FUlJfRVZFTlQocmVuYW1lX2Vycik7CiBERUZJ
TkVfU01CM19JTkZfQ09NUE9VTkRfRVJSX0VWRU5UKHJtZGlyX2Vycik7CiBERUZJTkVfU01CM19J
TkZfQ09NUE9VTkRfRVJSX0VWRU5UKHNldF9lb2ZfZXJyKTsKIERFRklORV9TTUIzX0lORl9DT01Q
T1VORF9FUlJfRVZFTlQoc2V0X2luZm9fY29tcG91bmRfZXJyKTsKK0RFRklORV9TTUIzX0lORl9D
T01QT1VORF9FUlJfRVZFTlQoc2V0X3JlcGFyc2VfY29tcG91bmRfZXJyKTsKIERFRklORV9TTUIz
X0lORl9DT01QT1VORF9FUlJfRVZFTlQobWtkaXJfZXJyKTsKIERFRklORV9TTUIzX0lORl9DT01Q
T1VORF9FUlJfRVZFTlQoZGVsZXRlX2Vycik7CiBERUZJTkVfU01CM19JTkZfQ09NUE9VTkRfRVJS
X0VWRU5UKHRkaXNfZXJyKTsKLS0gCjIuNDAuMQoK
--00000000000042b2a9060d203dce
Content-Type: text/x-patch; charset="US-ASCII"; 
	name="0001-smb-client-extend-smb2_compound_op-to-accept-more-co.patch"
Content-Disposition: attachment; 
	filename="0001-smb-client-extend-smb2_compound_op-to-accept-more-co.patch"
Content-Transfer-Encoding: base64
Content-ID: <f_lqh63f5m7>
X-Attachment-Id: f_lqh63f5m7

RnJvbSA4YTVjNjUzYzEyOGY0NjU1N2NlYmI2YzIxZThlYzQ5YTMxYjQyZTExIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsbyBBbGNhbnRhcmEgPHBjQG1hbmd1ZWJpdC5jb20+CkRh
dGU6IFNhdCwgMjUgTm92IDIwMjMgMjM6NTU6MDIgLTAzMDAKU3ViamVjdDogW1BBVENIIDEvOF0g
c21iOiBjbGllbnQ6IGV4dGVuZCBzbWIyX2NvbXBvdW5kX29wKCkgdG8gYWNjZXB0IG1vcmUKIGNv
bW1hbmRzCgpNYWtlIHNtYjJfY29tcG91bmRfb3AoKSBhY2NlcHQgdXAgdG8gTUFYX0NPTVBPVU5E
KDUpIGNvbW1hbmRzIHRvIGJlCnNlbnQgb3ZlciBhIHNpbmdsZSBjb21wb3VuZGVkIHJlcXVlc3Qu
CgpUaGlzIHdpbGwgYWxsb3cgbmV4dCBjb21taXRzIHRvIHJlYWQgYW5kIHdyaXRlIHJlcGFyc2Ug
ZmlsZXMgdGhyb3VnaCBhCnNpbmdsZSByb3VuZHRyaXAgdG8gdGhlIHNlcnZlci4KClNpZ25lZC1v
ZmYtYnk6IFBhdWxvIEFsY2FudGFyYSAoU1VTRSkgPHBjQG1hbmd1ZWJpdC5jb20+Ci0tLQogZnMv
c21iL2NsaWVudC9jaWZzZ2xvYi5oICB8ICAgNCArLQogZnMvc21iL2NsaWVudC9zbWIyaW5vZGUu
YyB8IDc4MiArKysrKysrKysrKysrKysrKysrLS0tLS0tLS0tLS0tLS0tLS0tLQogMiBmaWxlcyBj
aGFuZ2VkLCA0MDIgaW5zZXJ0aW9ucygrKSwgMzg0IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBh
L2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaCBiL2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaAppbmRl
eCA1NWIzY2U5NDQwMjIuLjI0ZWVhM2M0ZDcyMyAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9j
aWZzZ2xvYi5oCisrKyBiL2ZzL3NtYi9jbGllbnQvY2lmc2dsb2IuaApAQCAtMjIzOSw4ICsyMjM5
LDggQEAgc3RhdGljIGlubGluZSB2b2lkIGNpZnNfc2dfc2V0X2J1ZihzdHJ1Y3Qgc2dfdGFibGUg
KnNndGFibGUsCiAKIHN0cnVjdCBzbWIyX2NvbXBvdW5kX3ZhcnMgewogCXN0cnVjdCBjaWZzX29w
ZW5fcGFybXMgb3Bhcm1zOwotCXN0cnVjdCBrdmVjIHJzcF9pb3ZbM107Ci0Jc3RydWN0IHNtYl9y
cXN0IHJxc3RbM107CisJc3RydWN0IGt2ZWMgcnNwX2lvdltNQVhfQ09NUE9VTkRdOworCXN0cnVj
dCBzbWJfcnFzdCBycXN0W01BWF9DT01QT1VORF07CiAJc3RydWN0IGt2ZWMgb3Blbl9pb3ZbU01C
Ml9DUkVBVEVfSU9WX1NJWkVdOwogCXN0cnVjdCBrdmVjIHFpX2lvdjsKIAlzdHJ1Y3Qga3ZlYyBp
b19pb3ZbU01CMl9JT0NUTF9JT1ZfU0laRV07CmRpZmYgLS1naXQgYS9mcy9zbWIvY2xpZW50L3Nt
YjJpbm9kZS5jIGIvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYwppbmRleCBjOTQ5NDBhZjVkNGIu
Ljk4ZmE0ZjAyZmJkMyAxMDA2NDQKLS0tIGEvZnMvc21iL2NsaWVudC9zbWIyaW5vZGUuYworKysg
Yi9mcy9zbWIvY2xpZW50L3NtYjJpbm9kZS5jCkBAIC0yNiwxNSArMjYsNiBAQAogI2luY2x1ZGUg
ImNhY2hlZF9kaXIuaCIKICNpbmNsdWRlICJzbWIyc3RhdHVzLmgiCiAKLXN0YXRpYyB2b2lkCi1m
cmVlX3NldF9pbmZfY29tcG91bmQoc3RydWN0IHNtYl9ycXN0ICpycXN0KQotewotCWlmIChycXN0
WzFdLnJxX2lvdikKLQkJU01CMl9zZXRfaW5mb19mcmVlKCZycXN0WzFdKTsKLQlpZiAocnFzdFsy
XS5ycV9pb3YpCi0JCVNNQjJfY2xvc2VfZnJlZSgmcnFzdFsyXSk7Ci19Ci0KIC8qCiAgKiBub3Rl
OiBJZiBjZmlsZSBpcyBwYXNzZWQsIHRoZSByZWZlcmVuY2UgdG8gaXQgaXMgZHJvcHBlZCBoZXJl
LgogICogU28gbWFrZSBzdXJlIHRoYXQgeW91IGRvIG5vdCByZXVzZSBjZmlsZSBhZnRlciByZXR1
cm4gZnJvbSB0aGlzIGZ1bmMuCkBAIC00NSw4ICszNiw5IEBAIGZyZWVfc2V0X2luZl9jb21wb3Vu
ZChzdHJ1Y3Qgc21iX3Jxc3QgKnJxc3QpCiAgKi8KIHN0YXRpYyBpbnQgc21iMl9jb21wb3VuZF9v
cChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLAogCQkJICAg
IHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IsIGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKLQkJ
CSAgICBfX3UzMiBkZXNpcmVkX2FjY2VzcywgX191MzIgY3JlYXRlX2Rpc3Bvc2l0aW9uLCBfX3Uz
MiBjcmVhdGVfb3B0aW9ucywKLQkJCSAgICB1bW9kZV90IG1vZGUsIHZvaWQgKnB0ciwgaW50IGNv
bW1hbmQsIHN0cnVjdCBjaWZzRmlsZUluZm8gKmNmaWxlLAorCQkJICAgIF9fdTMyIGRlc2lyZWRf
YWNjZXNzLCBfX3UzMiBjcmVhdGVfZGlzcG9zaXRpb24sCisJCQkgICAgX191MzIgY3JlYXRlX29w
dGlvbnMsIHVtb2RlX3QgbW9kZSwgc3RydWN0IGt2ZWMgKmluX2lvdiwKKwkJCSAgICBpbnQgKmNt
ZHMsIGludCBudW1fY21kcywgc3RydWN0IGNpZnNGaWxlSW5mbyAqY2ZpbGUsCiAJCQkgICAgX191
OCAqKmV4dGJ1Ziwgc2l6ZV90ICpleHRidWZsZW4sCiAJCQkgICAgc3RydWN0IGt2ZWMgKm91dF9p
b3YsIGludCAqb3V0X2J1ZnR5cGUpCiB7CkBAIC01OSw4ICs1MSw4IEBAIHN0YXRpYyBpbnQgc21i
Ml9jb21wb3VuZF9vcChjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0
Y29uLAogCXN0cnVjdCBjaWZzX2ZpZCBmaWQ7CiAJc3RydWN0IGNpZnNfc2VzICpzZXMgPSB0Y29u
LT5zZXM7CiAJc3RydWN0IFRDUF9TZXJ2ZXJfSW5mbyAqc2VydmVyOwotCWludCBudW1fcnFzdCA9
IDA7Ci0JaW50IHJlc3BfYnVmdHlwZVszXTsKKwlpbnQgbnVtX3Jxc3QgPSAwLCBpOworCWludCBy
ZXNwX2J1ZnR5cGVbTUFYX0NPTVBPVU5EXTsKIAlzdHJ1Y3Qgc21iMl9xdWVyeV9pbmZvX3JzcCAq
cWlfcnNwID0gTlVMTDsKIAlzdHJ1Y3QgY2lmc19vcGVuX2luZm9fZGF0YSAqaWRhdGE7CiAJaW50
IGZsYWdzID0gMDsKQEAgLTgwLDcgKzcyLDggQEAgc3RhdGljIGludCBzbWIyX2NvbXBvdW5kX29w
KGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJaWYgKHNt
YjNfZW5jcnlwdGlvbl9yZXF1aXJlZCh0Y29uKSkKIAkJZmxhZ3MgfD0gQ0lGU19UUkFOU0ZPUk1f
UkVROwogCi0JcmVzcF9idWZ0eXBlWzBdID0gcmVzcF9idWZ0eXBlWzFdID0gcmVzcF9idWZ0eXBl
WzJdID0gQ0lGU19OT19CVUZGRVI7CisJZm9yIChpID0gMDsgaSA8IEFSUkFZX1NJWkUocmVzcF9i
dWZ0eXBlKTsgaSsrKQorCQlyZXNwX2J1ZnR5cGVbaV0gPSBDSUZTX05PX0JVRkZFUjsKIAogCS8q
IFdlIGFscmVhZHkgaGF2ZSBhIGhhbmRsZSBzbyB3ZSBjYW4gc2tpcCB0aGUgb3BlbiAqLwogCWlm
IChjZmlsZSkKQEAgLTExOCwyNDIgKzExMSwyNDYgQEAgc3RhdGljIGludCBzbWIyX2NvbXBvdW5k
X29wKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsIHN0cnVjdCBjaWZzX3Rjb24gKnRjb24sCiAJbnVt
X3Jxc3QrKzsKIAlyYyA9IDA7CiAKLQkvKiBPcGVyYXRpb24gKi8KLQlzd2l0Y2ggKGNvbW1hbmQp
IHsKLQljYXNlIFNNQjJfT1BfUVVFUllfSU5GTzoKLQkJcnFzdFtudW1fcnFzdF0ucnFfaW92ID0g
JnZhcnMtPnFpX2lvdjsKLQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDE7Ci0KLQkJaWYgKGNm
aWxlKQotCQkJcmMgPSBTTUIyX3F1ZXJ5X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJJnJx
c3RbbnVtX3Jxc3RdLAotCQkJCWNmaWxlLT5maWQucGVyc2lzdGVudF9maWQsCi0JCQkJY2ZpbGUt
PmZpZC52b2xhdGlsZV9maWQsCi0JCQkJRklMRV9BTExfSU5GT1JNQVRJT04sCi0JCQkJU01CMl9P
X0lORk9fRklMRSwgMCwKLQkJCQlzaXplb2Yoc3RydWN0IHNtYjJfZmlsZV9hbGxfaW5mbykgKwot
CQkJCQkgIFBBVEhfTUFYICogMiwgMCwgTlVMTCk7Ci0JCWVsc2UgewotCQkJcmMgPSBTTUIyX3F1
ZXJ5X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJJnJxc3RbbnVtX3Jxc3RdLAotCQkJCUNP
TVBPVU5EX0ZJRCwKLQkJCQlDT01QT1VORF9GSUQsCi0JCQkJRklMRV9BTExfSU5GT1JNQVRJT04s
Ci0JCQkJU01CMl9PX0lORk9fRklMRSwgMCwKLQkJCQlzaXplb2Yoc3RydWN0IHNtYjJfZmlsZV9h
bGxfaW5mbykgKwotCQkJCQkgIFBBVEhfTUFYICogMiwgMCwgTlVMTCk7Ci0JCQlpZiAoIXJjKSB7
Ci0JCQkJc21iMl9zZXRfbmV4dF9jb21tYW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7Ci0JCQkJ
c21iMl9zZXRfcmVsYXRlZCgmcnFzdFtudW1fcnFzdF0pOworCWZvciAoaSA9IDA7IGkgPCBudW1f
Y21kczsgaSsrKSB7CisJCS8qIE9wZXJhdGlvbiAqLworCQlzd2l0Y2ggKGNtZHNbaV0pIHsKKwkJ
Y2FzZSBTTUIyX09QX1FVRVJZX0lORk86CisJCQlycXN0W251bV9ycXN0XS5ycV9pb3YgPSAmdmFy
cy0+cWlfaW92OworCQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDE7CisKKwkJCWlmIChjZmls
ZSkgeworCQkJCXJjID0gU01CMl9xdWVyeV9pbmZvX2luaXQodGNvbiwgc2VydmVyLAorCQkJCQkJ
CSAgJnJxc3RbbnVtX3Jxc3RdLAorCQkJCQkJCSAgY2ZpbGUtPmZpZC5wZXJzaXN0ZW50X2ZpZCwK
KwkJCQkJCQkgIGNmaWxlLT5maWQudm9sYXRpbGVfZmlkLAorCQkJCQkJCSAgRklMRV9BTExfSU5G
T1JNQVRJT04sCisJCQkJCQkJICBTTUIyX09fSU5GT19GSUxFLCAwLAorCQkJCQkJCSAgc2l6ZW9m
KHN0cnVjdCBzbWIyX2ZpbGVfYWxsX2luZm8pICsKKwkJCQkJCQkgIFBBVEhfTUFYICogMiwgMCwg
TlVMTCk7CisJCQl9IGVsc2UgeworCQkJCXJjID0gU01CMl9xdWVyeV9pbmZvX2luaXQodGNvbiwg
c2VydmVyLAorCQkJCQkJCSAgJnJxc3RbbnVtX3Jxc3RdLAorCQkJCQkJCSAgQ09NUE9VTkRfRklE
LAorCQkJCQkJCSAgQ09NUE9VTkRfRklELAorCQkJCQkJCSAgRklMRV9BTExfSU5GT1JNQVRJT04s
CisJCQkJCQkJICBTTUIyX09fSU5GT19GSUxFLCAwLAorCQkJCQkJCSAgc2l6ZW9mKHN0cnVjdCBz
bWIyX2ZpbGVfYWxsX2luZm8pICsKKwkJCQkJCQkgIFBBVEhfTUFYICogMiwgMCwgTlVMTCk7CisJ
CQkJaWYgKCFyYykgeworCQkJCQlzbWIyX3NldF9uZXh0X2NvbW1hbmQodGNvbiwgJnJxc3RbbnVt
X3Jxc3RdKTsKKwkJCQkJc21iMl9zZXRfcmVsYXRlZCgmcnFzdFtudW1fcnFzdF0pOworCQkJCX0K
IAkJCX0KLQkJfQogCi0JCWlmIChyYykKLQkJCWdvdG8gZmluaXNoZWQ7Ci0JCW51bV9ycXN0Kys7
Ci0JCXRyYWNlX3NtYjNfcXVlcnlfaW5mb19jb21wb3VuZF9lbnRlcih4aWQsIHNlcy0+U3VpZCwg
dGNvbi0+dGlkLAotCQkJCQkJICAgICBmdWxsX3BhdGgpOwotCQlicmVhazsKLQljYXNlIFNNQjJf
T1BfUE9TSVhfUVVFUllfSU5GTzoKLQkJcnFzdFtudW1fcnFzdF0ucnFfaW92ID0gJnZhcnMtPnFp
X2lvdjsKLQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDE7Ci0KLQkJaWYgKGNmaWxlKQotCQkJ
cmMgPSBTTUIyX3F1ZXJ5X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJJnJxc3RbbnVtX3Jx
c3RdLAotCQkJCWNmaWxlLT5maWQucGVyc2lzdGVudF9maWQsCi0JCQkJY2ZpbGUtPmZpZC52b2xh
dGlsZV9maWQsCi0JCQkJU01CX0ZJTkRfRklMRV9QT1NJWF9JTkZPLAotCQkJCVNNQjJfT19JTkZP
X0ZJTEUsIDAsCisJCQlpZiAocmMpCisJCQkJZ290byBmaW5pc2hlZDsKKwkJCW51bV9ycXN0Kys7
CisJCQl0cmFjZV9zbWIzX3F1ZXJ5X2luZm9fY29tcG91bmRfZW50ZXIoeGlkLCBzZXMtPlN1aWQs
CisJCQkJCQkJICAgICB0Y29uLT50aWQsIGZ1bGxfcGF0aCk7CisJCQlicmVhazsKKwkJY2FzZSBT
TUIyX09QX1BPU0lYX1FVRVJZX0lORk86CisJCQlycXN0W251bV9ycXN0XS5ycV9pb3YgPSAmdmFy
cy0+cWlfaW92OworCQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDE7CisKKwkJCWlmIChjZmls
ZSkgewogCQkJCS8qIFRCRDogZml4IGZvbGxvd2luZyB0byBhbGxvdyBmb3IgbG9uZ2VyIFNJRHMg
Ki8KLQkJCQlzaXplb2Yoc3RydWN0IHNtYjMxMV9wb3NpeF9xaW5mbyAqKSArIChQQVRIX01BWCAq
IDIpICsKLQkJCQkoc2l6ZW9mKHN0cnVjdCBjaWZzX3NpZCkgKiAyKSwgMCwgTlVMTCk7Ci0JCWVs
c2UgewotCQkJcmMgPSBTTUIyX3F1ZXJ5X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJJnJx
c3RbbnVtX3Jxc3RdLAotCQkJCUNPTVBPVU5EX0ZJRCwKLQkJCQlDT01QT1VORF9GSUQsCi0JCQkJ
U01CX0ZJTkRfRklMRV9QT1NJWF9JTkZPLAotCQkJCVNNQjJfT19JTkZPX0ZJTEUsIDAsCi0JCQkJ
c2l6ZW9mKHN0cnVjdCBzbWIzMTFfcG9zaXhfcWluZm8gKikgKyAoUEFUSF9NQVggKiAyKSArCi0J
CQkJKHNpemVvZihzdHJ1Y3QgY2lmc19zaWQpICogMiksIDAsIE5VTEwpOwotCQkJaWYgKCFyYykg
ewotCQkJCXNtYjJfc2V0X25leHRfY29tbWFuZCh0Y29uLCAmcnFzdFtudW1fcnFzdF0pOwotCQkJ
CXNtYjJfc2V0X3JlbGF0ZWQoJnJxc3RbbnVtX3Jxc3RdKTsKKwkJCQlyYyA9IFNNQjJfcXVlcnlf
aW5mb19pbml0KHRjb24sIHNlcnZlciwKKwkJCQkJCQkgICZycXN0W251bV9ycXN0XSwKKwkJCQkJ
CQkgIGNmaWxlLT5maWQucGVyc2lzdGVudF9maWQsCisJCQkJCQkJICBjZmlsZS0+ZmlkLnZvbGF0
aWxlX2ZpZCwKKwkJCQkJCQkgIFNNQl9GSU5EX0ZJTEVfUE9TSVhfSU5GTywKKwkJCQkJCQkgIFNN
QjJfT19JTkZPX0ZJTEUsIDAsCisJCQkJCQkJICBzaXplb2Yoc3RydWN0IHNtYjMxMV9wb3NpeF9x
aW5mbyAqKSArCisJCQkJCQkJICAoUEFUSF9NQVggKiAyKSArCisJCQkJCQkJICAoc2l6ZW9mKHN0
cnVjdCBjaWZzX3NpZCkgKiAyKSwgMCwgTlVMTCk7CisJCQl9IGVsc2UgeworCQkJCXJjID0gU01C
Ml9xdWVyeV9pbmZvX2luaXQodGNvbiwgc2VydmVyLAorCQkJCQkJCSAgJnJxc3RbbnVtX3Jxc3Rd
LAorCQkJCQkJCSAgQ09NUE9VTkRfRklELAorCQkJCQkJCSAgQ09NUE9VTkRfRklELAorCQkJCQkJ
CSAgU01CX0ZJTkRfRklMRV9QT1NJWF9JTkZPLAorCQkJCQkJCSAgU01CMl9PX0lORk9fRklMRSwg
MCwKKwkJCQkJCQkgIHNpemVvZihzdHJ1Y3Qgc21iMzExX3Bvc2l4X3FpbmZvICopICsKKwkJCQkJ
CQkgIChQQVRIX01BWCAqIDIpICsKKwkJCQkJCQkgIChzaXplb2Yoc3RydWN0IGNpZnNfc2lkKSAq
IDIpLCAwLCBOVUxMKTsKKwkJCQlpZiAoIXJjKSB7CisJCQkJCXNtYjJfc2V0X25leHRfY29tbWFu
ZCh0Y29uLCAmcnFzdFtudW1fcnFzdF0pOworCQkJCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251
bV9ycXN0XSk7CisJCQkJfQogCQkJfQotCQl9CiAKLQkJaWYgKHJjKQotCQkJZ290byBmaW5pc2hl
ZDsKLQkJbnVtX3Jxc3QrKzsKLQkJdHJhY2Vfc21iM19wb3NpeF9xdWVyeV9pbmZvX2NvbXBvdW5k
X2VudGVyKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQsIGZ1bGxfcGF0aCk7Ci0JCWJyZWFrOwot
CWNhc2UgU01CMl9PUF9ERUxFVEU6Ci0JCXRyYWNlX3NtYjNfZGVsZXRlX2VudGVyKHhpZCwgc2Vz
LT5TdWlkLCB0Y29uLT50aWQsIGZ1bGxfcGF0aCk7Ci0JCWJyZWFrOwotCWNhc2UgU01CMl9PUF9N
S0RJUjoKLQkJLyoKLQkJICogRGlyZWN0b3JpZXMgYXJlIGNyZWF0ZWQgdGhyb3VnaCBwYXJhbWV0
ZXJzIGluIHRoZQotCQkgKiBTTUIyX29wZW4oKSBjYWxsLgotCQkgKi8KLQkJdHJhY2Vfc21iM19t
a2Rpcl9lbnRlcih4aWQsIHNlcy0+U3VpZCwgdGNvbi0+dGlkLCBmdWxsX3BhdGgpOwotCQlicmVh
azsKLQljYXNlIFNNQjJfT1BfUk1ESVI6Ci0JCXJxc3RbbnVtX3Jxc3RdLnJxX2lvdiA9ICZ2YXJz
LT5zaV9pb3ZbMF07Ci0JCXJxc3RbbnVtX3Jxc3RdLnJxX252ZWMgPSAxOwotCi0JCXNpemVbMF0g
PSAxOyAvKiBzaXplb2YgX191OCBTZWUgTVMtRlNDQyBzZWN0aW9uIDIuNC4xMSAqLwotCQlkYXRh
WzBdID0gJmRlbGV0ZV9wZW5kaW5nWzBdOwotCi0JCXJjID0gU01CMl9zZXRfaW5mb19pbml0KHRj
b24sIHNlcnZlciwKLQkJCQkJJnJxc3RbbnVtX3Jxc3RdLCBDT01QT1VORF9GSUQsCi0JCQkJCUNP
TVBPVU5EX0ZJRCwgY3VycmVudC0+dGdpZCwKLQkJCQkJRklMRV9ESVNQT1NJVElPTl9JTkZPUk1B
VElPTiwKLQkJCQkJU01CMl9PX0lORk9fRklMRSwgMCwgZGF0YSwgc2l6ZSk7Ci0JCWlmIChyYykK
LQkJCWdvdG8gZmluaXNoZWQ7Ci0JCXNtYjJfc2V0X25leHRfY29tbWFuZCh0Y29uLCAmcnFzdFtu
dW1fcnFzdF0pOwotCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251bV9ycXN0KytdKTsKLQkJdHJh
Y2Vfc21iM19ybWRpcl9lbnRlcih4aWQsIHNlcy0+U3VpZCwgdGNvbi0+dGlkLCBmdWxsX3BhdGgp
OwotCQlicmVhazsKLQljYXNlIFNNQjJfT1BfU0VUX0VPRjoKLQkJcnFzdFtudW1fcnFzdF0ucnFf
aW92ID0gJnZhcnMtPnNpX2lvdlswXTsKLQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDE7CisJ
CQlpZiAocmMpCisJCQkJZ290byBmaW5pc2hlZDsKKwkJCW51bV9ycXN0Kys7CisJCQl0cmFjZV9z
bWIzX3Bvc2l4X3F1ZXJ5X2luZm9fY29tcG91bmRfZW50ZXIoeGlkLCBzZXMtPlN1aWQsCisJCQkJ
CQkJCSAgIHRjb24tPnRpZCwgZnVsbF9wYXRoKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1Bf
REVMRVRFOgorCQkJdHJhY2Vfc21iM19kZWxldGVfZW50ZXIoeGlkLCBzZXMtPlN1aWQsIHRjb24t
PnRpZCwgZnVsbF9wYXRoKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1BfTUtESVI6CisJCQkv
KgorCQkJICogRGlyZWN0b3JpZXMgYXJlIGNyZWF0ZWQgdGhyb3VnaCBwYXJhbWV0ZXJzIGluIHRo
ZQorCQkJICogU01CMl9vcGVuKCkgY2FsbC4KKwkJCSAqLworCQkJdHJhY2Vfc21iM19ta2Rpcl9l
bnRlcih4aWQsIHNlcy0+U3VpZCwgdGNvbi0+dGlkLCBmdWxsX3BhdGgpOworCQkJYnJlYWs7CisJ
CWNhc2UgU01CMl9PUF9STURJUjoKKwkJCXJxc3RbbnVtX3Jxc3RdLnJxX2lvdiA9ICZ2YXJzLT5z
aV9pb3ZbMF07CisJCQlycXN0W251bV9ycXN0XS5ycV9udmVjID0gMTsKIAotCQlzaXplWzBdID0g
ODsgLyogc2l6ZW9mIF9fbGU2NCAqLwotCQlkYXRhWzBdID0gcHRyOworCQkJc2l6ZVswXSA9IDE7
IC8qIHNpemVvZiBfX3U4IFNlZSBNUy1GU0NDIHNlY3Rpb24gMi40LjExICovCisJCQlkYXRhWzBd
ID0gJmRlbGV0ZV9wZW5kaW5nWzBdOwogCi0JCWlmIChjZmlsZSkgewotCQkJcmMgPSBTTUIyX3Nl
dF9pbmZvX2luaXQodGNvbiwgc2VydmVyLAotCQkJCQkJJnJxc3RbbnVtX3Jxc3RdLAotCQkJCQkJ
Y2ZpbGUtPmZpZC5wZXJzaXN0ZW50X2ZpZCwKLQkJCQkJCWNmaWxlLT5maWQudm9sYXRpbGVfZmlk
LAotCQkJCQkJY3VycmVudC0+dGdpZCwKLQkJCQkJCUZJTEVfRU5EX09GX0ZJTEVfSU5GT1JNQVRJ
T04sCi0JCQkJCQlTTUIyX09fSU5GT19GSUxFLCAwLAotCQkJCQkJZGF0YSwgc2l6ZSk7Ci0JCX0g
ZWxzZSB7CiAJCQlyYyA9IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJCQkm
cnFzdFtudW1fcnFzdF0sCi0JCQkJCQlDT01QT1VORF9GSUQsCi0JCQkJCQlDT01QT1VORF9GSUQs
Ci0JCQkJCQljdXJyZW50LT50Z2lkLAotCQkJCQkJRklMRV9FTkRfT0ZfRklMRV9JTkZPUk1BVElP
TiwKLQkJCQkJCVNNQjJfT19JTkZPX0ZJTEUsIDAsCi0JCQkJCQlkYXRhLCBzaXplKTsKLQkJCWlm
ICghcmMpIHsKLQkJCQlzbWIyX3NldF9uZXh0X2NvbW1hbmQodGNvbiwgJnJxc3RbbnVtX3Jxc3Rd
KTsKLQkJCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251bV9ycXN0XSk7CisJCQkJCQkmcnFzdFtu
dW1fcnFzdF0sIENPTVBPVU5EX0ZJRCwKKwkJCQkJCUNPTVBPVU5EX0ZJRCwgY3VycmVudC0+dGdp
ZCwKKwkJCQkJCUZJTEVfRElTUE9TSVRJT05fSU5GT1JNQVRJT04sCisJCQkJCQlTTUIyX09fSU5G
T19GSUxFLCAwLCBkYXRhLCBzaXplKTsKKwkJCWlmIChyYykKKwkJCQlnb3RvIGZpbmlzaGVkOwor
CQkJc21iMl9zZXRfbmV4dF9jb21tYW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7CisJCQlzbWIy
X3NldF9yZWxhdGVkKCZycXN0W251bV9ycXN0KytdKTsKKwkJCXRyYWNlX3NtYjNfcm1kaXJfZW50
ZXIoeGlkLCBzZXMtPlN1aWQsIHRjb24tPnRpZCwgZnVsbF9wYXRoKTsKKwkJCWJyZWFrOworCQlj
YXNlIFNNQjJfT1BfU0VUX0VPRjoKKwkJCXJxc3RbbnVtX3Jxc3RdLnJxX2lvdiA9ICZ2YXJzLT5z
aV9pb3ZbMF07CisJCQlycXN0W251bV9ycXN0XS5ycV9udmVjID0gMTsKKworCQkJc2l6ZVswXSA9
IGluX2lvdltpXS5pb3ZfbGVuOworCQkJZGF0YVswXSA9IGluX2lvdltpXS5pb3ZfYmFzZTsKKwor
CQkJaWYgKGNmaWxlKSB7CisJCQkJcmMgPSBTTUIyX3NldF9pbmZvX2luaXQodGNvbiwgc2VydmVy
LAorCQkJCQkJCSZycXN0W251bV9ycXN0XSwKKwkJCQkJCQljZmlsZS0+ZmlkLnBlcnNpc3RlbnRf
ZmlkLAorCQkJCQkJCWNmaWxlLT5maWQudm9sYXRpbGVfZmlkLAorCQkJCQkJCWN1cnJlbnQtPnRn
aWQsCisJCQkJCQkJRklMRV9FTkRfT0ZfRklMRV9JTkZPUk1BVElPTiwKKwkJCQkJCQlTTUIyX09f
SU5GT19GSUxFLCAwLAorCQkJCQkJCWRhdGEsIHNpemUpOworCQkJfSBlbHNlIHsKKwkJCQlyYyA9
IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCisJCQkJCQkJJnJxc3RbbnVtX3Jxc3Rd
LAorCQkJCQkJCUNPTVBPVU5EX0ZJRCwKKwkJCQkJCQlDT01QT1VORF9GSUQsCisJCQkJCQkJY3Vy
cmVudC0+dGdpZCwKKwkJCQkJCQlGSUxFX0VORF9PRl9GSUxFX0lORk9STUFUSU9OLAorCQkJCQkJ
CVNNQjJfT19JTkZPX0ZJTEUsIDAsCisJCQkJCQkJZGF0YSwgc2l6ZSk7CisJCQkJaWYgKCFyYykg
eworCQkJCQlzbWIyX3NldF9uZXh0X2NvbW1hbmQodGNvbiwgJnJxc3RbbnVtX3Jxc3RdKTsKKwkJ
CQkJc21iMl9zZXRfcmVsYXRlZCgmcnFzdFtudW1fcnFzdF0pOworCQkJCX0KIAkJCX0KLQkJfQot
CQlpZiAocmMpCi0JCQlnb3RvIGZpbmlzaGVkOwotCQludW1fcnFzdCsrOwotCQl0cmFjZV9zbWIz
X3NldF9lb2ZfZW50ZXIoeGlkLCBzZXMtPlN1aWQsIHRjb24tPnRpZCwgZnVsbF9wYXRoKTsKLQkJ
YnJlYWs7Ci0JY2FzZSBTTUIyX09QX1NFVF9JTkZPOgotCQlycXN0W251bV9ycXN0XS5ycV9pb3Yg
PSAmdmFycy0+c2lfaW92WzBdOwotCQlycXN0W251bV9ycXN0XS5ycV9udmVjID0gMTsKLQotCi0J
CXNpemVbMF0gPSBzaXplb2YoRklMRV9CQVNJQ19JTkZPKTsKLQkJZGF0YVswXSA9IHB0cjsKLQot
CQlpZiAoY2ZpbGUpCi0JCQlyYyA9IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0J
CQkJJnJxc3RbbnVtX3Jxc3RdLAotCQkJCWNmaWxlLT5maWQucGVyc2lzdGVudF9maWQsCi0JCQkJ
Y2ZpbGUtPmZpZC52b2xhdGlsZV9maWQsIGN1cnJlbnQtPnRnaWQsCi0JCQkJRklMRV9CQVNJQ19J
TkZPUk1BVElPTiwKLQkJCQlTTUIyX09fSU5GT19GSUxFLCAwLCBkYXRhLCBzaXplKTsKLQkJZWxz
ZSB7Ci0JCQlyYyA9IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCi0JCQkJJnJxc3Rb
bnVtX3Jxc3RdLAotCQkJCUNPTVBPVU5EX0ZJRCwKLQkJCQlDT01QT1VORF9GSUQsIGN1cnJlbnQt
PnRnaWQsCi0JCQkJRklMRV9CQVNJQ19JTkZPUk1BVElPTiwKLQkJCQlTTUIyX09fSU5GT19GSUxF
LCAwLCBkYXRhLCBzaXplKTsKLQkJCWlmICghcmMpIHsKLQkJCQlzbWIyX3NldF9uZXh0X2NvbW1h
bmQodGNvbiwgJnJxc3RbbnVtX3Jxc3RdKTsKLQkJCQlzbWIyX3NldF9yZWxhdGVkKCZycXN0W251
bV9ycXN0XSk7CisJCQlpZiAocmMpCisJCQkJZ290byBmaW5pc2hlZDsKKwkJCW51bV9ycXN0Kys7
CisJCQl0cmFjZV9zbWIzX3NldF9lb2ZfZW50ZXIoeGlkLCBzZXMtPlN1aWQsIHRjb24tPnRpZCwg
ZnVsbF9wYXRoKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1BfU0VUX0lORk86CisJCQlycXN0
W251bV9ycXN0XS5ycV9pb3YgPSAmdmFycy0+c2lfaW92WzBdOworCQkJcnFzdFtudW1fcnFzdF0u
cnFfbnZlYyA9IDE7CisKKwkJCXNpemVbMF0gPSBpbl9pb3ZbaV0uaW92X2xlbjsKKwkJCWRhdGFb
MF0gPSBpbl9pb3ZbaV0uaW92X2Jhc2U7CisKKwkJCWlmIChjZmlsZSkgeworCQkJCXJjID0gU01C
Ml9zZXRfaW5mb19pbml0KHRjb24sIHNlcnZlciwKKwkJCQkJCQkmcnFzdFtudW1fcnFzdF0sCisJ
CQkJCQkJY2ZpbGUtPmZpZC5wZXJzaXN0ZW50X2ZpZCwKKwkJCQkJCQljZmlsZS0+ZmlkLnZvbGF0
aWxlX2ZpZCwgY3VycmVudC0+dGdpZCwKKwkJCQkJCQlGSUxFX0JBU0lDX0lORk9STUFUSU9OLAor
CQkJCQkJCVNNQjJfT19JTkZPX0ZJTEUsIDAsIGRhdGEsIHNpemUpOworCQkJfSBlbHNlIHsKKwkJ
CQlyYyA9IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCisJCQkJCQkJJnJxc3RbbnVt
X3Jxc3RdLAorCQkJCQkJCUNPTVBPVU5EX0ZJRCwKKwkJCQkJCQlDT01QT1VORF9GSUQsIGN1cnJl
bnQtPnRnaWQsCisJCQkJCQkJRklMRV9CQVNJQ19JTkZPUk1BVElPTiwKKwkJCQkJCQlTTUIyX09f
SU5GT19GSUxFLCAwLCBkYXRhLCBzaXplKTsKKwkJCQlpZiAoIXJjKSB7CisJCQkJCXNtYjJfc2V0
X25leHRfY29tbWFuZCh0Y29uLCAmcnFzdFtudW1fcnFzdF0pOworCQkJCQlzbWIyX3NldF9yZWxh
dGVkKCZycXN0W251bV9ycXN0XSk7CisJCQkJfQogCQkJfQotCQl9CiAKLQkJaWYgKHJjKQotCQkJ
Z290byBmaW5pc2hlZDsKLQkJbnVtX3Jxc3QrKzsKLQkJdHJhY2Vfc21iM19zZXRfaW5mb19jb21w
b3VuZF9lbnRlcih4aWQsIHNlcy0+U3VpZCwgdGNvbi0+dGlkLAotCQkJCQkJICAgZnVsbF9wYXRo
KTsKLQkJYnJlYWs7Ci0JY2FzZSBTTUIyX09QX1JFTkFNRToKLQkJcnFzdFtudW1fcnFzdF0ucnFf
aW92ID0gJnZhcnMtPnNpX2lvdlswXTsKLQkJcnFzdFtudW1fcnFzdF0ucnFfbnZlYyA9IDI7CisJ
CQlpZiAocmMpCisJCQkJZ290byBmaW5pc2hlZDsKKwkJCW51bV9ycXN0Kys7CisJCQl0cmFjZV9z
bWIzX3NldF9pbmZvX2NvbXBvdW5kX2VudGVyKHhpZCwgc2VzLT5TdWlkLAorCQkJCQkJCSAgIHRj
b24tPnRpZCwgZnVsbF9wYXRoKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1BfUkVOQU1FOgor
CQkJcnFzdFtudW1fcnFzdF0ucnFfaW92ID0gJnZhcnMtPnNpX2lvdlswXTsKKwkJCXJxc3RbbnVt
X3Jxc3RdLnJxX252ZWMgPSAyOwogCi0JCWxlbiA9ICgyICogVW5pU3Rybmxlbigod2NoYXJfdCAq
KXB0ciwgUEFUSF9NQVgpKTsKKwkJCWxlbiA9IGluX2lvdltpXS5pb3ZfbGVuOwogCi0JCXZhcnMt
PnJlbmFtZV9pbmZvLlJlcGxhY2VJZkV4aXN0cyA9IDE7Ci0JCXZhcnMtPnJlbmFtZV9pbmZvLlJv
b3REaXJlY3RvcnkgPSAwOwotCQl2YXJzLT5yZW5hbWVfaW5mby5GaWxlTmFtZUxlbmd0aCA9IGNw
dV90b19sZTMyKGxlbik7CisJCQl2YXJzLT5yZW5hbWVfaW5mby5SZXBsYWNlSWZFeGlzdHMgPSAx
OworCQkJdmFycy0+cmVuYW1lX2luZm8uUm9vdERpcmVjdG9yeSA9IDA7CisJCQl2YXJzLT5yZW5h
bWVfaW5mby5GaWxlTmFtZUxlbmd0aCA9IGNwdV90b19sZTMyKGxlbik7CiAKLQkJc2l6ZVswXSA9
IHNpemVvZihzdHJ1Y3Qgc21iMl9maWxlX3JlbmFtZV9pbmZvKTsKLQkJZGF0YVswXSA9ICZ2YXJz
LT5yZW5hbWVfaW5mbzsKKwkJCXNpemVbMF0gPSBzaXplb2Yoc3RydWN0IHNtYjJfZmlsZV9yZW5h
bWVfaW5mbyk7CisJCQlkYXRhWzBdID0gJnZhcnMtPnJlbmFtZV9pbmZvOwogCi0JCXNpemVbMV0g
PSBsZW4gKyAyIC8qIG51bGwgKi87Ci0JCWRhdGFbMV0gPSAoX19sZTE2ICopcHRyOworCQkJc2l6
ZVsxXSA9IGxlbiArIDIgLyogbnVsbCAqLzsKKwkJCWRhdGFbMV0gPSBpbl9pb3ZbaV0uaW92X2Jh
c2U7CiAKLQkJaWYgKGNmaWxlKQotCQkJcmMgPSBTTUIyX3NldF9pbmZvX2luaXQodGNvbiwgc2Vy
dmVyLAotCQkJCQkJJnJxc3RbbnVtX3Jxc3RdLAotCQkJCQkJY2ZpbGUtPmZpZC5wZXJzaXN0ZW50
X2ZpZCwKLQkJCQkJCWNmaWxlLT5maWQudm9sYXRpbGVfZmlkLAotCQkJCQljdXJyZW50LT50Z2lk
LCBGSUxFX1JFTkFNRV9JTkZPUk1BVElPTiwKLQkJCQkJU01CMl9PX0lORk9fRklMRSwgMCwgZGF0
YSwgc2l6ZSk7Ci0JCWVsc2UgewotCQkJcmMgPSBTTUIyX3NldF9pbmZvX2luaXQodGNvbiwgc2Vy
dmVyLAotCQkJCQkmcnFzdFtudW1fcnFzdF0sCi0JCQkJCUNPTVBPVU5EX0ZJRCwgQ09NUE9VTkRf
RklELAotCQkJCQljdXJyZW50LT50Z2lkLCBGSUxFX1JFTkFNRV9JTkZPUk1BVElPTiwKLQkJCQkJ
U01CMl9PX0lORk9fRklMRSwgMCwgZGF0YSwgc2l6ZSk7Ci0JCQlpZiAoIXJjKSB7Ci0JCQkJc21i
Ml9zZXRfbmV4dF9jb21tYW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7Ci0JCQkJc21iMl9zZXRf
cmVsYXRlZCgmcnFzdFtudW1fcnFzdF0pOworCQkJaWYgKGNmaWxlKSB7CisJCQkJcmMgPSBTTUIy
X3NldF9pbmZvX2luaXQodGNvbiwgc2VydmVyLAorCQkJCQkJCSZycXN0W251bV9ycXN0XSwKKwkJ
CQkJCQljZmlsZS0+ZmlkLnBlcnNpc3RlbnRfZmlkLAorCQkJCQkJCWNmaWxlLT5maWQudm9sYXRp
bGVfZmlkLAorCQkJCQkJCWN1cnJlbnQtPnRnaWQsIEZJTEVfUkVOQU1FX0lORk9STUFUSU9OLAor
CQkJCQkJCVNNQjJfT19JTkZPX0ZJTEUsIDAsIGRhdGEsIHNpemUpOworCQkJfSBlbHNlIHsKKwkJ
CQlyYyA9IFNNQjJfc2V0X2luZm9faW5pdCh0Y29uLCBzZXJ2ZXIsCisJCQkJCQkJJnJxc3RbbnVt
X3Jxc3RdLAorCQkJCQkJCUNPTVBPVU5EX0ZJRCwgQ09NUE9VTkRfRklELAorCQkJCQkJCWN1cnJl
bnQtPnRnaWQsIEZJTEVfUkVOQU1FX0lORk9STUFUSU9OLAorCQkJCQkJCVNNQjJfT19JTkZPX0ZJ
TEUsIDAsIGRhdGEsIHNpemUpOworCQkJCWlmICghcmMpIHsKKwkJCQkJc21iMl9zZXRfbmV4dF9j
b21tYW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7CisJCQkJCXNtYjJfc2V0X3JlbGF0ZWQoJnJx
c3RbbnVtX3Jxc3RdKTsKKwkJCQl9CiAJCQl9Ci0JCX0KLQkJaWYgKHJjKQotCQkJZ290byBmaW5p
c2hlZDsKLQkJbnVtX3Jxc3QrKzsKLQkJdHJhY2Vfc21iM19yZW5hbWVfZW50ZXIoeGlkLCBzZXMt
PlN1aWQsIHRjb24tPnRpZCwgZnVsbF9wYXRoKTsKLQkJYnJlYWs7Ci0JY2FzZSBTTUIyX09QX0hB
UkRMSU5LOgotCQlycXN0W251bV9ycXN0XS5ycV9pb3YgPSAmdmFycy0+c2lfaW92WzBdOwotCQly
cXN0W251bV9ycXN0XS5ycV9udmVjID0gMjsKKwkJCWlmIChyYykKKwkJCQlnb3RvIGZpbmlzaGVk
OworCQkJbnVtX3Jxc3QrKzsKKwkJCXRyYWNlX3NtYjNfcmVuYW1lX2VudGVyKHhpZCwgc2VzLT5T
dWlkLCB0Y29uLT50aWQsIGZ1bGxfcGF0aCk7CisJCQlicmVhazsKKwkJY2FzZSBTTUIyX09QX0hB
UkRMSU5LOgorCQkJcnFzdFtudW1fcnFzdF0ucnFfaW92ID0gJnZhcnMtPnNpX2lvdlswXTsKKwkJ
CXJxc3RbbnVtX3Jxc3RdLnJxX252ZWMgPSAyOwogCi0JCWxlbiA9ICgyICogVW5pU3Rybmxlbigo
d2NoYXJfdCAqKXB0ciwgUEFUSF9NQVgpKTsKKwkJCWxlbiA9IGluX2lvdltpXS5pb3ZfbGVuOwog
Ci0JCXZhcnMtPmxpbmtfaW5mby5SZXBsYWNlSWZFeGlzdHMgPSAwOwotCQl2YXJzLT5saW5rX2lu
Zm8uUm9vdERpcmVjdG9yeSA9IDA7Ci0JCXZhcnMtPmxpbmtfaW5mby5GaWxlTmFtZUxlbmd0aCA9
IGNwdV90b19sZTMyKGxlbik7CisJCQl2YXJzLT5saW5rX2luZm8uUmVwbGFjZUlmRXhpc3RzID0g
MDsKKwkJCXZhcnMtPmxpbmtfaW5mby5Sb290RGlyZWN0b3J5ID0gMDsKKwkJCXZhcnMtPmxpbmtf
aW5mby5GaWxlTmFtZUxlbmd0aCA9IGNwdV90b19sZTMyKGxlbik7CiAKLQkJc2l6ZVswXSA9IHNp
emVvZihzdHJ1Y3Qgc21iMl9maWxlX2xpbmtfaW5mbyk7Ci0JCWRhdGFbMF0gPSAmdmFycy0+bGlu
a19pbmZvOworCQkJc2l6ZVswXSA9IHNpemVvZihzdHJ1Y3Qgc21iMl9maWxlX2xpbmtfaW5mbyk7
CisJCQlkYXRhWzBdID0gJnZhcnMtPmxpbmtfaW5mbzsKIAotCQlzaXplWzFdID0gbGVuICsgMiAv
KiBudWxsICovOwotCQlkYXRhWzFdID0gKF9fbGUxNiAqKXB0cjsKKwkJCXNpemVbMV0gPSBsZW4g
KyAyIC8qIG51bGwgKi87CisJCQlkYXRhWzFdID0gaW5faW92W2ldLmlvdl9iYXNlOwogCi0JCXJj
ID0gU01CMl9zZXRfaW5mb19pbml0KHRjb24sIHNlcnZlciwKLQkJCQkJJnJxc3RbbnVtX3Jxc3Rd
LCBDT01QT1VORF9GSUQsCi0JCQkJCUNPTVBPVU5EX0ZJRCwgY3VycmVudC0+dGdpZCwKLQkJCQkJ
RklMRV9MSU5LX0lORk9STUFUSU9OLAotCQkJCQlTTUIyX09fSU5GT19GSUxFLCAwLCBkYXRhLCBz
aXplKTsKLQkJaWYgKHJjKQotCQkJZ290byBmaW5pc2hlZDsKLQkJc21iMl9zZXRfbmV4dF9jb21t
YW5kKHRjb24sICZycXN0W251bV9ycXN0XSk7Ci0JCXNtYjJfc2V0X3JlbGF0ZWQoJnJxc3RbbnVt
X3Jxc3QrK10pOwotCQl0cmFjZV9zbWIzX2hhcmRsaW5rX2VudGVyKHhpZCwgc2VzLT5TdWlkLCB0
Y29uLT50aWQsIGZ1bGxfcGF0aCk7Ci0JCWJyZWFrOwotCWRlZmF1bHQ6Ci0JCWNpZnNfZGJnKFZG
UywgIkludmFsaWQgY29tbWFuZFxuIik7Ci0JCXJjID0gLUVJTlZBTDsKKwkJCXJjID0gU01CMl9z
ZXRfaW5mb19pbml0KHRjb24sIHNlcnZlciwKKwkJCQkJCSZycXN0W251bV9ycXN0XSwgQ09NUE9V
TkRfRklELAorCQkJCQkJQ09NUE9VTkRfRklELCBjdXJyZW50LT50Z2lkLAorCQkJCQkJRklMRV9M
SU5LX0lORk9STUFUSU9OLAorCQkJCQkJU01CMl9PX0lORk9fRklMRSwgMCwgZGF0YSwgc2l6ZSk7
CisJCQlpZiAocmMpCisJCQkJZ290byBmaW5pc2hlZDsKKwkJCXNtYjJfc2V0X25leHRfY29tbWFu
ZCh0Y29uLCAmcnFzdFtudW1fcnFzdF0pOworCQkJc21iMl9zZXRfcmVsYXRlZCgmcnFzdFtudW1f
cnFzdCsrXSk7CisJCQl0cmFjZV9zbWIzX2hhcmRsaW5rX2VudGVyKHhpZCwgc2VzLT5TdWlkLCB0
Y29uLT50aWQsIGZ1bGxfcGF0aCk7CisJCQlicmVhazsKKwkJZGVmYXVsdDoKKwkJCWNpZnNfZGJn
KFZGUywgIkludmFsaWQgY29tbWFuZFxuIik7CisJCQlyYyA9IC1FSU5WQUw7CisJCX0KIAl9CiAJ
aWYgKHJjKQogCQlnb3RvIGZpbmlzaGVkOwpAQCAtMzg1LDE0NSArMzgyLDE0MiBAQCBzdGF0aWMg
aW50IHNtYjJfY29tcG91bmRfb3AoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNf
dGNvbiAqdGNvbiwKIAkJCQkJcnFzdCwgcmVzcF9idWZ0eXBlLAogCQkJCQlyc3BfaW92KTsKIAot
IGZpbmlzaGVkOgotCVNNQjJfb3Blbl9mcmVlKCZycXN0WzBdKTsKK2ZpbmlzaGVkOgorCW51bV9y
cXN0ID0gMDsKKwlTTUIyX29wZW5fZnJlZSgmcnFzdFtudW1fcnFzdCsrXSk7CiAJaWYgKHJjID09
IC1FUkVNQ0hHKSB7CiAJCXByX3dhcm5fb25jZSgic2VydmVyIHNoYXJlICVzIGRlbGV0ZWRcbiIs
IHRjb24tPnRyZWVfbmFtZSk7CiAJCXRjb24tPm5lZWRfcmVjb25uZWN0ID0gdHJ1ZTsKIAl9CiAK
LQlzd2l0Y2ggKGNvbW1hbmQpIHsKLQljYXNlIFNNQjJfT1BfUVVFUllfSU5GTzoKLQkJaWRhdGEg
PSBwdHI7Ci0JCWlmIChyYyA9PSAwICYmIGNmaWxlICYmIGNmaWxlLT5zeW1saW5rX3RhcmdldCkg
ewotCQkJaWRhdGEtPnN5bWxpbmtfdGFyZ2V0ID0ga3N0cmR1cChjZmlsZS0+c3ltbGlua190YXJn
ZXQsIEdGUF9LRVJORUwpOwotCQkJaWYgKCFpZGF0YS0+c3ltbGlua190YXJnZXQpCi0JCQkJcmMg
PSAtRU5PTUVNOwotCQl9Ci0JCWlmIChyYyA9PSAwKSB7Ci0JCQlxaV9yc3AgPSAoc3RydWN0IHNt
YjJfcXVlcnlfaW5mb19yc3AgKikKLQkJCQlyc3BfaW92WzFdLmlvdl9iYXNlOwotCQkJcmMgPSBz
bWIyX3ZhbGlkYXRlX2FuZF9jb3B5X2lvdigKLQkJCQlsZTE2X3RvX2NwdShxaV9yc3AtPk91dHB1
dEJ1ZmZlck9mZnNldCksCi0JCQkJbGUzMl90b19jcHUocWlfcnNwLT5PdXRwdXRCdWZmZXJMZW5n
dGgpLAotCQkJCSZyc3BfaW92WzFdLCBzaXplb2YoaWRhdGEtPmZpKSwgKGNoYXIgKikmaWRhdGEt
PmZpKTsKLQkJfQotCQlpZiAocnFzdFsxXS5ycV9pb3YpCi0JCQlTTUIyX3F1ZXJ5X2luZm9fZnJl
ZSgmcnFzdFsxXSk7Ci0JCWlmIChycXN0WzJdLnJxX2lvdikKLQkJCVNNQjJfY2xvc2VfZnJlZSgm
cnFzdFsyXSk7Ci0JCWlmIChyYykKLQkJCXRyYWNlX3NtYjNfcXVlcnlfaW5mb19jb21wb3VuZF9l
cnIoeGlkLCAgc2VzLT5TdWlkLAotCQkJCQkJdGNvbi0+dGlkLCByYyk7Ci0JCWVsc2UKLQkJCXRy
YWNlX3NtYjNfcXVlcnlfaW5mb19jb21wb3VuZF9kb25lKHhpZCwgc2VzLT5TdWlkLAotCQkJCQkJ
dGNvbi0+dGlkKTsKLQkJYnJlYWs7Ci0JY2FzZSBTTUIyX09QX1BPU0lYX1FVRVJZX0lORk86Ci0J
CWlkYXRhID0gcHRyOwotCQlpZiAocmMgPT0gMCAmJiBjZmlsZSAmJiBjZmlsZS0+c3ltbGlua190
YXJnZXQpIHsKLQkJCWlkYXRhLT5zeW1saW5rX3RhcmdldCA9IGtzdHJkdXAoY2ZpbGUtPnN5bWxp
bmtfdGFyZ2V0LCBHRlBfS0VSTkVMKTsKLQkJCWlmICghaWRhdGEtPnN5bWxpbmtfdGFyZ2V0KQot
CQkJCXJjID0gLUVOT01FTTsKLQkJfQotCQlpZiAocmMgPT0gMCkgewotCQkJcWlfcnNwID0gKHN0
cnVjdCBzbWIyX3F1ZXJ5X2luZm9fcnNwICopCi0JCQkJcnNwX2lvdlsxXS5pb3ZfYmFzZTsKLQkJ
CXJjID0gc21iMl92YWxpZGF0ZV9hbmRfY29weV9pb3YoCi0JCQkJbGUxNl90b19jcHUocWlfcnNw
LT5PdXRwdXRCdWZmZXJPZmZzZXQpLAotCQkJCWxlMzJfdG9fY3B1KHFpX3JzcC0+T3V0cHV0QnVm
ZmVyTGVuZ3RoKSwKLQkJCQkmcnNwX2lvdlsxXSwgc2l6ZW9mKGlkYXRhLT5wb3NpeF9maSkgLyog
YWRkIFNJRHMgKi8sCi0JCQkJKGNoYXIgKikmaWRhdGEtPnBvc2l4X2ZpKTsKLQkJfQotCQlpZiAo
cmMgPT0gMCkgewotCQkJdW5zaWduZWQgaW50IGxlbmd0aCA9IGxlMzJfdG9fY3B1KHFpX3JzcC0+
T3V0cHV0QnVmZmVyTGVuZ3RoKTsKLQotCQkJaWYgKGxlbmd0aCA+IHNpemVvZihpZGF0YS0+cG9z
aXhfZmkpKSB7Ci0JCQkJY2hhciAqYmFzZSA9IChjaGFyICopcnNwX2lvdlsxXS5pb3ZfYmFzZSAr
Ci0JCQkJCWxlMTZfdG9fY3B1KHFpX3JzcC0+T3V0cHV0QnVmZmVyT2Zmc2V0KSArCi0JCQkJCXNp
emVvZihpZGF0YS0+cG9zaXhfZmkpOwotCQkJCSpleHRidWZsZW4gPSBsZW5ndGggLSBzaXplb2Yo
aWRhdGEtPnBvc2l4X2ZpKTsKLQkJCQkqZXh0YnVmID0ga21lbWR1cChiYXNlLCAqZXh0YnVmbGVu
LCBHRlBfS0VSTkVMKTsKLQkJCQlpZiAoISpleHRidWYpCisJZm9yIChpID0gMDsgaSA8IG51bV9j
bWRzOyBpKyspIHsKKwkJc3dpdGNoIChjbWRzW2ldKSB7CisJCWNhc2UgU01CMl9PUF9RVUVSWV9J
TkZPOgorCQkJaWRhdGEgPSBpbl9pb3ZbaV0uaW92X2Jhc2U7CisJCQlpZiAocmMgPT0gMCAmJiBj
ZmlsZSAmJiBjZmlsZS0+c3ltbGlua190YXJnZXQpIHsKKwkJCQlpZGF0YS0+c3ltbGlua190YXJn
ZXQgPSBrc3RyZHVwKGNmaWxlLT5zeW1saW5rX3RhcmdldCwgR0ZQX0tFUk5FTCk7CisJCQkJaWYg
KCFpZGF0YS0+c3ltbGlua190YXJnZXQpCisJCQkJCXJjID0gLUVOT01FTTsKKwkJCX0KKwkJCWlm
IChyYyA9PSAwKSB7CisJCQkJcWlfcnNwID0gKHN0cnVjdCBzbWIyX3F1ZXJ5X2luZm9fcnNwICop
CisJCQkJCXJzcF9pb3ZbaSArIDFdLmlvdl9iYXNlOworCQkJCXJjID0gc21iMl92YWxpZGF0ZV9h
bmRfY29weV9pb3YoCisJCQkJCWxlMTZfdG9fY3B1KHFpX3JzcC0+T3V0cHV0QnVmZmVyT2Zmc2V0
KSwKKwkJCQkJbGUzMl90b19jcHUocWlfcnNwLT5PdXRwdXRCdWZmZXJMZW5ndGgpLAorCQkJCQkm
cnNwX2lvdltpICsgMV0sIHNpemVvZihpZGF0YS0+ZmkpLCAoY2hhciAqKSZpZGF0YS0+ZmkpOwor
CQkJfQorCQkJU01CMl9xdWVyeV9pbmZvX2ZyZWUoJnJxc3RbbnVtX3Jxc3QrK10pOworCQkJaWYg
KHJjKQorCQkJCXRyYWNlX3NtYjNfcXVlcnlfaW5mb19jb21wb3VuZF9lcnIoeGlkLCAgc2VzLT5T
dWlkLAorCQkJCQkJCQkgICB0Y29uLT50aWQsIHJjKTsKKwkJCWVsc2UKKwkJCQl0cmFjZV9zbWIz
X3F1ZXJ5X2luZm9fY29tcG91bmRfZG9uZSh4aWQsIHNlcy0+U3VpZCwKKwkJCQkJCQkJICAgIHRj
b24tPnRpZCk7CisJCQlicmVhazsKKwkJY2FzZSBTTUIyX09QX1BPU0lYX1FVRVJZX0lORk86CisJ
CQlpZGF0YSA9IGluX2lvdltpXS5pb3ZfYmFzZTsKKwkJCWlmIChyYyA9PSAwICYmIGNmaWxlICYm
IGNmaWxlLT5zeW1saW5rX3RhcmdldCkgeworCQkJCWlkYXRhLT5zeW1saW5rX3RhcmdldCA9IGtz
dHJkdXAoY2ZpbGUtPnN5bWxpbmtfdGFyZ2V0LCBHRlBfS0VSTkVMKTsKKwkJCQlpZiAoIWlkYXRh
LT5zeW1saW5rX3RhcmdldCkKIAkJCQkJcmMgPSAtRU5PTUVNOwotCQkJfSBlbHNlIHsKLQkJCQly
YyA9IC1FSU5WQUw7CiAJCQl9CisJCQlpZiAocmMgPT0gMCkgeworCQkJCXFpX3JzcCA9IChzdHJ1
Y3Qgc21iMl9xdWVyeV9pbmZvX3JzcCAqKQorCQkJCQlyc3BfaW92W2kgKyAxXS5pb3ZfYmFzZTsK
KwkJCQlyYyA9IHNtYjJfdmFsaWRhdGVfYW5kX2NvcHlfaW92KAorCQkJCQlsZTE2X3RvX2NwdShx
aV9yc3AtPk91dHB1dEJ1ZmZlck9mZnNldCksCisJCQkJCWxlMzJfdG9fY3B1KHFpX3JzcC0+T3V0
cHV0QnVmZmVyTGVuZ3RoKSwKKwkJCQkJJnJzcF9pb3ZbaSArIDFdLCBzaXplb2YoaWRhdGEtPnBv
c2l4X2ZpKSAvKiBhZGQgU0lEcyAqLywKKwkJCQkJKGNoYXIgKikmaWRhdGEtPnBvc2l4X2ZpKTsK
KwkJCX0KKwkJCWlmIChyYyA9PSAwKSB7CisJCQkJdW5zaWduZWQgaW50IGxlbmd0aCA9IGxlMzJf
dG9fY3B1KHFpX3JzcC0+T3V0cHV0QnVmZmVyTGVuZ3RoKTsKKworCQkJCWlmIChsZW5ndGggPiBz
aXplb2YoaWRhdGEtPnBvc2l4X2ZpKSkgeworCQkJCQljaGFyICpiYXNlID0gKGNoYXIgKilyc3Bf
aW92W2kgKyAxXS5pb3ZfYmFzZSArCisJCQkJCQlsZTE2X3RvX2NwdShxaV9yc3AtPk91dHB1dEJ1
ZmZlck9mZnNldCkgKworCQkJCQkJc2l6ZW9mKGlkYXRhLT5wb3NpeF9maSk7CisJCQkJCSpleHRi
dWZsZW4gPSBsZW5ndGggLSBzaXplb2YoaWRhdGEtPnBvc2l4X2ZpKTsKKwkJCQkJKmV4dGJ1ZiA9
IGttZW1kdXAoYmFzZSwgKmV4dGJ1ZmxlbiwgR0ZQX0tFUk5FTCk7CisJCQkJCWlmICghKmV4dGJ1
ZikKKwkJCQkJCXJjID0gLUVOT01FTTsKKwkJCQl9IGVsc2UgeworCQkJCQlyYyA9IC1FSU5WQUw7
CisJCQkJfQorCQkJfQorCQkJU01CMl9xdWVyeV9pbmZvX2ZyZWUoJnJxc3RbbnVtX3Jxc3QrK10p
OworCQkJaWYgKHJjKQorCQkJCXRyYWNlX3NtYjNfcG9zaXhfcXVlcnlfaW5mb19jb21wb3VuZF9l
cnIoeGlkLCAgc2VzLT5TdWlkLAorCQkJCQkJCQkJIHRjb24tPnRpZCwgcmMpOworCQkJZWxzZQor
CQkJCXRyYWNlX3NtYjNfcG9zaXhfcXVlcnlfaW5mb19jb21wb3VuZF9kb25lKHhpZCwgc2VzLT5T
dWlkLAorCQkJCQkJCQkJICB0Y29uLT50aWQpOworCQkJYnJlYWs7CisJCWNhc2UgU01CMl9PUF9E
RUxFVEU6CisJCQlpZiAocmMpCisJCQkJdHJhY2Vfc21iM19kZWxldGVfZXJyKHhpZCwgIHNlcy0+
U3VpZCwgdGNvbi0+dGlkLCByYyk7CisJCQllbHNlCisJCQkJdHJhY2Vfc21iM19kZWxldGVfZG9u
ZSh4aWQsIHNlcy0+U3VpZCwgdGNvbi0+dGlkKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1Bf
TUtESVI6CisJCQlpZiAocmMpCisJCQkJdHJhY2Vfc21iM19ta2Rpcl9lcnIoeGlkLCAgc2VzLT5T
dWlkLCB0Y29uLT50aWQsIHJjKTsKKwkJCWVsc2UKKwkJCQl0cmFjZV9zbWIzX21rZGlyX2RvbmUo
eGlkLCBzZXMtPlN1aWQsIHRjb24tPnRpZCk7CisJCQlicmVhazsKKwkJY2FzZSBTTUIyX09QX0hB
UkRMSU5LOgorCQkJaWYgKHJjKQorCQkJCXRyYWNlX3NtYjNfaGFyZGxpbmtfZXJyKHhpZCwgIHNl
cy0+U3VpZCwgdGNvbi0+dGlkLCByYyk7CisJCQllbHNlCisJCQkJdHJhY2Vfc21iM19oYXJkbGlu
a19kb25lKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQpOworCQkJU01CMl9zZXRfaW5mb19mcmVl
KCZycXN0W251bV9ycXN0KytdKTsKKwkJCWJyZWFrOworCQljYXNlIFNNQjJfT1BfUkVOQU1FOgor
CQkJaWYgKHJjKQorCQkJCXRyYWNlX3NtYjNfcmVuYW1lX2Vycih4aWQsICBzZXMtPlN1aWQsIHRj
b24tPnRpZCwgcmMpOworCQkJZWxzZQorCQkJCXRyYWNlX3NtYjNfcmVuYW1lX2RvbmUoeGlkLCBz
ZXMtPlN1aWQsIHRjb24tPnRpZCk7CisJCQlTTUIyX3NldF9pbmZvX2ZyZWUoJnJxc3RbbnVtX3Jx
c3QrK10pOworCQkJYnJlYWs7CisJCWNhc2UgU01CMl9PUF9STURJUjoKKwkJCWlmIChyYykKKwkJ
CQl0cmFjZV9zbWIzX3JtZGlyX2Vycih4aWQsICBzZXMtPlN1aWQsIHRjb24tPnRpZCwgcmMpOwor
CQkJZWxzZQorCQkJCXRyYWNlX3NtYjNfcm1kaXJfZG9uZSh4aWQsIHNlcy0+U3VpZCwgdGNvbi0+
dGlkKTsKKwkJCVNNQjJfc2V0X2luZm9fZnJlZSgmcnFzdFtudW1fcnFzdCsrXSk7CisJCQlicmVh
azsKKwkJY2FzZSBTTUIyX09QX1NFVF9FT0Y6CisJCQlpZiAocmMpCisJCQkJdHJhY2Vfc21iM19z
ZXRfZW9mX2Vycih4aWQsICBzZXMtPlN1aWQsIHRjb24tPnRpZCwgcmMpOworCQkJZWxzZQorCQkJ
CXRyYWNlX3NtYjNfc2V0X2VvZl9kb25lKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQpOworCQkJ
U01CMl9zZXRfaW5mb19mcmVlKCZycXN0W251bV9ycXN0KytdKTsKKwkJCWJyZWFrOworCQljYXNl
IFNNQjJfT1BfU0VUX0lORk86CisJCQlpZiAocmMpCisJCQkJdHJhY2Vfc21iM19zZXRfaW5mb19j
b21wb3VuZF9lcnIoeGlkLCAgc2VzLT5TdWlkLAorCQkJCQkJCQkgdGNvbi0+dGlkLCByYyk7CisJ
CQllbHNlCisJCQkJdHJhY2Vfc21iM19zZXRfaW5mb19jb21wb3VuZF9kb25lKHhpZCwgc2VzLT5T
dWlkLAorCQkJCQkJCQkgIHRjb24tPnRpZCk7CisJCQlTTUIyX3NldF9pbmZvX2ZyZWUoJnJxc3Rb
bnVtX3Jxc3QrK10pOworCQkJYnJlYWs7CiAJCX0KLQkJaWYgKHJxc3RbMV0ucnFfaW92KQotCQkJ
U01CMl9xdWVyeV9pbmZvX2ZyZWUoJnJxc3RbMV0pOwotCQlpZiAocnFzdFsyXS5ycV9pb3YpCi0J
CQlTTUIyX2Nsb3NlX2ZyZWUoJnJxc3RbMl0pOwotCQlpZiAocmMpCi0JCQl0cmFjZV9zbWIzX3Bv
c2l4X3F1ZXJ5X2luZm9fY29tcG91bmRfZXJyKHhpZCwgIHNlcy0+U3VpZCwgdGNvbi0+dGlkLCBy
Yyk7Ci0JCWVsc2UKLQkJCXRyYWNlX3NtYjNfcG9zaXhfcXVlcnlfaW5mb19jb21wb3VuZF9kb25l
KHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQpOwotCQlicmVhazsKLQljYXNlIFNNQjJfT1BfREVM
RVRFOgotCQlpZiAocmMpCi0JCQl0cmFjZV9zbWIzX2RlbGV0ZV9lcnIoeGlkLCAgc2VzLT5TdWlk
LCB0Y29uLT50aWQsIHJjKTsKLQkJZWxzZQotCQkJdHJhY2Vfc21iM19kZWxldGVfZG9uZSh4aWQs
IHNlcy0+U3VpZCwgdGNvbi0+dGlkKTsKLQkJaWYgKHJxc3RbMV0ucnFfaW92KQotCQkJU01CMl9j
bG9zZV9mcmVlKCZycXN0WzFdKTsKLQkJYnJlYWs7Ci0JY2FzZSBTTUIyX09QX01LRElSOgotCQlp
ZiAocmMpCi0JCQl0cmFjZV9zbWIzX21rZGlyX2Vycih4aWQsICBzZXMtPlN1aWQsIHRjb24tPnRp
ZCwgcmMpOwotCQllbHNlCi0JCQl0cmFjZV9zbWIzX21rZGlyX2RvbmUoeGlkLCBzZXMtPlN1aWQs
IHRjb24tPnRpZCk7Ci0JCWlmIChycXN0WzFdLnJxX2lvdikKLQkJCVNNQjJfY2xvc2VfZnJlZSgm
cnFzdFsxXSk7Ci0JCWJyZWFrOwotCWNhc2UgU01CMl9PUF9IQVJETElOSzoKLQkJaWYgKHJjKQot
CQkJdHJhY2Vfc21iM19oYXJkbGlua19lcnIoeGlkLCAgc2VzLT5TdWlkLCB0Y29uLT50aWQsIHJj
KTsKLQkJZWxzZQotCQkJdHJhY2Vfc21iM19oYXJkbGlua19kb25lKHhpZCwgc2VzLT5TdWlkLCB0
Y29uLT50aWQpOwotCQlmcmVlX3NldF9pbmZfY29tcG91bmQocnFzdCk7Ci0JCWJyZWFrOwotCWNh
c2UgU01CMl9PUF9SRU5BTUU6Ci0JCWlmIChyYykKLQkJCXRyYWNlX3NtYjNfcmVuYW1lX2Vycih4
aWQsICBzZXMtPlN1aWQsIHRjb24tPnRpZCwgcmMpOwotCQllbHNlCi0JCQl0cmFjZV9zbWIzX3Jl
bmFtZV9kb25lKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQpOwotCQlmcmVlX3NldF9pbmZfY29t
cG91bmQocnFzdCk7Ci0JCWJyZWFrOwotCWNhc2UgU01CMl9PUF9STURJUjoKLQkJaWYgKHJjKQot
CQkJdHJhY2Vfc21iM19ybWRpcl9lcnIoeGlkLCAgc2VzLT5TdWlkLCB0Y29uLT50aWQsIHJjKTsK
LQkJZWxzZQotCQkJdHJhY2Vfc21iM19ybWRpcl9kb25lKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50
aWQpOwotCQlmcmVlX3NldF9pbmZfY29tcG91bmQocnFzdCk7Ci0JCWJyZWFrOwotCWNhc2UgU01C
Ml9PUF9TRVRfRU9GOgotCQlpZiAocmMpCi0JCQl0cmFjZV9zbWIzX3NldF9lb2ZfZXJyKHhpZCwg
IHNlcy0+U3VpZCwgdGNvbi0+dGlkLCByYyk7Ci0JCWVsc2UKLQkJCXRyYWNlX3NtYjNfc2V0X2Vv
Zl9kb25lKHhpZCwgc2VzLT5TdWlkLCB0Y29uLT50aWQpOwotCQlmcmVlX3NldF9pbmZfY29tcG91
bmQocnFzdCk7Ci0JCWJyZWFrOwotCWNhc2UgU01CMl9PUF9TRVRfSU5GTzoKLQkJaWYgKHJjKQot
CQkJdHJhY2Vfc21iM19zZXRfaW5mb19jb21wb3VuZF9lcnIoeGlkLCAgc2VzLT5TdWlkLAotCQkJ
CQkJdGNvbi0+dGlkLCByYyk7Ci0JCWVsc2UKLQkJCXRyYWNlX3NtYjNfc2V0X2luZm9fY29tcG91
bmRfZG9uZSh4aWQsIHNlcy0+U3VpZCwKLQkJCQkJCXRjb24tPnRpZCk7Ci0JCWZyZWVfc2V0X2lu
Zl9jb21wb3VuZChycXN0KTsKLQkJYnJlYWs7CiAJfQorCVNNQjJfY2xvc2VfZnJlZSgmcnFzdFtu
dW1fcnFzdF0pOwogCiAJaWYgKGNmaWxlKQogCQljaWZzRmlsZUluZm9fcHV0KGNmaWxlKTsKIAor
CW51bV9jbWRzICs9IDI7CiAJaWYgKG91dF9pb3YgJiYgb3V0X2J1ZnR5cGUpIHsKLQkJbWVtY3B5
KG91dF9pb3YsIHJzcF9pb3YsIDMgKiBzaXplb2YoKm91dF9pb3YpKTsKLQkJbWVtY3B5KG91dF9i
dWZ0eXBlLCByZXNwX2J1ZnR5cGUsIDMgKiBzaXplb2YoKm91dF9idWZ0eXBlKSk7CisJCW1lbWNw
eShvdXRfaW92LCByc3BfaW92LCBudW1fY21kcyAqIHNpemVvZigqb3V0X2lvdikpOworCQltZW1j
cHkob3V0X2J1ZnR5cGUsIHJlc3BfYnVmdHlwZSwKKwkJICAgICAgIG51bV9jbWRzICogc2l6ZW9m
KCpvdXRfYnVmdHlwZSkpOwogCX0gZWxzZSB7Ci0JCWZyZWVfcnNwX2J1ZihyZXNwX2J1ZnR5cGVb
MF0sIHJzcF9pb3ZbMF0uaW92X2Jhc2UpOwotCQlmcmVlX3JzcF9idWYocmVzcF9idWZ0eXBlWzFd
LCByc3BfaW92WzFdLmlvdl9iYXNlKTsKLQkJZnJlZV9yc3BfYnVmKHJlc3BfYnVmdHlwZVsyXSwg
cnNwX2lvdlsyXS5pb3ZfYmFzZSk7CisJCWZvciAoaSA9IDA7IGkgPCBudW1fY21kczsgaSsrKQor
CQkJZnJlZV9yc3BfYnVmKHJlc3BfYnVmdHlwZVtpXSwgcnNwX2lvdltpXS5pb3ZfYmFzZSk7CiAJ
fQogCWtmcmVlKHZhcnMpOwogCXJldHVybiByYzsKQEAgLTU2OSw5ICs1NjMsMTAgQEAgaW50IHNt
YjJfcXVlcnlfcGF0aF9pbmZvKGNvbnN0IHVuc2lnbmVkIGludCB4aWQsCiAJc3RydWN0IGNpZnNG
aWxlSW5mbyAqY2ZpbGU7CiAJc3RydWN0IGNhY2hlZF9maWQgKmNmaWQgPSBOVUxMOwogCXN0cnVj
dCBzbWIyX2hkciAqaGRyOwotCXN0cnVjdCBrdmVjIG91dF9pb3ZbM10gPSB7fTsKKwlzdHJ1Y3Qg
a3ZlYyBpbl9pb3YsIG91dF9pb3ZbM10gPSB7fTsKIAlpbnQgb3V0X2J1ZnR5cGVbM10gPSB7fTsK
IAlib29sIGlzbGluazsKKwlpbnQgY21kID0gU01CMl9PUF9RVUVSWV9JTkZPOwogCWludCByYywg
cmMyOwogCiAJZGF0YS0+YWRqdXN0X3R6ID0gZmFsc2U7CkBAIC01OTMsMTAgKzU4OCwxNCBAQCBp
bnQgc21iMl9xdWVyeV9wYXRoX2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwKIAkJcmV0dXJu
IHJjOwogCX0KIAorCWluX2lvdi5pb3ZfYmFzZSA9IGRhdGE7CisJaW5faW92Lmlvdl9sZW4gPSBz
aXplb2YoKmRhdGEpOworCiAJY2lmc19nZXRfcmVhZGFibGVfcGF0aCh0Y29uLCBmdWxsX3BhdGgs
ICZjZmlsZSk7Ci0JcmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVs
bF9wYXRoLCBGSUxFX1JFQURfQVRUUklCVVRFUywgRklMRV9PUEVOLAotCQkJICAgICAgY3JlYXRl
X29wdGlvbnMsIEFDTF9OT19NT0RFLCBkYXRhLCBTTUIyX09QX1FVRVJZX0lORk8sIGNmaWxlLAot
CQkJICAgICAgTlVMTCwgTlVMTCwgb3V0X2lvdiwgb3V0X2J1ZnR5cGUpOworCXJjID0gc21iMl9j
b21wb3VuZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIGZ1bGxfcGF0aCwKKwkJCSAgICAgIEZJTEVf
UkVBRF9BVFRSSUJVVEVTLCBGSUxFX09QRU4sCisJCQkgICAgICBjcmVhdGVfb3B0aW9ucywgQUNM
X05PX01PREUsICZpbl9pb3YsCisJCQkgICAgICAmY21kLCAxLCBjZmlsZSwgTlVMTCwgTlVMTCwg
b3V0X2lvdiwgb3V0X2J1ZnR5cGUpOwogCWhkciA9IG91dF9pb3ZbMF0uaW92X2Jhc2U7CiAJLyoK
IAkgKiBJZiBmaXJzdCBpb3YgaXMgdW5zZXQsIHRoZW4gU01CIHNlc3Npb24gd2FzIGRyb3BwZWQg
b3Igd2UndmUgZ290IGEKQEAgLTYxNyw5ICs2MTYsOCBAQCBpbnQgc21iMl9xdWVyeV9wYXRoX2lu
Zm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwKIAkJY2lmc19nZXRfcmVhZGFibGVfcGF0aCh0Y29u
LCBmdWxsX3BhdGgsICZjZmlsZSk7CiAJCXJjID0gc21iMl9jb21wb3VuZF9vcCh4aWQsIHRjb24s
IGNpZnNfc2IsIGZ1bGxfcGF0aCwKIAkJCQkgICAgICBGSUxFX1JFQURfQVRUUklCVVRFUywgRklM
RV9PUEVOLAotCQkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwgZGF0YSwKLQkJ
CQkgICAgICBTTUIyX09QX1FVRVJZX0lORk8sIGNmaWxlLCBOVUxMLCBOVUxMLAotCQkJCSAgICAg
IE5VTEwsIE5VTEwpOworCQkJCSAgICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwgJmlu
X2lvdiwKKwkJCQkgICAgICAmY21kLCAxLCBjZmlsZSwgTlVMTCwgTlVMTCwgTlVMTCwgTlVMTCk7
CiAJCWJyZWFrOwogCWNhc2UgLUVSRU1PVEU6CiAJCWJyZWFrOwpAQCAtNjU0LDEyICs2NTIsMTMg
QEAgaW50IHNtYjMxMV9wb3NpeF9xdWVyeV9wYXRoX2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhp
ZCwKIAlpbnQgcmM7CiAJX191MzIgY3JlYXRlX29wdGlvbnMgPSAwOwogCXN0cnVjdCBjaWZzRmls
ZUluZm8gKmNmaWxlOwotCXN0cnVjdCBrdmVjIG91dF9pb3ZbM10gPSB7fTsKKwlzdHJ1Y3Qga3Zl
YyBpbl9pb3YsIG91dF9pb3ZbM10gPSB7fTsKIAlpbnQgb3V0X2J1ZnR5cGVbM10gPSB7fTsKIAlf
X3U4ICpzaWRzYnVmID0gTlVMTDsKIAlfX3U4ICpzaWRzYnVmX2VuZCA9IE5VTEw7CiAJc2l6ZV90
IHNpZHNidWZsZW4gPSAwOwogCXNpemVfdCBvd25lcl9sZW4sIGdyb3VwX2xlbjsKKwlpbnQgY21k
ID0gU01CMl9PUF9QT1NJWF9RVUVSWV9JTkZPOwogCiAJZGF0YS0+YWRqdXN0X3R6ID0gZmFsc2U7
CiAJZGF0YS0+cmVwYXJzZV9wb2ludCA9IGZhbHNlOwpAQCAtNjcwLDExICs2NjksMTQgQEAgaW50
IHNtYjMxMV9wb3NpeF9xdWVyeV9wYXRoX2luZm8oY29uc3QgdW5zaWduZWQgaW50IHhpZCwKIAkg
KiB3aGVuIHdlIGFscmVhZHkgaGF2ZSBhbiBvcGVuIGZpbGUgaGFuZGxlIGZvciB0aGlzLiBGb3Ig
bm93IHRoaXMgaXMgZmFzdCBlbm91Z2gKIAkgKiAoYWx3YXlzIHVzaW5nIHRoZSBjb21wb3VuZGVk
IHZlcnNpb24pLgogCSAqLworCWluX2lvdi5pb3ZfYmFzZSA9IGRhdGE7CisJaW5faW92Lmlvdl9s
ZW4gPSBzaXplb2YoKmRhdGEpOwogCiAJY2lmc19nZXRfcmVhZGFibGVfcGF0aCh0Y29uLCBmdWxs
X3BhdGgsICZjZmlsZSk7Ci0JcmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19z
YiwgZnVsbF9wYXRoLCBGSUxFX1JFQURfQVRUUklCVVRFUywgRklMRV9PUEVOLAotCQkJICAgICAg
Y3JlYXRlX29wdGlvbnMsIEFDTF9OT19NT0RFLCBkYXRhLCBTTUIyX09QX1BPU0lYX1FVRVJZX0lO
Rk8sIGNmaWxlLAotCQkJICAgICAgJnNpZHNidWYsICZzaWRzYnVmbGVuLCBvdXRfaW92LCBvdXRf
YnVmdHlwZSk7CisJcmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVs
bF9wYXRoLAorCQkJICAgICAgRklMRV9SRUFEX0FUVFJJQlVURVMsIEZJTEVfT1BFTiwKKwkJCSAg
ICAgIGNyZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwgJmluX2lvdiwgJmNtZCwgMSwKKwkJCSAg
ICAgIGNmaWxlLCAmc2lkc2J1ZiwgJnNpZHNidWZsZW4sIG91dF9pb3YsIG91dF9idWZ0eXBlKTsK
IAkvKgogCSAqIElmIGZpcnN0IGlvdiBpcyB1bnNldCwgdGhlbiBTTUIgc2Vzc2lvbiB3YXMgZHJv
cHBlZCBvciB3ZSd2ZSBnb3QgYQogCSAqIGNhY2hlZCBvcGVuIGZpbGUgKEBjZmlsZSkuCkBAIC02
OTMsMTAgKzY5NSwxMCBAQCBpbnQgc21iMzExX3Bvc2l4X3F1ZXJ5X3BhdGhfaW5mbyhjb25zdCB1
bnNpZ25lZCBpbnQgeGlkLAogCQljcmVhdGVfb3B0aW9ucyB8PSBPUEVOX1JFUEFSU0VfUE9JTlQ7
CiAJCS8qIEZhaWxlZCBvbiBhIHN5bWJvbGljIGxpbmsgLSBxdWVyeSBhIHJlcGFyc2UgcG9pbnQg
aW5mbyAqLwogCQljaWZzX2dldF9yZWFkYWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwgJmNmaWxl
KTsKLQkJcmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9wYXRo
LCBGSUxFX1JFQURfQVRUUklCVVRFUywKLQkJCQkgICAgICBGSUxFX09QRU4sIGNyZWF0ZV9vcHRp
b25zLCBBQ0xfTk9fTU9ERSwgZGF0YSwKLQkJCQkgICAgICBTTUIyX09QX1BPU0lYX1FVRVJZX0lO
Rk8sIGNmaWxlLAotCQkJCSAgICAgICZzaWRzYnVmLCAmc2lkc2J1ZmxlbiwgTlVMTCwgTlVMTCk7
CisJCXJjID0gc21iMl9jb21wb3VuZF9vcCh4aWQsIHRjb24sIGNpZnNfc2IsIGZ1bGxfcGF0aCwK
KwkJCQkgICAgICBGSUxFX1JFQURfQVRUUklCVVRFUywgRklMRV9PUEVOLAorCQkJCSAgICAgIGNy
ZWF0ZV9vcHRpb25zLCBBQ0xfTk9fTU9ERSwgJmluX2lvdiwgJmNtZCwgMSwKKwkJCQkgICAgICBj
ZmlsZSwgJnNpZHNidWYsICZzaWRzYnVmbGVuLCBOVUxMLCBOVUxMKTsKIAkJYnJlYWs7CiAJfQog
CkBAIC03MzQsNyArNzM2LDggQEAgc21iMl9ta2Rpcihjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBz
dHJ1Y3QgaW5vZGUgKnBhcmVudF9pbm9kZSwgdW1vZGVfdCBtb2RlLAogewogCXJldHVybiBzbWIy
X2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgbmFtZSwKIAkJCQlGSUxFX1dSSVRFX0FU
VFJJQlVURVMsIEZJTEVfQ1JFQVRFLAotCQkJCUNSRUFURV9OT1RfRklMRSwgbW9kZSwgTlVMTCwg
U01CMl9PUF9NS0RJUiwKKwkJCQlDUkVBVEVfTk9UX0ZJTEUsIG1vZGUsIE5VTEwsCisJCQkJJihp
bnQpe1NNQjJfT1BfTUtESVJ9LCAxLAogCQkJCU5VTEwsIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwp
OwogfQogCkBAIC03NDMsMjEgKzc0NiwyNCBAQCBzbWIyX21rZGlyX3NldGluZm8oc3RydWN0IGlu
b2RlICppbm9kZSwgY29uc3QgY2hhciAqbmFtZSwKIAkJICAgc3RydWN0IGNpZnNfc2JfaW5mbyAq
Y2lmc19zYiwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgY29uc3QgdW5zaWduZWQgaW50
IHhpZCkKIHsKLQlGSUxFX0JBU0lDX0lORk8gZGF0YTsKKwlGSUxFX0JBU0lDX0lORk8gZGF0YSA9
IHt9OwogCXN0cnVjdCBjaWZzSW5vZGVJbmZvICpjaWZzX2k7CiAJc3RydWN0IGNpZnNGaWxlSW5m
byAqY2ZpbGU7CisJc3RydWN0IGt2ZWMgaW5faW92OwogCXUzMiBkb3NhdHRyczsKIAlpbnQgdG1w
cmM7CiAKLQltZW1zZXQoJmRhdGEsIDAsIHNpemVvZihkYXRhKSk7CisJaW5faW92Lmlvdl9iYXNl
ID0gJmRhdGE7CisJaW5faW92Lmlvdl9sZW4gPSBzaXplb2YoZGF0YSk7CiAJY2lmc19pID0gQ0lG
U19JKGlub2RlKTsKIAlkb3NhdHRycyA9IGNpZnNfaS0+Y2lmc0F0dHJzIHwgQVRUUl9SRUFET05M
WTsKIAlkYXRhLkF0dHJpYnV0ZXMgPSBjcHVfdG9fbGUzMihkb3NhdHRycyk7CiAJY2lmc19nZXRf
d3JpdGFibGVfcGF0aCh0Y29uLCBuYW1lLCBGSU5EX1dSX0FOWSwgJmNmaWxlKTsKIAl0bXByYyA9
IHNtYjJfY29tcG91bmRfb3AoeGlkLCB0Y29uLCBjaWZzX3NiLCBuYW1lLAogCQkJCSBGSUxFX1dS
SVRFX0FUVFJJQlVURVMsIEZJTEVfQ1JFQVRFLAotCQkJCSBDUkVBVEVfTk9UX0ZJTEUsIEFDTF9O
T19NT0RFLAotCQkJCSAmZGF0YSwgU01CMl9PUF9TRVRfSU5GTywgY2ZpbGUsIE5VTEwsIE5VTEws
IE5VTEwsIE5VTEwpOworCQkJCSBDUkVBVEVfTk9UX0ZJTEUsIEFDTF9OT19NT0RFLCAmaW5faW92
LAorCQkJCSAmKGludCl7U01CMl9PUF9TRVRfSU5GT30sIDEsCisJCQkJIGNmaWxlLCBOVUxMLCBO
VUxMLCBOVUxMLCBOVUxMKTsKIAlpZiAodG1wcmMgPT0gMCkKIAkJY2lmc19pLT5jaWZzQXR0cnMg
PSBkb3NhdHRyczsKIH0KQEAgLTc2Nyw5ICs3NzMsMTAgQEAgc21iMl9ybWRpcihjb25zdCB1bnNp
Z25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lmc190Y29uICp0Y29uLCBjb25zdCBjaGFyICpuYW1lLAog
CSAgIHN0cnVjdCBjaWZzX3NiX2luZm8gKmNpZnNfc2IpCiB7CiAJZHJvcF9jYWNoZWRfZGlyX2J5
X25hbWUoeGlkLCB0Y29uLCBuYW1lLCBjaWZzX3NiKTsKLQlyZXR1cm4gc21iMl9jb21wb3VuZF9v
cCh4aWQsIHRjb24sIGNpZnNfc2IsIG5hbWUsIERFTEVURSwgRklMRV9PUEVOLAotCQkJCUNSRUFU
RV9OT1RfRklMRSwgQUNMX05PX01PREUsCi0JCQkJTlVMTCwgU01CMl9PUF9STURJUiwgTlVMTCwg
TlVMTCwgTlVMTCwgTlVMTCwgTlVMTCk7CisJcmV0dXJuIHNtYjJfY29tcG91bmRfb3AoeGlkLCB0
Y29uLCBjaWZzX3NiLCBuYW1lLAorCQkJCURFTEVURSwgRklMRV9PUEVOLCBDUkVBVEVfTk9UX0ZJ
TEUsCisJCQkJQUNMX05PX01PREUsIE5VTEwsICYoaW50KXtTTUIyX09QX1JNRElSfSwgMSwKKwkJ
CQlOVUxMLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKIH0KIAogaW50CkBAIC03NzgsNyArNzg1
LDggQEAgc21iMl91bmxpbmsoY29uc3QgdW5zaWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNv
biAqdGNvbiwgY29uc3QgY2hhciAqbmFtZSwKIHsKIAlyZXR1cm4gc21iMl9jb21wb3VuZF9vcCh4
aWQsIHRjb24sIGNpZnNfc2IsIG5hbWUsIERFTEVURSwgRklMRV9PUEVOLAogCQkJCUNSRUFURV9E
RUxFVEVfT05fQ0xPU0UgfCBPUEVOX1JFUEFSU0VfUE9JTlQsCi0JCQkJQUNMX05PX01PREUsIE5V
TEwsIFNNQjJfT1BfREVMRVRFLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKKwkJCQlB
Q0xfTk9fTU9ERSwgTlVMTCwgJihpbnQpe1NNQjJfT1BfREVMRVRFfSwgMSwKKwkJCQlOVUxMLCBO
VUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKIH0KIAogc3RhdGljIGludApAQCAtNzg3LDYgKzc5NSw3
IEBAIHNtYjJfc2V0X3BhdGhfYXR0cihjb25zdCB1bnNpZ25lZCBpbnQgeGlkLCBzdHJ1Y3QgY2lm
c190Y29uICp0Y29uLAogCQkgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLCBfX3UzMiBh
Y2Nlc3MsIGludCBjb21tYW5kLAogCQkgICBzdHJ1Y3QgY2lmc0ZpbGVJbmZvICpjZmlsZSkKIHsK
KwlzdHJ1Y3Qga3ZlYyBpbl9pb3Y7CiAJX19sZTE2ICpzbWIyX3RvX25hbWUgPSBOVUxMOwogCWlu
dCByYzsKIApAQCAtNzk1LDkgKzgwNCwxMSBAQCBzbWIyX3NldF9wYXRoX2F0dHIoY29uc3QgdW5z
aWduZWQgaW50IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJcmMgPSAtRU5PTUVNOwog
CQlnb3RvIHNtYjJfcmVuYW1lX3BhdGg7CiAJfQorCWluX2lvdi5pb3ZfYmFzZSA9IHNtYjJfdG9f
bmFtZTsKKwlpbl9pb3YuaW92X2xlbiA9IDIgKiBVbmlTdHJubGVuKCh3Y2hhcl90ICopc21iMl90
b19uYW1lLCBQQVRIX01BWCk7CiAJcmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lm
c19zYiwgZnJvbV9uYW1lLCBhY2Nlc3MsCi0JCQkgICAgICBGSUxFX09QRU4sIDAsIEFDTF9OT19N
T0RFLCBzbWIyX3RvX25hbWUsCi0JCQkgICAgICBjb21tYW5kLCBjZmlsZSwgTlVMTCwgTlVMTCwg
TlVMTCwgTlVMTCk7CisJCQkgICAgICBGSUxFX09QRU4sIDAsIEFDTF9OT19NT0RFLCAmaW5faW92
LAorCQkJICAgICAgJmNvbW1hbmQsIDEsIGNmaWxlLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsK
IHNtYjJfcmVuYW1lX3BhdGg6CiAJa2ZyZWUoc21iMl90b19uYW1lKTsKIAlyZXR1cm4gcmM7CkBA
IC04MzIsMTMgKzg0MywxOCBAQCBzbWIyX3NldF9wYXRoX3NpemUoY29uc3QgdW5zaWduZWQgaW50
IHhpZCwgc3RydWN0IGNpZnNfdGNvbiAqdGNvbiwKIAkJICAgY29uc3QgY2hhciAqZnVsbF9wYXRo
LCBfX3U2NCBzaXplLAogCQkgICBzdHJ1Y3QgY2lmc19zYl9pbmZvICpjaWZzX3NiLCBib29sIHNl
dF9hbGxvYykKIHsKLQlfX2xlNjQgZW9mID0gY3B1X3RvX2xlNjQoc2l6ZSk7CiAJc3RydWN0IGNp
ZnNGaWxlSW5mbyAqY2ZpbGU7CisJc3RydWN0IGt2ZWMgaW5faW92OworCV9fbGU2NCBlb2YgPSBj
cHVfdG9fbGU2NChzaXplKTsKIAorCWluX2lvdi5pb3ZfYmFzZSA9ICZlb2Y7CisJaW5faW92Lmlv
dl9sZW4gPSBzaXplb2YoZW9mKTsKIAljaWZzX2dldF93cml0YWJsZV9wYXRoKHRjb24sIGZ1bGxf
cGF0aCwgRklORF9XUl9BTlksICZjZmlsZSk7CiAJcmV0dXJuIHNtYjJfY29tcG91bmRfb3AoeGlk
LCB0Y29uLCBjaWZzX3NiLCBmdWxsX3BhdGgsCi0JCQkJRklMRV9XUklURV9EQVRBLCBGSUxFX09Q
RU4sIDAsIEFDTF9OT19NT0RFLAotCQkJCSZlb2YsIFNNQjJfT1BfU0VUX0VPRiwgY2ZpbGUsIE5V
TEwsIE5VTEwsIE5VTEwsIE5VTEwpOworCQkJCUZJTEVfV1JJVEVfREFUQSwgRklMRV9PUEVOLAor
CQkJCTAsIEFDTF9OT19NT0RFLCAmaW5faW92LAorCQkJCSYoaW50KXtTTUIyX09QX1NFVF9FT0Z9
LCAxLAorCQkJCWNmaWxlLCBOVUxMLCBOVUxMLCBOVUxMLCBOVUxMKTsKIH0KIAogaW50CkBAIC04
NDksNiArODY1LDcgQEAgc21iMl9zZXRfZmlsZV9pbmZvKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNv
bnN0IGNoYXIgKmZ1bGxfcGF0aCwKIAlzdHJ1Y3QgdGNvbl9saW5rICp0bGluazsKIAlzdHJ1Y3Qg
Y2lmc190Y29uICp0Y29uOwogCXN0cnVjdCBjaWZzRmlsZUluZm8gKmNmaWxlOworCXN0cnVjdCBr
dmVjIGluX2lvdiA9IHsgLmlvdl9iYXNlID0gYnVmLCAuaW92X2xlbiA9IHNpemVvZigqYnVmKSwg
fTsKIAlpbnQgcmM7CiAKIAlpZiAoKGJ1Zi0+Q3JlYXRpb25UaW1lID09IDApICYmIChidWYtPkxh
c3RBY2Nlc3NUaW1lID09IDApICYmCkBAIC04NjQsNyArODgxLDggQEAgc21iMl9zZXRfZmlsZV9p
bmZvKHN0cnVjdCBpbm9kZSAqaW5vZGUsIGNvbnN0IGNoYXIgKmZ1bGxfcGF0aCwKIAljaWZzX2dl
dF93cml0YWJsZV9wYXRoKHRjb24sIGZ1bGxfcGF0aCwgRklORF9XUl9BTlksICZjZmlsZSk7CiAJ
cmMgPSBzbWIyX2NvbXBvdW5kX29wKHhpZCwgdGNvbiwgY2lmc19zYiwgZnVsbF9wYXRoLAogCQkJ
ICAgICAgRklMRV9XUklURV9BVFRSSUJVVEVTLCBGSUxFX09QRU4sCi0JCQkgICAgICAwLCBBQ0xf
Tk9fTU9ERSwgYnVmLCBTTUIyX09QX1NFVF9JTkZPLCBjZmlsZSwKKwkJCSAgICAgIDAsIEFDTF9O
T19NT0RFLCAmaW5faW92LAorCQkJICAgICAgJihpbnQpe1NNQjJfT1BfU0VUX0lORk99LCAxLCBj
ZmlsZSwKIAkJCSAgICAgIE5VTEwsIE5VTEwsIE5VTEwsIE5VTEwpOwogCWNpZnNfcHV0X3RsaW5r
KHRsaW5rKTsKIAlyZXR1cm4gcmM7Ci0tIAoyLjQwLjEKCg==
--00000000000042b2a9060d203dce--

