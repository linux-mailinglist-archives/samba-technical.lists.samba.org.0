Return-Path: <samba-technical-bounces@lists.samba.org>
X-Original-To: lists+samba-technical@lfdr.de
Delivered-To: lists+samba-technical@lfdr.de
Received: from hr1.samba.org (hr1.samba.org [IPv6:2a01:4f8:192:486::1:0])
	by mail.lfdr.de (Postfix) with ESMTPS id 699901B6957
	for <lists+samba-technical@lfdr.de>; Fri, 24 Apr 2020 01:22:40 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.samba.org; s=2954282; h=Cc:From:List-Id:Date:To:Subject;
	bh=WPJvxCR/EOQRV2cNutWGyT56sbRDVKtW0G4m/IIXNnw=; b=ZhWJtqwgeiYOzwivbwbQy/Fx+5
	UiQEP00XsIhm/eMybcEzc45itKLvXqr29EjFBfdA771XUPS9YvtC0hycHz7Xwqor2Gh8vxOay1qYi
	2BUq0d5IV4Wf/QO7SrXrofZMMk02uwVJNASUB4hl/QbqMqXn20MrlPb42gEAeG8hiwPfOo18OSFEv
	fkJLBadSpm2FJbuYZ+2ZuofOUl+7mKRhYHMNOYGdf5Ya0IiBo889waa3dyaxSGGLzzAcKxAYpe4Kl
	x9PRUNkLeNeMZ4SWKa0M1vy1mBKpp1M7THB0YH7GVH2VZle+SeI4JKa0JuLSdnGsxBo3um8Wc9wOD
	CAp7iNdQ==;
Received: from localhost ([::1]:31008 helo=hr1.samba.org) 
	by hr1.samba.org with esmtp (Exim)
	id 1jRlAI-001nah-I7; Thu, 23 Apr 2020 23:21:54 +0000
Received: from hr2.samba.org ([2a01:4f8:192:486::2:0]:49526) 
 by hr1.samba.org with esmtps (TLS1.3:ECDHE_RSA_CHACHA20_POLY1305:256)
 (Exim) id 1jRl9n-001naH-Iy; Thu, 23 Apr 2020 23:21:42 +0000
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed; d=samba.org; 
 s=42; h=Date:Cc:To:From:Message-ID;
 bh=WPJvxCR/EOQRV2cNutWGyT56sbRDVKtW0G4m/IIXNnw=; b=dwFtkZ++31oU2QUlRFrgmWuy/2
 RcoVk1AF2mFnTTDvm+VV+7FWBGLQdpw0QtnmLZqpe+E+rog1xiuI9nKvXz/WEOKsDo4J0jSf+/KAW
 bQtkubpChPR1eT/STdRwRqx7rXDxLvnfZwKQ8zO47Q/kBbE5qRiy6VxeQ0o4wK01sHkhObZsjGDDu
 iTNKD/D+cRKLQAdWcncnX0/zBchWJ1XiH3IKfWvBaJV427WJ31CgILe3kA+yygp4JVHLPhco4fgaj
 CbbtSVovKFHfQPowhDzzIbkBQX1Baazb9JHViXONzonMvz0+FaE+TTsOqA5TAgDThvhvsI2WFHxSO
 MKrKgQMmaPL1ywlP8m+S1FT/wLrHZmLbhDDC1jM/Rlf+q9r9om1g6hzLmEk295ZrFWU2zhFcAWL6e
 EGiOTddf0rSarp2OwWKwY8p0SOzDOWvnuTSEZwK7e/pYdtJey6fmi8YJwoMd0Ij3glpIlL+F9mHx4
 jybhfm+JVZSlsOAGMxuAUstq;
Received: from [127.0.0.2] (localhost [127.0.0.1])
 by hr2.samba.org with esmtpsa (TLS1.2:ECDHE_ECDSA_CHACHA20_POLY1305:256)
 (Exim) id 1jRl9k-0004up-PW; Thu, 23 Apr 2020 23:21:21 +0000
Message-ID: <e1f40342668bac05c391840dbd655ab21e4e12cc.camel@samba.org>
Subject: Re: [Samba] pad length mismatch error message
To: "von Obernitz, Daniel" <daniel.vonobernitz@uni-greifswald.de>, Stefan
 Metzmacher <metze@samba.org>, Samuel Cabrero <scabrero@suse.de>
Date: Fri, 24 Apr 2020 11:21:14 +1200
In-Reply-To: <d680231eadbb1512c1f818b6b8cbebb0@groupware.uni-greifswald.de>
References: <1fa227af0c431e030f328ae2bb254ee8@groupware.uni-greifswald.de>
 <d680231eadbb1512c1f818b6b8cbebb0@groupware.uni-greifswald.de>
Content-Type: multipart/mixed; boundary="=-iWlhfTB9UoBKyeDVZR0H"
X-Mailer: Evolution 3.28.5-0ubuntu0.18.04.2 
Mime-Version: 1.0
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
 subscribe to the list samba@lists.samba.org"
 <samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/options/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/pipermail/samba-technical/>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=subscribe>
From: Andrew Bartlett via samba-technical <samba-technical@lists.samba.org>
Reply-To: Andrew Bartlett <abartlet@samba.org>
Cc: samba@lists.samba.org,
 Upstream Samba Technical Mailing list <samba-technical@lists.samba.org>
Errors-To: samba-technical-bounces@lists.samba.org
Sender: "samba-technical" <samba-technical-bounces@lists.samba.org>


--=-iWlhfTB9UoBKyeDVZR0H
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: 7bit

On Thu, 2020-04-23 at 12:28 +0200, von Obernitz, Daniel via samba
wrote:
> Hi Andrew,
> 
> > Once you work out what client is changing this, then send me a
> > network
> > capture and matching Samba log (use "debug hires timestamp = Yes",
> > "log
> > level = 4") and I'll add it to my backlog to look into.
> 
> I think I was able to identify and reproduce the occurrence of the
> error message:
> 
> 1. You have a new Windows 10 client
> 2. The computer MUST NOT be in the computer list in the AC-DC
> 3. You join the Windows client to the domain and reboot
> 4. About when the login screen appears on the Windows client, the
> error message pops up.
> 
> If the computer is already listed in the AD-DC, you can remove and
> rejoin the Windows Client as much as you want without the error.
> And if the computer object is new, it also only happens I would say 4
> out of 5 times.
> 
> I was able to record the logs with your suggested loglevel and a
> corresponding tcpdump. I will send it to you separately, maybe it
> helps.
> 
> Since everything else is working fine (join, login etc) this is
> definitely not a critical issue IMHO.

The code in question goes back to the 'BadLock' patches in 2016.  I
think this is probably a strange codepath on the windows client. 

I'm going to at least propose a patch to make the messages provide some
more info for the next person who needs to look at this.

The only thing that makes sense is that the difference - 44, is the
length of a single ctx_list in:
dcerpc_bind {
 ...
 dcerpc_ctx_list ctx_list[num_contexts];
 ...
}

The client is sending 3 items in ctx_list, but only putting 2 in the
header, so we don't look for the last 44 bytes.  Rather than just look
from the end for the authentication trailer, we assert that everything
must add up. 

If we didn't fail here, we would fail trying to parse the SPNEGO.  We
use the NDR_REMAINING flag for the authentication trailer so we just
dump everything left in the packet into that.

I've redacted the the sensitive parts (the actual SPNEGO exchange) and
included the ndrdump output to illustrate. 

Finally, I have a patch that should at least make the calculations
clearer, see attached. 

I've filed https://bugzilla.samba.org/show_bug.cgi?id=14356

Andrew Bartlett
-- 
Andrew Bartlett                       https://samba.org/~abartlet/
Authentication Developer, Samba Team  https://samba.org
Samba Developer, Catalyst IT          
https://catalyst.net.nz/services/samba



--=-iWlhfTB9UoBKyeDVZR0H
Content-Disposition: attachment; filename="bad-redacted.txt"
Content-Type: text/plain; name="bad-redacted.txt"; charset="UTF-8"
Content-Transfer-Encoding: base64

cHVsbCByZXR1cm5lZCBTdWNjZXNzCiAgICBuY2Fjbl9wYWNrZXQ6IHN0cnVjdCBuY2Fjbl9wYWNr
ZXQKICAgICAgICBycGNfdmVycyAgICAgICAgICAgICAgICAgOiAweDA1ICg1KQogICAgICAgIHJw
Y192ZXJzX21pbm9yICAgICAgICAgICA6IDB4MDAgKDApCiAgICAgICAgcHR5cGUgICAgICAgICAg
ICAgICAgICAgIDogRENFUlBDX1BLVF9CSU5EICgxMSkKICAgICAgICBwZmNfZmxhZ3MgICAgICAg
ICAgICAgICAgOiAweDA3ICg3KQogICAgICAgICAgICAgICAxOiBEQ0VSUENfUEZDX0ZMQUdfRklS
U1QgICAgCiAgICAgICAgICAgICAgIDE6IERDRVJQQ19QRkNfRkxBR19MQVNUICAgICAKICAgICAg
ICAgICAgICAgMTogRENFUlBDX1BGQ19GTEFHX1BFTkRJTkdfQ0FOQ0VMX09SX0hEUl9TSUdOSU5H
CiAgICAgICAgICAgICAgIDA6IERDRVJQQ19QRkNfRkxBR19DT05DX01QWCAKICAgICAgICAgICAg
ICAgMDogRENFUlBDX1BGQ19GTEFHX0RJRF9OT1RfRVhFQ1VURQogICAgICAgICAgICAgICAwOiBE
Q0VSUENfUEZDX0ZMQUdfTUFZQkUgICAgCiAgICAgICAgICAgICAgIDA6IERDRVJQQ19QRkNfRkxB
R19PQkpFQ1RfVVVJRAogICAgICAgIGRyZXA6IEFSUkFZKDQpCiAgICAgICAgICAgIFswXSAgICAg
ICAgICAgICAgICAgICAgICA6IDB4MTAgKDE2KQogICAgICAgICAgICBbMV0gICAgICAgICAgICAg
ICAgICAgICAgOiAweDAwICgwKQogICAgICAgICAgICBbMl0gICAgICAgICAgICAgICAgICAgICAg
OiAweDAwICgwKQogICAgICAgICAgICBbM10gICAgICAgICAgICAgICAgICAgICAgOiAweDAwICgw
KQogICAgICAgIGZyYWdfbGVuZ3RoICAgICAgICAgICAgICA6IDB4MDg1MiAoMjEzMCkKICAgICAg
ICBhdXRoX2xlbmd0aCAgICAgICAgICAgICAgOiAweDA3YWEgKDE5NjIpCiAgICAgICAgY2FsbF9p
ZCAgICAgICAgICAgICAgICAgIDogMHgwMDAwMDAwMiAoMikKICAgICAgICB1ICAgICAgICAgICAg
ICAgICAgICAgICAgOiB1bmlvbiBkY2VycGNfcGF5bG9hZChjYXNlIDExKQogICAgICAgIGJpbmQ6
IHN0cnVjdCBkY2VycGNfYmluZAogICAgICAgICAgICBtYXhfeG1pdF9mcmFnICAgICAgICAgICAg
OiAweDE2ZDAgKDU4NDApCiAgICAgICAgICAgIG1heF9yZWN2X2ZyYWcgICAgICAgICAgICA6IDB4
MTZkMCAoNTg0MCkKICAgICAgICAgICAgYXNzb2NfZ3JvdXBfaWQgICAgICAgICAgIDogMHgwMDAw
MWIzMSAoNjk2MSkKICAgICAgICAgICAgbnVtX2NvbnRleHRzICAgICAgICAgICAgIDogMHgwMiAo
MikKICAgICAgICAgICAgY3R4X2xpc3Q6IEFSUkFZKDIpCiAgICAgICAgICAgICAgICBjdHhfbGlz
dDogc3RydWN0IGRjZXJwY19jdHhfbGlzdAogICAgICAgICAgICAgICAgICAgIGNvbnRleHRfaWQg
ICAgICAgICAgICAgICA6IDB4MDAwMCAoMCkKICAgICAgICAgICAgICAgICAgICBudW1fdHJhbnNm
ZXJfc3ludGF4ZXMgICAgOiAweDAxICgxKQogICAgICAgICAgICAgICAgICAgIGFic3RyYWN0X3N5
bnRheDogc3RydWN0IG5kcl9zeW50YXhfaWQKICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCAg
ICAgICAgICAgICAgICAgICAgIDogZTM1MTQyMzUtNGIwNi0xMWQxLWFiMDQtMDBjMDRmYzJkY2Qy
CiAgICAgICAgICAgICAgICAgICAgICAgIGlmX3ZlcnNpb24gICAgICAgICAgICAgICA6IDB4MDAw
MDAwMDQgKDQpCiAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJfc3ludGF4ZXM6IEFSUkFZKDEp
CiAgICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZmVyX3N5bnRheGVzOiBzdHJ1Y3QgbmRyX3N5
bnRheF9pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCAgICAgICAgICAgICAgICAg
ICAgIDogOGE4ODVkMDQtMWNlYi0xMWM5LTlmZTgtMDgwMDJiMTA0ODYwCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBpZl92ZXJzaW9uICAgICAgICAgICAgICAgOiAweDAwMDAwMDAyICgyKQog
ICAgICAgICAgICAgICAgY3R4X2xpc3Q6IHN0cnVjdCBkY2VycGNfY3R4X2xpc3QKICAgICAgICAg
ICAgICAgICAgICBjb250ZXh0X2lkICAgICAgICAgICAgICAgOiAweDAwMDEgKDEpCiAgICAgICAg
ICAgICAgICAgICAgbnVtX3RyYW5zZmVyX3N5bnRheGVzICAgIDogMHgwMSAoMSkKICAgICAgICAg
ICAgICAgICAgICBhYnN0cmFjdF9zeW50YXg6IHN0cnVjdCBuZHJfc3ludGF4X2lkCiAgICAgICAg
ICAgICAgICAgICAgICAgIHV1aWQgICAgICAgICAgICAgICAgICAgICA6IGUzNTE0MjM1LTRiMDYt
MTFkMS1hYjA0LTAwYzA0ZmMyZGNkMgogICAgICAgICAgICAgICAgICAgICAgICBpZl92ZXJzaW9u
ICAgICAgICAgICAgICAgOiAweDAwMDAwMDA0ICg0KQogICAgICAgICAgICAgICAgICAgIHRyYW5z
ZmVyX3N5bnRheGVzOiBBUlJBWSgxKQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zlcl9z
eW50YXhlczogc3RydWN0IG5kcl9zeW50YXhfaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHV1aWQgICAgICAgICAgICAgICAgICAgICA6IDcxNzEwNTMzLWJlYmEtNDkzNy04MzE5LWI1ZGJl
ZjljY2MzNgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZfdmVyc2lvbiAgICAgICAgICAg
ICAgIDogMHgwMDAwMDAwMSAoMSkKICAgICAgICAgICAgYXV0aF9pbmZvICAgICAgICAgICAgICAg
IDogREFUQV9CTE9CIGxlbmd0aD0yMDE0ClswMDAwXSAwMiAwMCAwMSAwMCAzNSA0MiA1MSBFMyAg
IDA2IDRCIEQxIDExIEFCIDA0IDAwIEMwICAgLi4uLjVCUS4gLksuLi4uLi4KWzAwMTBdIDRGIEMy
IERDIEQyIDA0IDAwIDAwIDAwICAgMkMgMUMgQjcgNkMgMTIgOTggNDAgNDUgICBPLi4uLi4uLiAs
Li5sLi5ARQpbMDAyMF0gMDMgMDAgMDAgMDAgMDAgMDAgMDAgMDAgICAwMSAwMCAwMCAwMCAwOSAw
NiAwMCAwMCAgIC4uLi4uLi4uIC4uLi4uLi4uClswMDMwXSAwMCAwMCAwMCAwMCAK


--=-iWlhfTB9UoBKyeDVZR0H
Content-Disposition: attachment; filename="good-redacted.txt"
Content-Type: text/plain; name="good-redacted.txt"; charset="UTF-8"
Content-Transfer-Encoding: base64

cHVsbCByZXR1cm5lZCBTdWNjZXNzCiAgICBuY2Fjbl9wYWNrZXQ6IHN0cnVjdCBuY2Fjbl9wYWNr
ZXQKICAgICAgICBycGNfdmVycyAgICAgICAgICAgICAgICAgOiAweDA1ICg1KQogICAgICAgIHJw
Y192ZXJzX21pbm9yICAgICAgICAgICA6IDB4MDAgKDApCiAgICAgICAgcHR5cGUgICAgICAgICAg
ICAgICAgICAgIDogRENFUlBDX1BLVF9CSU5EICgxMSkKICAgICAgICBwZmNfZmxhZ3MgICAgICAg
ICAgICAgICAgOiAweDA3ICg3KQogICAgICAgICAgICAgICAxOiBEQ0VSUENfUEZDX0ZMQUdfRklS
U1QgICAgCiAgICAgICAgICAgICAgIDE6IERDRVJQQ19QRkNfRkxBR19MQVNUICAgICAKICAgICAg
ICAgICAgICAgMTogRENFUlBDX1BGQ19GTEFHX1BFTkRJTkdfQ0FOQ0VMX09SX0hEUl9TSUdOSU5H
CiAgICAgICAgICAgICAgIDA6IERDRVJQQ19QRkNfRkxBR19DT05DX01QWCAKICAgICAgICAgICAg
ICAgMDogRENFUlBDX1BGQ19GTEFHX0RJRF9OT1RfRVhFQ1VURQogICAgICAgICAgICAgICAwOiBE
Q0VSUENfUEZDX0ZMQUdfTUFZQkUgICAgCiAgICAgICAgICAgICAgIDA6IERDRVJQQ19QRkNfRkxB
R19PQkpFQ1RfVVVJRAogICAgICAgIGRyZXA6IEFSUkFZKDQpCiAgICAgICAgICAgIFswXSAgICAg
ICAgICAgICAgICAgICAgICA6IDB4MTAgKDE2KQogICAgICAgICAgICBbMV0gICAgICAgICAgICAg
ICAgICAgICAgOiAweDAwICgwKQogICAgICAgICAgICBbMl0gICAgICAgICAgICAgICAgICAgICAg
OiAweDAwICgwKQogICAgICAgICAgICBbM10gICAgICAgICAgICAgICAgICAgICAgOiAweDAwICgw
KQogICAgICAgIGZyYWdfbGVuZ3RoICAgICAgICAgICAgICA6IDB4MDgwOSAoMjA1NykKICAgICAg
ICBhdXRoX2xlbmd0aCAgICAgICAgICAgICAgOiAweDA3NjEgKDE4ODkpCiAgICAgICAgY2FsbF9p
ZCAgICAgICAgICAgICAgICAgIDogMHgwMDAwMDAwMyAoMykKICAgICAgICB1ICAgICAgICAgICAg
ICAgICAgICAgICAgOiB1bmlvbiBkY2VycGNfcGF5bG9hZChjYXNlIDExKQogICAgICAgIGJpbmQ6
IHN0cnVjdCBkY2VycGNfYmluZAogICAgICAgICAgICBtYXhfeG1pdF9mcmFnICAgICAgICAgICAg
OiAweDE2ZDAgKDU4NDApCiAgICAgICAgICAgIG1heF9yZWN2X2ZyYWcgICAgICAgICAgICA6IDB4
MTZkMCAoNTg0MCkKICAgICAgICAgICAgYXNzb2NfZ3JvdXBfaWQgICAgICAgICAgIDogMHgwMDAw
MDAwMCAoMCkKICAgICAgICAgICAgbnVtX2NvbnRleHRzICAgICAgICAgICAgIDogMHgwMyAoMykK
ICAgICAgICAgICAgY3R4X2xpc3Q6IEFSUkFZKDMpCiAgICAgICAgICAgICAgICBjdHhfbGlzdDog
c3RydWN0IGRjZXJwY19jdHhfbGlzdAogICAgICAgICAgICAgICAgICAgIGNvbnRleHRfaWQgICAg
ICAgICAgICAgICA6IDB4MDAwMCAoMCkKICAgICAgICAgICAgICAgICAgICBudW1fdHJhbnNmZXJf
c3ludGF4ZXMgICAgOiAweDAxICgxKQogICAgICAgICAgICAgICAgICAgIGFic3RyYWN0X3N5bnRh
eDogc3RydWN0IG5kcl9zeW50YXhfaWQKICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCAgICAg
ICAgICAgICAgICAgICAgIDogZTM1MTQyMzUtNGIwNi0xMWQxLWFiMDQtMDBjMDRmYzJkY2QyCiAg
ICAgICAgICAgICAgICAgICAgICAgIGlmX3ZlcnNpb24gICAgICAgICAgICAgICA6IDB4MDAwMDAw
MDQgKDQpCiAgICAgICAgICAgICAgICAgICAgdHJhbnNmZXJfc3ludGF4ZXM6IEFSUkFZKDEpCiAg
ICAgICAgICAgICAgICAgICAgICAgIHRyYW5zZmVyX3N5bnRheGVzOiBzdHJ1Y3QgbmRyX3N5bnRh
eF9pZAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXVpZCAgICAgICAgICAgICAgICAgICAg
IDogOGE4ODVkMDQtMWNlYi0xMWM5LTlmZTgtMDgwMDJiMTA0ODYwCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICBpZl92ZXJzaW9uICAgICAgICAgICAgICAgOiAweDAwMDAwMDAyICgyKQogICAg
ICAgICAgICAgICAgY3R4X2xpc3Q6IHN0cnVjdCBkY2VycGNfY3R4X2xpc3QKICAgICAgICAgICAg
ICAgICAgICBjb250ZXh0X2lkICAgICAgICAgICAgICAgOiAweDAwMDEgKDEpCiAgICAgICAgICAg
ICAgICAgICAgbnVtX3RyYW5zZmVyX3N5bnRheGVzICAgIDogMHgwMSAoMSkKICAgICAgICAgICAg
ICAgICAgICBhYnN0cmFjdF9zeW50YXg6IHN0cnVjdCBuZHJfc3ludGF4X2lkCiAgICAgICAgICAg
ICAgICAgICAgICAgIHV1aWQgICAgICAgICAgICAgICAgICAgICA6IGUzNTE0MjM1LTRiMDYtMTFk
MS1hYjA0LTAwYzA0ZmMyZGNkMgogICAgICAgICAgICAgICAgICAgICAgICBpZl92ZXJzaW9uICAg
ICAgICAgICAgICAgOiAweDAwMDAwMDA0ICg0KQogICAgICAgICAgICAgICAgICAgIHRyYW5zZmVy
X3N5bnRheGVzOiBBUlJBWSgxKQogICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2Zlcl9zeW50
YXhlczogc3RydWN0IG5kcl9zeW50YXhfaWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHV1
aWQgICAgICAgICAgICAgICAgICAgICA6IDcxNzEwNTMzLWJlYmEtNDkzNy04MzE5LWI1ZGJlZjlj
Y2MzNgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZfdmVyc2lvbiAgICAgICAgICAgICAg
IDogMHgwMDAwMDAwMSAoMSkKICAgICAgICAgICAgICAgIGN0eF9saXN0OiBzdHJ1Y3QgZGNlcnBj
X2N0eF9saXN0CiAgICAgICAgICAgICAgICAgICAgY29udGV4dF9pZCAgICAgICAgICAgICAgIDog
MHgwMDAyICgyKQogICAgICAgICAgICAgICAgICAgIG51bV90cmFuc2Zlcl9zeW50YXhlcyAgICA6
IDB4MDEgKDEpCiAgICAgICAgICAgICAgICAgICAgYWJzdHJhY3Rfc3ludGF4OiBzdHJ1Y3QgbmRy
X3N5bnRheF9pZAogICAgICAgICAgICAgICAgICAgICAgICB1dWlkICAgICAgICAgICAgICAgICAg
ICAgOiBlMzUxNDIzNS00YjA2LTExZDEtYWIwNC0wMGMwNGZjMmRjZDIKICAgICAgICAgICAgICAg
ICAgICAgICAgaWZfdmVyc2lvbiAgICAgICAgICAgICAgIDogMHgwMDAwMDAwNCAoNCkKICAgICAg
ICAgICAgICAgICAgICB0cmFuc2Zlcl9zeW50YXhlczogQVJSQVkoMSkKICAgICAgICAgICAgICAg
ICAgICAgICAgdHJhbnNmZXJfc3ludGF4ZXM6IHN0cnVjdCBuZHJfc3ludGF4X2lkCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB1dWlkICAgICAgICAgICAgICAgICAgICAgOiA2Y2I3MWMyYy05
ODEyLTQ1NDAtMDMwMC0wMDAwMDAwMDAwMDAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlm
X3ZlcnNpb24gICAgICAgICAgICAgICA6IDB4MDAwMDAwMDEgKDEpCiAgICAgICAgICAgIGF1dGhf
aW5mbyAgICAgICAgICAgICAgICA6IERBVEFfQkxPQiBsZW5ndGg9MTg5NwpbMDAwMF0gMDkgMDYg
MDAgMDAgMDAgMDAgMDAgMDAgICAK


--=-iWlhfTB9UoBKyeDVZR0H
Content-Disposition: attachment;
	filename*0=0001-librpc-Provide-clearer-debug-messages-for-malformed-.pat;
	filename*1=ch
Content-Type: text/x-patch;
	name="0001-librpc-Provide-clearer-debug-messages-for-malformed-.patch";
	charset="UTF-8"
Content-Transfer-Encoding: base64

RnJvbSBiZTQ1Mjk5NDI0ZDhlMWQyYmVmNDI5NmY0OTZmYThkZGQ4YmYyNWE0IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBBbmRyZXcgQmFydGxldHQgPGFiYXJ0bGV0QHNhbWJhLm9yZz4K
RGF0ZTogRnJpLCAyNCBBcHIgMjAyMCAxMTowNDowMCArMTIwMApTdWJqZWN0OiBbUEFUQ0hdIGxp
YnJwYzogUHJvdmlkZSBjbGVhcmVyIGRlYnVnIG1lc3NhZ2VzIGZvciBtYWxmb3JtZWQgRENFL1JQ
QwogYmluZAoKUkVGOiBodHRwczovL2xpc3RzLnNhbWJhLm9yZy9hcmNoaXZlL3NhbWJhLzIwMjAt
QXByaWwvMjI5MzM0Lmh0bWwKCkJVRzogaHR0cHM6Ly9idWd6aWxsYS5zYW1iYS5vcmcvc2hvd19i
dWcuY2dpP2lkPTE0MzU2CgpTaWduZWQtb2ZmLWJ5OiBBbmRyZXcgQmFydGxldHQgPGFiYXJ0bGV0
QHNhbWJhLm9yZz4KLS0tCiBsaWJycGMvcnBjL2RjZXJwY191dGlsLmMgfCAzNyArKysrKysrKysr
KysrKysrKysrKysrKysrKysrKy0tLS0tLS0tCiAxIGZpbGUgY2hhbmdlZCwgMjkgaW5zZXJ0aW9u
cygrKSwgOCBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9saWJycGMvcnBjL2RjZXJwY191dGls
LmMgYi9saWJycGMvcnBjL2RjZXJwY191dGlsLmMKaW5kZXggZjc1OTZjYjFhYzEuLmNmNmNiOTQy
YjFjIDEwMDY0NAotLS0gYS9saWJycGMvcnBjL2RjZXJwY191dGlsLmMKKysrIGIvbGlicnBjL3Jw
Yy9kY2VycGNfdXRpbC5jCkBAIC0zNTcsMjAgKzM1Nyw0MSBAQCBOVFNUQVRVUyBkY2VycGNfcHVs
bF9hdXRoX3RyYWlsZXIoY29uc3Qgc3RydWN0IG5jYWNuX3BhY2tldCAqcGt0LAogCX0KIAogCWlm
IChkYXRhX2FuZF9wYWQgPCBhdXRoLT5hdXRoX3BhZF9sZW5ndGgpIHsKLQkJREVCVUcoMSwgKF9f
bG9jYXRpb25fXyAiOiBFUlJPUjogcGFkIGxlbmd0aCBtaXNtYXRjaC4gIgotCQkJICAiQ2FsY3Vs
YXRlZCAldSAgZ290ICV1XG4iLAotCQkJICAodW5zaWduZWQpZGF0YV9hbmRfcGFkLAotCQkJICAo
dW5zaWduZWQpYXV0aC0+YXV0aF9wYWRfbGVuZ3RoKSk7CisJCURCR19XQVJOSU5HKF9fbG9jYXRp
b25fXyAiOiBFUlJPUjogcGFkIGxlbmd0aCB0b28gbG9uZy4gIgorCQkJICAgICJDYWxjdWxhdGVk
ICV1IChwa3RfdHJhaWxlci0+bGVuZ3RoPSV1IC0gYXV0aF9sZW5ndGg9JXUpICIKKwkJCSAgICAi
d2FzIGxlc3MgdGhhbiBhdXRoX3BhZF9sZW5ndGg9JXVcbiIsCisJCQkgICAgKHVuc2lnbmVkKWRh
dGFfYW5kX3BhZCwKKwkJCSAgICAodW5zaWduZWQpcGt0X3RyYWlsZXItPmxlbmd0aCwKKwkJCSAg
ICAodW5zaWduZWQpYXV0aF9sZW5ndGgsCisJCQkgICAgKHVuc2lnbmVkKWF1dGgtPmF1dGhfcGFk
X2xlbmd0aCk7CisJCXRhbGxvY19mcmVlKG5kcik7CisJCVpFUk9fU1RSVUNUUChhdXRoKTsKKwkJ
cmV0dXJuIE5UX1NUQVRVU19SUENfUFJPVE9DT0xfRVJST1I7CisJfQorCisJaWYgKGF1dGhfZGF0
YV9vbmx5ICYmIGRhdGFfYW5kX3BhZCA+IGF1dGgtPmF1dGhfcGFkX2xlbmd0aCkgeworCQlEQkdf
V0FSTklORyhfX2xvY2F0aW9uX18gIjogRVJST1I6IGF1dGhfZGF0YV9vbmx5IHBhZCBsZW5ndGgg
bWlzbWF0Y2guICIKKwkJCSAgICAiQ2xpZW50IHNlbnQgYSBsb25nZXIgQklORCBwYWNrZXQgdGhh
biBleHBlY3RlZCBieSAldSBieXRlcyAiCisJCQkgICAgIihwa3RfdHJhaWxlci0+bGVuZ3RoPSV1
IC0gYXV0aF9sZW5ndGg9JXUpICIKKwkJCSAgICAiPSAldSBhdXRoX3BhZF9sZW5ndGg9JXVcbiIs
CisJCQkgICAgKHVuc2lnbmVkKWRhdGFfYW5kX3BhZCAtICh1bnNpZ25lZClhdXRoLT5hdXRoX3Bh
ZF9sZW5ndGgsCisJCQkgICAgKHVuc2lnbmVkKXBrdF90cmFpbGVyLT5sZW5ndGgsCisJCQkgICAg
KHVuc2lnbmVkKWF1dGhfbGVuZ3RoLAorCQkJICAgICh1bnNpZ25lZClkYXRhX2FuZF9wYWQsCisJ
CQkgICAgKHVuc2lnbmVkKWF1dGgtPmF1dGhfcGFkX2xlbmd0aCk7CiAJCXRhbGxvY19mcmVlKG5k
cik7CiAJCVpFUk9fU1RSVUNUUChhdXRoKTsKIAkJcmV0dXJuIE5UX1NUQVRVU19SUENfUFJPVE9D
T0xfRVJST1I7CiAJfQogCiAJaWYgKGF1dGhfZGF0YV9vbmx5ICYmIGRhdGFfYW5kX3BhZCAhPSBh
dXRoLT5hdXRoX3BhZF9sZW5ndGgpIHsKLQkJREVCVUcoMSwgKF9fbG9jYXRpb25fXyAiOiBFUlJP
UjogcGFkIGxlbmd0aCBtaXNtYXRjaC4gIgotCQkJICAiQ2FsY3VsYXRlZCAldSAgZ290ICV1XG4i
LAotCQkJICAodW5zaWduZWQpZGF0YV9hbmRfcGFkLAotCQkJICAodW5zaWduZWQpYXV0aC0+YXV0
aF9wYWRfbGVuZ3RoKSk7CisJCURCR19XQVJOSU5HKF9fbG9jYXRpb25fXyAiOiBFUlJPUjogYXV0
aF9kYXRhX29ubHkgcGFkIGxlbmd0aCBtaXNtYXRjaC4gIgorCQkJICAgICJDYWxjdWxhdGVkICV1
IChwa3RfdHJhaWxlci0+bGVuZ3RoPSV1IC0gYXV0aF9sZW5ndGg9JXUpICIKKwkJCSAgICAiYnV0
IGF1dGhfcGFkX2xlbmd0aD0ldVxuIiwKKwkJCSAgICAodW5zaWduZWQpZGF0YV9hbmRfcGFkLAor
CQkJICAgICh1bnNpZ25lZClwa3RfdHJhaWxlci0+bGVuZ3RoLAorCQkJICAgICh1bnNpZ25lZClh
dXRoX2xlbmd0aCwKKwkJCSAgICAodW5zaWduZWQpYXV0aC0+YXV0aF9wYWRfbGVuZ3RoKTsKIAkJ
dGFsbG9jX2ZyZWUobmRyKTsKIAkJWkVST19TVFJVQ1RQKGF1dGgpOwogCQlyZXR1cm4gTlRfU1RB
VFVTX1JQQ19QUk9UT0NPTF9FUlJPUjsKLS0gCjIuMTcuMQoK


--=-iWlhfTB9UoBKyeDVZR0H--


