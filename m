Return-Path: <samba-technical-bounces@lists.samba.org>
X-Original-To: lists+samba-technical@lfdr.de
Delivered-To: lists+samba-technical@lfdr.de
Received: from hr1.samba.org (hr1.samba.org [IPv6:2a01:4f8:192:486::1:0])
	by mail.lfdr.de (Postfix) with ESMTPS id E8EE6341A4
	for <lists+samba-technical@lfdr.de>; Tue,  4 Jun 2019 10:19:28 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; q=dns/txt; c=relaxed/relaxed;
	d=lists.samba.org; s=2954282; h=Cc:From:List-Id:Date:To:Subject;
	bh=Gf0i82cX0yx+ussGkcCBK3/PmgZ6NfOn3COaclfJTiM=; b=q9Nd2oRetIgSV1QEDSAwbKGI/N
	lz+Hqsn8C09kXamYQ/WebqgnLLBI3frK7sMgwSffYnOtccpb+ixV65Fsoid4dcOdC1cHX50Okek6S
	/ul544OfX4X/acYf0OvfinJ7SiJ79iKig83fJt3YlhpJEp7CrnvrMqzku+AfcY8K3T5ZtQdNiy8VG
	NYFaPlVgP25x+J4lBy6gYbG2rDO1GFFX5eq4U1vNdYp5CkzsqvA9Wnb334me5RdVwLHSdBYc8P+HY
	cLItUekNJT8ivPmopwJvYtdFuX00Y/uPaxpvB2DyCt8mX1fFrJ2GNf7AhN/lOuof4gofze6qchnxN
	uzsdoGAA==;
Received: from localhost ([::1]:23564 helo=hr1.samba.org) 
	by hr1.samba.org with esmtp (Exim)
	id 1hY4eF-0050in-8x; Tue, 04 Jun 2019 08:18:23 +0000
Received: from mx0b-001b2d01.pphosted.com ([148.163.158.5]:33048
 helo=mx0a-001b2d01.pphosted.com) 
 by hr1.samba.org with esmtps (TLS1.2:ECDHE_RSA_AES_256_GCM_SHA384:256)
 (Exim) id 1hY4e7-0050ig-T3
 for samba-technical@lists.samba.org; Tue, 04 Jun 2019 08:18:20 +0000
Received: from pps.filterd (m0098414.ppops.net [127.0.0.1])
 by mx0b-001b2d01.pphosted.com (8.16.0.27/8.16.0.27) with SMTP id
 x548DpGT054073
 for <samba-technical@lists.samba.org>; Tue, 4 Jun 2019 04:18:03 -0400
Received: from e06smtp01.uk.ibm.com (e06smtp01.uk.ibm.com [195.75.94.97])
 by mx0b-001b2d01.pphosted.com with ESMTP id 2swjgnxnd8-1
 (version=TLSv1.2 cipher=AES256-GCM-SHA384 bits=256 verify=NOT)
 for <samba-technical@lists.samba.org>; Tue, 04 Jun 2019 04:18:03 -0400
Received: from localhost
 by e06smtp01.uk.ibm.com with IBM ESMTP SMTP Gateway: Authorized Use Only!
 Violators will be prosecuted
 for <samba-technical@lists.samba.org> from <swen@linux.ibm.com>;
 Tue, 4 Jun 2019 09:18:00 +0100
Received: from b06cxnps4074.portsmouth.uk.ibm.com (9.149.109.196)
 by e06smtp01.uk.ibm.com (192.168.101.131) with IBM ESMTP SMTP Gateway:
 Authorized Use Only! Violators will be prosecuted; 
 (version=TLSv1/SSLv3 cipher=AES256-GCM-SHA384 bits=256/256)
 Tue, 4 Jun 2019 09:17:58 +0100
Received: from d06av26.portsmouth.uk.ibm.com (d06av26.portsmouth.uk.ibm.com
 [9.149.105.62])
 by b06cxnps4074.portsmouth.uk.ibm.com (8.14.9/8.14.9/NCO v10.0) with ESMTP id
 x548HvxC43712582
 (version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK);
 Tue, 4 Jun 2019 08:17:57 GMT
Received: from d06av26.portsmouth.uk.ibm.com (unknown [127.0.0.1])
 by IMSVA (Postfix) with ESMTP id 637BFAE053;
 Tue,  4 Jun 2019 08:17:57 +0000 (GMT)
Received: from d06av26.portsmouth.uk.ibm.com (unknown [127.0.0.1])
 by IMSVA (Postfix) with ESMTP id 1EBFBAE04D;
 Tue,  4 Jun 2019 08:17:57 +0000 (GMT)
Received: from dhcp-9-244-58-64.kelsterbach.de.ibm.com (unknown [9.244.58.64])
 by d06av26.portsmouth.uk.ibm.com (Postfix) with ESMTP;
 Tue,  4 Jun 2019 08:17:57 +0000 (GMT)
Subject: [PATCH] string conversion extension
To: samba-technical <samba-technical@lists.samba.org>
Date: Tue, 04 Jun 2019 10:17:52 +0200
Content-Type: multipart/signed; micalg="pgp-sha512";
 protocol="application/pgp-signature"; boundary="=-hY/HHbRTIxHiA8ImEvEZ"
User-Agent: Evolution 3.30.5 (3.30.5-1.fc29) 
MIME-Version: 1.0
X-TM-AS-GCONF: 00
x-cbid: 19060408-4275-0000-0000-0000033C4859
X-IBM-AV-DETECTION: SAVI=unused REMOTE=unused XFE=unused
x-cbparentid: 19060408-4276-0000-0000-0000384C55CD
Message-Id: <5deca9e99b72fa3cfc346537cf34c2d5f4d3e994.camel@linux.ibm.com>
X-BeenThere: samba-technical@lists.samba.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: "Discussions on Samba internals. For general questions please
 subscribe to the list samba@lists.samba.org"
 <samba-technical.lists.samba.org>
List-Unsubscribe: <https://lists.samba.org/mailman/options/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=unsubscribe>
List-Archive: <http://lists.samba.org/pipermail/samba-technical/>
List-Post: <mailto:samba-technical@lists.samba.org>
List-Help: <mailto:samba-technical-request@lists.samba.org?subject=help>
List-Subscribe: <https://lists.samba.org/mailman/listinfo/samba-technical>,
 <mailto:samba-technical-request@lists.samba.org?subject=subscribe>
From: swen via samba-technical <samba-technical@lists.samba.org>
Reply-To: swen@linux.ibm.com
Cc: Christof Schmitt <cs@samba.org>, Jeremy Allison <jra@samba.org>
Errors-To: samba-technical-bounces@lists.samba.org
Sender: "samba-technical" <samba-technical-bounces@lists.samba.org>


--=-hY/HHbRTIxHiA8ImEvEZ
Content-Type: multipart/mixed; boundary="=-/8yrzXpqEyENfuCgjwZA"


--=-/8yrzXpqEyENfuCgjwZA
Content-Type: text/plain; charset="UTF-8"
Content-Transfer-Encoding: quoted-printable

At the time of the introduction of the internal string to int
conversion routines a few more ideas were voiced what=20
this coversion could offer.

This patch-set is introducing an API with which the functionality and
features of the conversion routines can be controlled by flags.
Offering the capabiltiy to add features in future without changing the
function API again.

Currently the following flags are defined
	SMB_STR_STANDARD		# current behaviour as it is now
	SMB_STR_ALLOW_NEGATIVE		# allow strings with a leading "-"
	SMB_STR_FULL_STR_CONV		# entire string must be converted
	SMB_STR_ALLOW_NO_CONVERSION	# allow empty strings or non-numeric
	SMB_STR_GLIBC_STANDARD		# act exactly as the standard glibc strtoul

Moving these extra capabilities to the conversion routines,
simplifies the code of the consuming functions.
Offering a common "one-stop-shop" for string to integer conversions
providing the individual flexibility required paired with extensibility for
future needs.

In addition this patchset adds a bunch of tests for the already existing an=
d
the newly introduced conversion capabilities.

The patch-set has passed all gitlab tests at
https://gitlab.com/samba-team/devel/samba/commits/sswen-string_conv_extensi=
on

https://gitlab.com/samba-team/devel/samba/pipelines/64563900

Merge request=20
https://gitlab.com/samba-team/samba/merge_requests/521

Please review and push if happy.

Thanks for your support in advance.

Cheers Swen

--=-/8yrzXpqEyENfuCgjwZA
Content-Disposition: attachment; filename="strtoul_extension_incl_test.patch"
Content-Type: text/x-patch; name="strtoul_extension_incl_test.patch"; charset="UTF-8"
Content-Transfer-Encoding: base64

RnJvbSBiMjlmYWZjMTFmNjk0YmE5ZjdlYWU2Y2E0ZDdlNTU4NzQwOGFlZTUwIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+CkRh
dGU6IFdlZCwgMTAgQXByIDIwMTkgMTA6MjQ6NTIgKzAyMDAKU3ViamVjdDogW1BBVENIIDAxLzE2
XSB0ZXN0cy11dGlsOiBBZGRpbmcgc3RydG91bChsKV9lcnIoKSB0ZXN0IGxlYXZpbmcgZXJybm8K
IHVudG91Y2hlZAoKVGhlIHdyYXBwZXIgZnVuY3Rpb25zIHN0cnRvdWxfZXJyKCkgYW5kIHN0cnRv
dWxsX2VycigpIHRyaWdnZXIKb3RoZXIgZnVuY3Rpb25zL3JvdXRpbmVzIHdoaWNoIG1vZGlmeSBl
cnJuby4KSG93ZXZlciwgY2FsbGVycyBvZiB0aG9zZSB3cmFwcGVyIGZ1bmN0aW9ucyBleHBlY3Qg
ZXJybm8gdG8gYmUgdW5jaGFuZ2VkLgpUaGlzIHRlc3QgdmVyaWZpZXMgdGhlIGV4cGVjdGF0aW9u
LgoKU2lnbmVkLW9mZi1ieTogU3dlbiBTY2hpbGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgotLS0K
IGxpYi91dGlsL3Rlc3RzL3V0aWwuYyB8IDI5ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysr
CiAxIGZpbGUgY2hhbmdlZCwgMjkgaW5zZXJ0aW9ucygrKQoKZGlmZiAtLWdpdCBhL2xpYi91dGls
L3Rlc3RzL3V0aWwuYyBiL2xpYi91dGlsL3Rlc3RzL3V0aWwuYwppbmRleCBhZDljNjYwNmU1OS4u
M2Y1OWNlNmY2ZGMgMTAwNjQ0Ci0tLSBhL2xpYi91dGlsL3Rlc3RzL3V0aWwuYworKysgYi9saWIv
dXRpbC90ZXN0cy91dGlsLmMKQEAgLTMsNiArMyw3IEBACiAgKgogICogQ29weXJpZ2h0IE1hcnRp
biBTY2h3ZW5rZSA8bWFydGluQG1lbHRpbi5uZXQ+IDIwMTYKICAqIENvcHlyaWdodCBDaHJpc3Rv
ZiBTY2htaXR0IDxjc0BzYW1iYS5vcmc+IDIwMTgKKyAqIENvcHlyaWdodCBTd2VuIFNjaGlsbGln
IDxzd2VuQGxpbnV4LmlibS5jb20+IDIwMTkKICAqCiAgKiBUaGlzIHByb2dyYW0gaXMgZnJlZSBz
b2Z0d2FyZTsgeW91IGNhbiByZWRpc3RyaWJ1dGUgaXQgYW5kL29yIG1vZGlmeQogICogaXQgdW5k
ZXIgdGhlIHRlcm1zIG9mIHRoZSBHTlUgR2VuZXJhbCBQdWJsaWMgTGljZW5zZSBhcyBwdWJsaXNo
ZWQgYnkKQEAgLTQyMSw2ICs0MjIsMzEgQEAgZG9uZToKIAlyZXR1cm4gcmV0OwogfQogCitzdGF0
aWMgYm9vbCB0ZXN0X3N0cnRvdWxfZXJyX2Vycm5vX2NoZWNrKHN0cnVjdCB0b3J0dXJlX2NvbnRl
eHQgKnRjdHgpCit7CisJY29uc3QgY2hhciAqbnVtYmVyID0gIjEyMyI7CisJdW5zaWduZWQgbG9u
ZyBpbnQgdmFsID0gMDsKKwl1bnNpZ25lZCBsb25nIGxvbmcgaW50IHZhbGwgPSAwOworCWludCBl
cnI7CisKKwkvKiBzZWxlY3QgYW4gZXJyb3IgY29kZSB3aGljaCBpcyBub3Qgc2V0IGJ5IHRoZSBz
dHJ0b3VsX2VyciByb3V0aW5lcyAqLworCWVycm5vID0gRUFHQUlOOworCWVyciA9IEVBR0FJTjsK
Kwl2YWwgPSBzdHJ0b3VsX2VycihudW1iZXIsIE5VTEwsIDAsICZlcnIpOworCXRvcnR1cmVfYXNz
ZXJ0KHRjdHgsIGVycm5vID09IEVBR0FJTiwgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCBFQUdBSU4i
KTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxfZXJyOiBFeHBlY3Rl
ZCBlcnIgPSAwIik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgdmFsID09IDEyMywgInN0cnRvdWxf
ZXJyOiBFeHBlY3RlZCB2YWx1ZSAxMjMiKTsKKworCS8qIHNldCBlcnIgdG8gYW4gaW1wb3NzaWJs
ZSB2YWx1ZSBhZ2FpbiBiZWZvcmUgY29udGludWluZyAqLworCWVyciA9IEVBR0FJTjsKKwl2YWxs
ID0gc3RydG91bGxfZXJyKG51bWJlciwgTlVMTCwgMCwgJmVycik7CisJdG9ydHVyZV9hc3NlcnQo
dGN0eCwgZXJybm8gPT0gRUFHQUlOLCAic3RydG91bGxfZXJyOiBFeHBlY3RlZCBFQUdBSU4iKTsK
Kwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCBl
cnIgPSAwIik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgdmFsbCA9PSAxMjMsICJzdHJ0b3VsX2Vy
cjogRXhwZWN0ZWQgdmFsdWUgMTIzIik7CisKKwlyZXR1cm4gdHJ1ZTsKK30KKwogc3RydWN0IHRv
cnR1cmVfc3VpdGUgKnRvcnR1cmVfbG9jYWxfdXRpbChUQUxMT0NfQ1RYICptZW1fY3R4KQogewog
CXN0cnVjdCB0b3J0dXJlX3N1aXRlICpzdWl0ZSA9CkBAIC00MzIsNSArNDU4LDggQEAgc3RydWN0
IHRvcnR1cmVfc3VpdGUgKnRvcnR1cmVfbG9jYWxfdXRpbChUQUxMT0NfQ1RYICptZW1fY3R4KQog
CXRvcnR1cmVfc3VpdGVfYWRkX3NpbXBsZV90ZXN0KHN1aXRlLAogCQkJCSAgICAgICJkaXJlY3Rv
cnlfY3JlYXRlX29yX2V4aXN0IiwKIAkJCQkgICAgICB0ZXN0X2RpcmVjdG9yeV9jcmVhdGVfb3Jf
ZXhpc3QpOworCXRvcnR1cmVfc3VpdGVfYWRkX3NpbXBsZV90ZXN0KHN1aXRlLAorCQkJCSAgICAg
ICJzdHJ0b3VsKGwpX2VyciBlcnJubyIsCisJCQkJICAgICAgdGVzdF9zdHJ0b3VsX2Vycl9lcnJu
b19jaGVjayk7CiAJcmV0dXJuIHN1aXRlOwogfQotLSAKMi4yMC4xCgoKRnJvbSAyYjY2OWI3MzQ3
NDc2NjRjMjBhMjcwMTRhNjc2ZDI1ZTdmZDNmZjkwIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpG
cm9tOiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+CkRhdGU6IFdlZCwgMTAgQXBy
IDIwMTkgMTA6NDQ6MDYgKzAyMDAKU3ViamVjdDogW1BBVENIIDAyLzE2XSB0ZXN0cy11dGlsOiBB
ZGRpbmcgdGVzdCB0byB2ZXJpZnkgbmVnYXRpdmUgIm51bWJlciIKIGRldGVjdGlvbgoKVmVyaWZ5
IHRoYXQgYSBzdHJpbmcgcmVwcmVzZW50aW5nIGEgbmVnYXRpdmUgbnVtYmVyIGlzIHRocm93aW5n
IGFuIGVycm9yLgoKU2lnbmVkLW9mZi1ieTogU3dlbiBTY2hpbGxpZyA8c3dlbkBsaW51eC5pYm0u
Y29tPgotLS0KIGxpYi91dGlsL3Rlc3RzL3V0aWwuYyB8IDM3ICsrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAzNyBpbnNlcnRpb25zKCspCgpkaWZm
IC0tZ2l0IGEvbGliL3V0aWwvdGVzdHMvdXRpbC5jIGIvbGliL3V0aWwvdGVzdHMvdXRpbC5jCmlu
ZGV4IDNmNTljZTZmNmRjLi5jNDVmMzgzNWNmNyAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdGVzdHMv
dXRpbC5jCisrKyBiL2xpYi91dGlsL3Rlc3RzL3V0aWwuYwpAQCAtNDQ3LDYgKzQ0Nyw0MCBAQCBz
dGF0aWMgYm9vbCB0ZXN0X3N0cnRvdWxfZXJyX2Vycm5vX2NoZWNrKHN0cnVjdCB0b3J0dXJlX2Nv
bnRleHQgKnRjdHgpCiAJcmV0dXJuIHRydWU7CiB9CiAKK3N0YXRpYyBib29sIHRlc3Rfc3RydG91
bF9lcnJfbmVnYXRpdmUoc3RydWN0IHRvcnR1cmVfY29udGV4dCAqdGN0eCkKK3sKKwljb25zdCBj
aGFyICpudW1iZXIgPSAiLTEzMiI7CisJY29uc3QgY2hhciAqbnVtYmVyMiA9ICIxMzItIjsKKwl1
bnNpZ25lZCBsb25nIGludCB2YWwgPSAwOworCXVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgdmFsbCA9
IDA7CisJaW50IGVycjsKKworCWVyciA9IDA7CisJc3RydG91bF9lcnIobnVtYmVyLCBOVUxMLCAw
LCAmZXJyKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic3RydG91bF9l
cnI6IEV4cGVjdGVkIEVJTlZBTCIpOworCisJZXJyID0gMDsKKwlzdHJ0b3VsbF9lcnIobnVtYmVy
LCBOVUxMLCAwLCAmZXJyKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAi
c3RydG91bGxfZXJyOiBFeHBlY3RlZCBFSU5WQUwiKTsKKworCS8qIGl0IGlzIGFsbG93ZWQgdG8g
aGF2ZSBhICItIiBzaWduIGFmdGVyIGEgbnVtYmVyLAorCSAqIGUuZy4gYXMgcGFydCBvZiBhIGZv
cm11bGFyLCBob3dldmVyLCBpdCBpcyBub3Qgc3VwcG9zZWQgdG8KKwkgKiBoYXZlIGFuIGVmZmVj
dCBvbiB0aGUgY29udmVydGVkIHZhbHVlLgorCSAqLworCisJZXJyID0gMDsKKwl2YWwgPSBzdHJ0
b3VsX2VycihudW1iZXIyLCBOVUxMLCAwLCAmZXJyKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBl
cnIgPT0gMCwgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCBubyBlcnJvciIpOworCXRvcnR1cmVfYXNz
ZXJ0KHRjdHgsIHZhbCA9PSAxMzIsICJzdHJ0b3VsX2VycjogV3JvbmcgdmFsdWUiKTsKKworCWVy
ciA9IDA7CisJdmFsbCA9IHN0cnRvdWxsX2VycihudW1iZXIyLCBOVUxMLCAwLCAmZXJyKTsKKwl0
b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxsX2VycjogRXhwZWN0ZWQgbm8g
ZXJyb3IiKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCB2YWxsID09IDEzMiwgInN0cnRvdWxsX2Vy
cjogV3JvbmcgdmFsdWUiKTsKKworCXJldHVybiB0cnVlOworfQorCiBzdHJ1Y3QgdG9ydHVyZV9z
dWl0ZSAqdG9ydHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1lbV9jdHgpCiB7CiAJc3RydWN0
IHRvcnR1cmVfc3VpdGUgKnN1aXRlID0KQEAgLTQ2MSw1ICs0OTUsOCBAQCBzdHJ1Y3QgdG9ydHVy
ZV9zdWl0ZSAqdG9ydHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1lbV9jdHgpCiAJdG9ydHVy
ZV9zdWl0ZV9hZGRfc2ltcGxlX3Rlc3Qoc3VpdGUsCiAJCQkJICAgICAgInN0cnRvdWwobClfZXJy
IGVycm5vIiwKIAkJCQkgICAgICB0ZXN0X3N0cnRvdWxfZXJyX2Vycm5vX2NoZWNrKTsKKwl0b3J0
dXJlX3N1aXRlX2FkZF9zaW1wbGVfdGVzdChzdWl0ZSwKKwkJCQkgICAgICAic3RydG91bChsKV9l
cnIgbmVnYXRpdmUiLAorCQkJCSAgICAgIHRlc3Rfc3RydG91bF9lcnJfbmVnYXRpdmUpOwogCXJl
dHVybiBzdWl0ZTsKIH0KLS0gCjIuMjAuMQoKCkZyb20gYzdmNGU0OWM0N2UxMjg2YjY3ZjYyMTJk
ODFlOTk3MDMxOGYwMTA4YyBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogU3dlbiBTY2hp
bGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgpEYXRlOiBXZWQsIDEwIEFwciAyMDE5IDEwOjUyOjM1
ICswMjAwClN1YmplY3Q6IFtQQVRDSCAwMy8xNl0gdGVzdHMtdXRpbDogQWRkaW5nIHRlc3QgdG8g
dmVyaWZ5ICJuby1jb252ZXJzaW9uIgogZGV0ZWN0aW9uCgpUaGUgc3RhbmRhcmQgc3RyaW5nIHRv
IGludGVnZXIgY29udmVyc2lvbiByb3V0aW5lcyByZXR1cm4gemVybwppZiBhIHN0cmluZyB3YXMg
dG8gYmUgY29udmVydGVkIHdoaWNoIGRpZCBub3QgcmVmbGVjdCBhIG51bWJlci4KSXQgaXMgbm90
IGZsYWcnZWQgYXMgYW4gZXJyb3IuClRoZSB3cmFwcGVyIGZ1bmN0aW9ucyBzdHJ0b3VsX2Vycigp
IGFuZCBzdHJ0b3VsbF9lcnIoKSBhcmUgZXhwZWN0ZWQKdG8gZXhhY3RseSBkbyB0aGlzLgoKU2ln
bmVkLW9mZi1ieTogU3dlbiBTY2hpbGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgotLS0KIGxpYi91
dGlsL3Rlc3RzL3V0aWwuYyB8IDI4ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDEgZmls
ZSBjaGFuZ2VkLCAyOCBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvdGVzdHMv
dXRpbC5jIGIvbGliL3V0aWwvdGVzdHMvdXRpbC5jCmluZGV4IGM0NWYzODM1Y2Y3Li5kZTlkY2Ex
ZmZjNSAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdGVzdHMvdXRpbC5jCisrKyBiL2xpYi91dGlsL3Rl
c3RzL3V0aWwuYwpAQCAtNDgxLDYgKzQ4MSwzMSBAQCBzdGF0aWMgYm9vbCB0ZXN0X3N0cnRvdWxf
ZXJyX25lZ2F0aXZlKHN0cnVjdCB0b3J0dXJlX2NvbnRleHQgKnRjdHgpCiAJcmV0dXJuIHRydWU7
CiB9CiAKK3N0YXRpYyBib29sIHRlc3Rfc3RydG91bF9lcnJfbm9fbnVtYmVyKHN0cnVjdCB0b3J0
dXJlX2NvbnRleHQgKnRjdHgpCit7CisJY29uc3QgY2hhciAqbnVtYmVyID0gImdoaWprIjsKKwlj
b25zdCBjaGFyICpibGFuayA9ICIiOworCWludCBlcnI7CisKKwllcnIgPSAwOworCXN0cnRvdWxf
ZXJyKG51bWJlciwgTlVMTCwgMCwgJmVycik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgZXJyID09
IEVJTlZBTCwgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCBFSU5WQUwiKTsKKworCWVyciA9IDA7CisJ
c3RydG91bGxfZXJyKG51bWJlciwgTlVMTCwgMCwgJmVycik7CisJdG9ydHVyZV9hc3NlcnQodGN0
eCwgZXJyID09IEVJTlZBTCwgInN0cnRvdWxsX2VycjogRXhwZWN0ZWQgRUlOVkFMIik7CisKKwll
cnIgPSAwOworCXN0cnRvdWxfZXJyKGJsYW5rLCBOVUxMLCAwLCAmZXJyKTsKKwl0b3J0dXJlX2Fz
c2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic3RydG91bF9lcnI6IEV4cGVjdGVkIEVJTlZBTCIp
OworCisJZXJyID0gMDsKKwlzdHJ0b3VsbF9lcnIoYmxhbmssIE5VTEwsIDAsICZlcnIpOworCXRv
cnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSBFSU5WQUwsICJzdHJ0b3VsbF9lcnI6IEV4cGVjdGVk
IEVJTlZBTCIpOworCisJcmV0dXJuIHRydWU7Cit9CisKIHN0cnVjdCB0b3J0dXJlX3N1aXRlICp0
b3J0dXJlX2xvY2FsX3V0aWwoVEFMTE9DX0NUWCAqbWVtX2N0eCkKIHsKIAlzdHJ1Y3QgdG9ydHVy
ZV9zdWl0ZSAqc3VpdGUgPQpAQCAtNDk4LDUgKzUyMyw4IEBAIHN0cnVjdCB0b3J0dXJlX3N1aXRl
ICp0b3J0dXJlX2xvY2FsX3V0aWwoVEFMTE9DX0NUWCAqbWVtX2N0eCkKIAl0b3J0dXJlX3N1aXRl
X2FkZF9zaW1wbGVfdGVzdChzdWl0ZSwKIAkJCQkgICAgICAic3RydG91bChsKV9lcnIgbmVnYXRp
dmUiLAogCQkJCSAgICAgIHRlc3Rfc3RydG91bF9lcnJfbmVnYXRpdmUpOworCXRvcnR1cmVfc3Vp
dGVfYWRkX3NpbXBsZV90ZXN0KHN1aXRlLAorCQkJCSAgICAgICJzdHJ0b3VsKGwpX2VyciBubyBu
dW1iZXIiLAorCQkJCSAgICAgIHRlc3Rfc3RydG91bF9lcnJfbm9fbnVtYmVyKTsKIAlyZXR1cm4g
c3VpdGU7CiB9Ci0tIAoyLjIwLjEKCgpGcm9tIDQxYjI5OTUzZjY5NmZlZjMyY2FlMWUyNDQwZDM2
NWU5MTdkYWNmZWEgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcg
PHN3ZW5AbGludXguaWJtLmNvbT4KRGF0ZTogVGh1LCAxMSBBcHIgMjAxOSAxMToyMjowMiArMDIw
MApTdWJqZWN0OiBbUEFUQ0ggMDQvMTZdIGxpYjogUHJlcGFyZSBmb3Igc3RydG91bF9lcnIoKSwg
c3RydG91bGxfZXJyKCkgQVBJCiBjaGFuZ2UKCkluIG9yZGVyIHRvIHN0aWxsIGJlIGJpc2VjdGFi
bGUgd2hlbiBjaGFuZ2luZyB0aGUgQVBJIGZvciB0aGUgd3JhcHBlcnMKc3RydG91bF9lcnIoKSBh
bmQgc3RydG91bGxfZXJyKCkgc29tZSBwcmVwYXJhdGlvbnMgbmVlZCB0byBiZSBwZXJmb3JtZWQu
CgpTaWduZWQtb2ZmLWJ5OiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+Ci0tLQog
bGliL3V0aWwvdXRpbC5jIHwgMjYgKysrKysrKysrKysrKysrKy0tLS0tLS0tLS0KIGxpYi91dGls
L3V0aWwuaCB8IDEyICsrKysrKysrKystLQogMiBmaWxlcyBjaGFuZ2VkLCAyNiBpbnNlcnRpb25z
KCspLCAxMiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9saWIvdXRpbC91dGlsLmMgYi9saWIv
dXRpbC91dGlsLmMKaW5kZXggODNhZjE0Y2FjMWUuLjdhN2NiNGU4NzZiIDEwMDY0NAotLS0gYS9s
aWIvdXRpbC91dGlsLmMKKysrIGIvbGliL3V0aWwvdXRpbC5jCkBAIC01NSw2ICs1NSw3IEBACiAg
KiBAcGFyYW0gZW5kcHRyCVtvcHRpb25hbF0gcmVmZXJlbmNlIHRvIHJlbWFpbmRlciBvZiB0aGUg
c3RyaW5nCiAgKiBAcGFyYW0gYmFzZQkJYmFzZSBvZiB0aGUgbnVtYmVyaW5nIHNjaGVtZQogICog
QHBhcmFtIGVycgkJZXJyb3Igb2NjdXJlZCBkdXJpbmcgY29udmVyc2lvbgorICogQGZsYWdzCQlj
b250cm9sbGluZyBjb252ZXJzaW9uIGZlYXR1cmUKICAqIEByZXN1bHQJCXJlc3VsdCBvZiB0aGUg
Y29udmVyc2lvbiBhcyBwcm92aWRlZCBieSBzdHJ0b3VsCiAgKgogICogVGhlIGZvbGxvd2luZyBl
cnJvcnMgYXJlIGRldGVjdGVkCkBAIC02NCw3ICs2NSw3IEBACiAgKiAtIG5vIGNvbnZlcnNpb24g
ZHVlIHRvIGVtcHR5IHN0cmluZyBvciBub3QgcmVwcmVzZW50aW5nIGEgbnVtYmVyCiAgKi8KIHVu
c2lnbmVkIGxvbmcgaW50Ci1zdHJ0b3VsX2Vycihjb25zdCBjaGFyICpucHRyLCBjaGFyICoqZW5k
cHRyLCBpbnQgYmFzZSwgaW50ICplcnIpCitzbWJfc3RydG91bChjb25zdCBjaGFyICpucHRyLCBj
aGFyICoqZW5kcHRyLCBpbnQgYmFzZSwgaW50ICplcnIsIGludCBmbGFncykKIHsKIAl1bnNpZ25l
ZCBsb25nIGludCB2YWw7CiAJaW50IHNhdmVkX2Vycm5vID0gZXJybm87CkBAIC05MywxMCArOTQs
MTIgQEAgc3RydG91bF9lcnIoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVuZHB0ciwgaW50IGJh
c2UsIGludCAqZXJyKQogCQlyZXR1cm4gdmFsOwogCX0KIAotCS8qIGRpZCB3ZSBjb252ZXJ0IGEg
bmVnYXRpdmUgIm51bWJlciIgPyAqLwotCW5lZWRsZSA9IHN0cmNocihucHRyLCAnLScpOwotCWlm
IChuZWVkbGUgIT0gTlVMTCAmJiBuZWVkbGUgPCB0bXBfZW5kcHRyKSB7Ci0JCSplcnIgPSBFSU5W
QUw7CisJaWYgKChmbGFncyAmIFNNQl9TVFJfQUxMT1dfTkVHQVRJVkUgKSA9PSAwKSB7CisJCS8q
IGRpZCB3ZSBjb252ZXJ0IGEgbmVnYXRpdmUgIm51bWJlciIgPyAqLworCQluZWVkbGUgPSBzdHJj
aHIobnB0ciwgJy0nKTsKKwkJaWYgKG5lZWRsZSAhPSBOVUxMICYmIG5lZWRsZSA8IHRtcF9lbmRw
dHIpIHsKKwkJCSplcnIgPSBFSU5WQUw7CisJCX0KIAl9CiAKIAllcnJubyA9IHNhdmVkX2Vycm5v
OwpAQCAtMTEwLDYgKzExMyw3IEBAIHN0cnRvdWxfZXJyKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIg
KiplbmRwdHIsIGludCBiYXNlLCBpbnQgKmVycikKICAqIEBwYXJhbSBlbmRwdHIJW29wdGlvbmFs
XSByZWZlcmVuY2UgdG8gcmVtYWluZGVyIG9mIHRoZSBzdHJpbmcKICAqIEBwYXJhbSBiYXNlCQli
YXNlIG9mIHRoZSBudW1iZXJpbmcgc2NoZW1lCiAgKiBAcGFyYW0gZXJyCQllcnJvciBvY2N1cmVk
IGR1cmluZyBjb252ZXJzaW9uCisgKiBAZmxhZ3MJCWNvbnRyb2xsaW5nIGNvbnZlcnNpb24gZmVh
dHVyZQogICogQHJlc3VsdAkJcmVzdWx0IG9mIHRoZSBjb252ZXJzaW9uIGFzIHByb3ZpZGVkIGJ5
IHN0cnRvdWxsCiAgKgogICogVGhlIGZvbGxvd2luZyBlcnJvcnMgYXJlIGRldGVjdGVkCkBAIC0x
MTksNyArMTIzLDcgQEAgc3RydG91bF9lcnIoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVuZHB0
ciwgaW50IGJhc2UsIGludCAqZXJyKQogICogLSBubyBjb252ZXJzaW9uIGR1ZSB0byBlbXB0eSBz
dHJpbmcgb3Igbm90IHJlcHJlc2VudGluZyBhIG51bWJlcgogICovCiB1bnNpZ25lZCBsb25nIGxv
bmcgaW50Ci1zdHJ0b3VsbF9lcnIoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVuZHB0ciwgaW50
IGJhc2UsIGludCAqZXJyKQorc21iX3N0cnRvdWxsKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKipl
bmRwdHIsIGludCBiYXNlLCBpbnQgKmVyciwgaW50IGZsYWdzKQogewogCXVuc2lnbmVkIGxvbmcg
bG9uZyBpbnQgdmFsOwogCWludCBzYXZlZF9lcnJubyA9IGVycm5vOwpAQCAtMTQ4LDEwICsxNTIs
MTIgQEAgc3RydG91bGxfZXJyKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBi
YXNlLCBpbnQgKmVycikKIAkJcmV0dXJuIHZhbDsKIAl9CiAKLQkvKiBkaWQgd2UgY29udmVydCBh
IG5lZ2F0aXZlICJudW1iZXIiID8gKi8KLQluZWVkbGUgPSBzdHJjaHIobnB0ciwgJy0nKTsKLQlp
ZiAobmVlZGxlICE9IE5VTEwgJiYgbmVlZGxlIDwgdG1wX2VuZHB0cikgewotCQkqZXJyID0gRUlO
VkFMOworCWlmICgoZmxhZ3MgJiBTTUJfU1RSX0FMTE9XX05FR0FUSVZFICkgPT0gMCkgeworCQkv
KiBkaWQgd2UgY29udmVydCBhIG5lZ2F0aXZlICJudW1iZXIiID8gKi8KKwkJbmVlZGxlID0gc3Ry
Y2hyKG5wdHIsICctJyk7CisJCWlmIChuZWVkbGUgIT0gTlVMTCAmJiBuZWVkbGUgPCB0bXBfZW5k
cHRyKSB7CisJCQkqZXJyID0gRUlOVkFMOworCQl9CiAJfQogCiAJZXJybm8gPSBzYXZlZF9lcnJu
bzsKZGlmZiAtLWdpdCBhL2xpYi91dGlsL3V0aWwuaCBiL2xpYi91dGlsL3V0aWwuaAppbmRleCBm
Y2Q4MTc1OWI5Yy4uMWExZTM5NzM5NDEgMTAwNjQ0Ci0tLSBhL2xpYi91dGlsL3V0aWwuaAorKysg
Yi9saWIvdXRpbC91dGlsLmgKQEAgLTMsNiArMyw3IEBACiAgICBVdGlsaXR5IGZ1bmN0aW9ucyBm
b3IgU2FtYmEKICAgIENvcHlyaWdodCAoQykgQW5kcmV3IFRyaWRnZWxsIDE5OTItMTk5OQogICAg
Q29weXJpZ2h0IChDKSBKZWxtZXIgVmVybm9vaWogMjAwNQorICAgQ29weXJpZ2h0IChDKSBTd2Vu
IFNjaGlsbGlnIDIwMTkKICAgICAKICAgIFRoaXMgcHJvZ3JhbSBpcyBmcmVlIHNvZnR3YXJlOyB5
b3UgY2FuIHJlZGlzdHJpYnV0ZSBpdCBhbmQvb3IgbW9kaWZ5CiAgICBpdCB1bmRlciB0aGUgdGVy
bXMgb2YgdGhlIEdOVSBHZW5lcmFsIFB1YmxpYyBMaWNlbnNlIGFzIHB1Ymxpc2hlZCBieQpAQCAt
MjEsMTIgKzIyLDE5IEBACiAjaWZuZGVmIF9fVVRJTF9TQU1CQV9VVElMX0hfXwogI2RlZmluZSBf
X1VUSUxfU0FNQkFfVVRJTF9IX18KIAorI2RlZmluZSBTTUJfU1RSX1NUQU5EQVJEICAweDAwCisj
ZGVmaW5lIFNNQl9TVFJfQUxMT1dfTkVHQVRJVkUgMHgwMQorCiB1bnNpZ25lZCBsb25nIGludAot
c3RydG91bF9lcnIoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVuZHB0ciwgaW50IGJhc2UsIGlu
dCAqZXJyKTsKK3NtYl9zdHJ0b3VsKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGlu
dCBiYXNlLCBpbnQgKmVyciwgaW50IGZsYWdzKTsKIAogdW5zaWduZWQgbG9uZyBsb25nIGludAot
c3RydG91bGxfZXJyKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBiYXNlLCBp
bnQgKmVycik7CitzbWJfc3RydG91bGwoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVuZHB0ciwg
aW50IGJhc2UsIGludCAqZXJyLCBpbnQgZmxhZ3MpOwogCisjZGVmaW5lIHN0cnRvdWxfZXJyKG5w
dHIsIGVuZHB0ciwgYmFzZSwgZXJyKSBcCisJc21iX3N0cnRvdWwobnB0ciwgZW5kcHRyLCBiYXNl
LCBlcnIsIFNNQl9TVFJfU1RBTkRBUkQpCisjZGVmaW5lIHN0cnRvdWxsX2VycihucHRyLCBlbmRw
dHIsIGJhc2UsIGVycikgXAorCXNtYl9zdHJ0b3VsbChucHRyLCBlbmRwdHIsIGJhc2UsIGVyciwg
U01CX1NUUl9TVEFOREFSRCkKIAogLyoqCiAgKiBXcml0ZSBkdW1wIG9mIGJpbmFyeSBkYXRhIHRv
IGEgY2FsbGJhY2sKLS0gCjIuMjAuMQoKCkZyb20gYWZmYzQwMzQxMTc3MDdhY2Y5MjkzMDhhMzYw
MDA1MWQ4MzQzMjZiOSBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogU3dlbiBTY2hpbGxp
ZyA8c3dlbkBsaW51eC5pYm0uY29tPgpEYXRlOiBUaHUsIDExIEFwciAyMDE5IDE0OjQyOjM3ICsw
MjAwClN1YmplY3Q6IFtQQVRDSCAwNS8xNl0gbGliOiBBZGQgY2hlY2sgZm9yIGZ1bGwgc3RyaW5n
IGNvbnN1bXB0aW9uIHdoZW4KIGNvbnZlcnRpbmcgc3RyaW5nIHRvIGludAoKU29tZSBjYWxsZXJz
IHdhbnQgdG8gaGF2ZSB0aGUgZW50aXJlIHN0cmluZyBiZWluZyB1c2VkIGZvciBhCnN0cmluZyB0
byBpbnRlZ2VyIGNvbnZlcnNpb24sIG90aGVyd2lzZSBmbGFnIGFuIGVycm9yLgpUaGlzIGlzIHBv
c3NpYmxlIGJ5IHByb3ZpZGluZyB0aGUgU0FNQkFfU1RSX0ZVTExfU1RSX0NPTlYgZmxhZy4KClNp
Z25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KLS0tCiBsaWIv
dXRpbC91dGlsLmMgfCAyMCArKysrKysrKysrKysrKysrKysrKwogbGliL3V0aWwvdXRpbC5oIHwg
IDEgKwogMiBmaWxlcyBjaGFuZ2VkLCAyMSBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvbGli
L3V0aWwvdXRpbC5jIGIvbGliL3V0aWwvdXRpbC5jCmluZGV4IDdhN2NiNGU4NzZiLi42NjMxMWMz
OTg4MSAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdXRpbC5jCisrKyBiL2xpYi91dGlsL3V0aWwuYwpA
QCAtOTksOSArOTksMTkgQEAgc21iX3N0cnRvdWwoY29uc3QgY2hhciAqbnB0ciwgY2hhciAqKmVu
ZHB0ciwgaW50IGJhc2UsIGludCAqZXJyLCBpbnQgZmxhZ3MpCiAJCW5lZWRsZSA9IHN0cmNocihu
cHRyLCAnLScpOwogCQlpZiAobmVlZGxlICE9IE5VTEwgJiYgbmVlZGxlIDwgdG1wX2VuZHB0cikg
ewogCQkJKmVyciA9IEVJTlZBTDsKKwkJCWdvdG8gb3V0OwogCQl9CiAJfQogCisJaWYgKChmbGFn
cyAmIFNNQl9TVFJfRlVMTF9TVFJfQ09OVikgIT0gMCkgeworCQkvKiBkaWQgd2UgY29udmVydCB0
aGUgZW50aXJlIHN0cmluZyA/ICovCisJCWlmICh0bXBfZW5kcHRyWzBdICE9ICdcMCcpIHsKKwkJ
CSplcnIgPSBFSU5WQUw7CisJCQlnb3RvIG91dDsKKwkJfQorCX0KKworb3V0OgogCWVycm5vID0g
c2F2ZWRfZXJybm87CiAJcmV0dXJuIHZhbDsKIH0KQEAgLTE1Nyw5ICsxNjcsMTkgQEAgc21iX3N0
cnRvdWxsKGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBiYXNlLCBpbnQgKmVy
ciwgaW50IGZsYWdzKQogCQluZWVkbGUgPSBzdHJjaHIobnB0ciwgJy0nKTsKIAkJaWYgKG5lZWRs
ZSAhPSBOVUxMICYmIG5lZWRsZSA8IHRtcF9lbmRwdHIpIHsKIAkJCSplcnIgPSBFSU5WQUw7CisJ
CQlnb3RvIG91dDsKKwkJfQorCX0KKworCWlmICgoZmxhZ3MgJiBTTUJfU1RSX0ZVTExfU1RSX0NP
TlYpICE9IDApIHsKKwkJLyogZGlkIHdlIGNvbnZlcnQgdGhlIGVudGlyZSBzdHJpbmcgPyAqLwor
CQlpZiAodG1wX2VuZHB0clswXSAhPSAnXDAnKSB7CisJCQkqZXJyID0gRUlOVkFMOworCQkJZ290
byBvdXQ7CiAJCX0KIAl9CiAKK291dDoKIAllcnJubyA9IHNhdmVkX2Vycm5vOwogCXJldHVybiB2
YWw7CiB9CmRpZmYgLS1naXQgYS9saWIvdXRpbC91dGlsLmggYi9saWIvdXRpbC91dGlsLmgKaW5k
ZXggMWExZTM5NzM5NDEuLjFlZDc1ZTAyYzE4IDEwMDY0NAotLS0gYS9saWIvdXRpbC91dGlsLmgK
KysrIGIvbGliL3V0aWwvdXRpbC5oCkBAIC0yNCw2ICsyNCw3IEBACiAKICNkZWZpbmUgU01CX1NU
Ul9TVEFOREFSRCAgMHgwMAogI2RlZmluZSBTTUJfU1RSX0FMTE9XX05FR0FUSVZFIDB4MDEKKyNk
ZWZpbmUgU01CX1NUUl9GVUxMX1NUUl9DT05WICAweDAyCiAKIHVuc2lnbmVkIGxvbmcgaW50CiBz
bWJfc3RydG91bChjb25zdCBjaGFyICpucHRyLCBjaGFyICoqZW5kcHRyLCBpbnQgYmFzZSwgaW50
ICplcnIsIGludCBmbGFncyk7Ci0tIAoyLjIwLjEKCgpGcm9tIGVjZTU4MDY2NGNlOGUxYzM4Y2Zl
Y2JmMTA4ZjA1OGJlODNkNzQwN2YgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFN3ZW4g
U2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KRGF0ZTogVGh1LCAxMSBBcHIgMjAxOSAxNDo0
Njo0OSArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDYvMTZdIGxpYjogQWRkIGNhcGFiaWxpdHkgdG8g
ZW5hYmxlIHN0YW5kYXJkIGdsaWJjIGJlaGF2aW91cgogZm9yIHN0cmluZyB0byBpbnQgY29udmVy
c2lvbgoKQWRkaW5nIHR3byBhZGR0bC4gZmxhZ3MgU0FNQkFfU1RSX0FMTE9XX05PX0NPTlZFUlNJ
T04gYW5kIFNBTUJBX1NUUl9HTElCQ19TVEFOREFSRApmb3IgdGhlIHdyYXBwZXJzIHN0cnRvdWxf
ZXJyKCkgYW5kIHN0cnRvdWxsX2VycigpIHByb3ZpZGluZyB0aGUgcG9zc2liaWxpdHkKdG8gZ2V0
IHN0YW5kYXJkIGdsaWJjIGJlaGF2aW91ciBmb3Igc3RyaW5nIHRvIGludGVnZXIgY29udmVyc2lv
bi4KClNpZ25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KLS0t
CiBsaWIvdXRpbC91dGlsLmMgfCAyMiArKysrKysrKysrKystLS0tLS0tLS0tCiBsaWIvdXRpbC91
dGlsLmggfCAgMyArKysKIDIgZmlsZXMgY2hhbmdlZCwgMTUgaW5zZXJ0aW9ucygrKSwgMTAgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvdXRpbC5jIGIvbGliL3V0aWwvdXRpbC5j
CmluZGV4IDY2MzExYzM5ODgxLi5iMTJiMzdhZTAxOSAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdXRp
bC5jCisrKyBiL2xpYi91dGlsL3V0aWwuYwpAQCAtODcsMTEgKzg3LDEyIEBAIHNtYl9zdHJ0b3Vs
KGNvbnN0IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBiYXNlLCBpbnQgKmVyciwgaW50
IGZsYWdzKQogCQlyZXR1cm4gdmFsOwogCX0KIAotCS8qIGdvdCBhbiBpbnZhbGlkIG51bWJlci1z
dHJpbmcgcmVzdWx0aW5nIGluIG5vIGNvbnZlcnNpb24gKi8KLQlpZiAobnB0ciA9PSB0bXBfZW5k
cHRyKSB7Ci0JCSplcnIgPSBFSU5WQUw7Ci0JCWVycm5vID0gc2F2ZWRfZXJybm87Ci0JCXJldHVy
biB2YWw7CisJaWYgKChmbGFncyAmIFNNQl9TVFJfQUxMT1dfTk9fQ09OVkVSU0lPTikgPT0gMCkg
eworCQkvKiBnb3QgYW4gaW52YWxpZCBudW1iZXItc3RyaW5nIHJlc3VsdGluZyBpbiBubyBjb252
ZXJzaW9uICovCisJCWlmIChucHRyID09IHRtcF9lbmRwdHIpIHsKKwkJCSplcnIgPSBFSU5WQUw7
CisJCQlnb3RvIG91dDsKKwkJfQogCX0KIAogCWlmICgoZmxhZ3MgJiBTTUJfU1RSX0FMTE9XX05F
R0FUSVZFICkgPT0gMCkgewpAQCAtMTU1LDExICsxNTYsMTIgQEAgc21iX3N0cnRvdWxsKGNvbnN0
IGNoYXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBiYXNlLCBpbnQgKmVyciwgaW50IGZsYWdz
KQogCQlyZXR1cm4gdmFsOwogCX0KIAotCS8qIGdvdCBhbiBpbnZhbGlkIG51bWJlci1zdHJpbmcg
cmVzdWx0aW5nIGluIG5vIGNvbnZlcnNpb24gKi8KLQlpZiAobnB0ciA9PSB0bXBfZW5kcHRyKSB7
Ci0JCSplcnIgPSBFSU5WQUw7Ci0JCWVycm5vID0gc2F2ZWRfZXJybm87Ci0JCXJldHVybiB2YWw7
CisJaWYgKChmbGFncyAmIFNNQl9TVFJfQUxMT1dfTk9fQ09OVkVSU0lPTikgPT0gMCkgeworCQkv
KiBnb3QgYW4gaW52YWxpZCBudW1iZXItc3RyaW5nIHJlc3VsdGluZyBpbiBubyBjb252ZXJzaW9u
ICovCisJCWlmIChucHRyID09IHRtcF9lbmRwdHIpIHsKKwkJCSplcnIgPSBFSU5WQUw7CisJCQln
b3RvIG91dDsKKwkJfQogCX0KIAogCWlmICgoZmxhZ3MgJiBTTUJfU1RSX0FMTE9XX05FR0FUSVZF
ICkgPT0gMCkgewpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvdXRpbC5oIGIvbGliL3V0aWwvdXRpbC5o
CmluZGV4IDFlZDc1ZTAyYzE4Li5kNjVkOGM5ZmYyNCAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdXRp
bC5oCisrKyBiL2xpYi91dGlsL3V0aWwuaApAQCAtMjUsNiArMjUsOSBAQAogI2RlZmluZSBTTUJf
U1RSX1NUQU5EQVJEICAweDAwCiAjZGVmaW5lIFNNQl9TVFJfQUxMT1dfTkVHQVRJVkUgMHgwMQog
I2RlZmluZSBTTUJfU1RSX0ZVTExfU1RSX0NPTlYgIDB4MDIKKyNkZWZpbmUgU01CX1NUUl9BTExP
V19OT19DT05WRVJTSU9OIDB4MDQKKyNkZWZpbmUgU01CX1NUUl9HTElCQ19TVEFOREFSRCAoU01C
X1NUUl9BTExPV19OT19DT05WRVJTSU9OIHwgXAorCQkJCVNNQl9TVFJfQUxMT1dfTkVHQVRJVkUp
CiAKIHVuc2lnbmVkIGxvbmcgaW50CiBzbWJfc3RydG91bChjb25zdCBjaGFyICpucHRyLCBjaGFy
ICoqZW5kcHRyLCBpbnQgYmFzZSwgaW50ICplcnIsIGludCBmbGFncyk7Ci0tIAoyLjIwLjEKCgpG
cm9tIDkyZDUyMWYxYTEzYzJkOTllODZjYjAwMTgxMjBiM2IxZGQxNWE3MTQgTW9uIFNlcCAxNyAw
MDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KRGF0
ZTogRnJpLCAxMiBBcHIgMjAxOSAxNjo1ODoxMyArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDcvMTZd
IGN0ZGI6IFVwZGF0ZSBhbGwgY29uc3VtZXJzIG9mIHN0cnRvdWxfZXJyKCksCiBzdHJ0b3VsbF9l
cnIoKSB0byBuZXcgQVBJCgpTaWduZWQtb2ZmLWJ5OiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4
LmlibS5jb20+Ci0tLQogY3RkYi9wcm90b2NvbC9wcm90b2NvbF91dGlsLmMgICAgICB8IDEwICsr
KystLS0tLS0KIGN0ZGIvc2VydmVyL2N0ZGJfcmVjb3ZlcnlfaGVscGVyLmMgfCAgNiArKysrKy0K
IGN0ZGIvdG9vbHMvY3RkYi5jICAgICAgICAgICAgICAgICAgfCAzMCArKysrKysrKysrKysrKysr
KysrKystLS0tLS0tLS0KIDMgZmlsZXMgY2hhbmdlZCwgMzAgaW5zZXJ0aW9ucygrKSwgMTYgZGVs
ZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvY3RkYi9wcm90b2NvbC9wcm90b2NvbF91dGlsLmMgYi9j
dGRiL3Byb3RvY29sL3Byb3RvY29sX3V0aWwuYwppbmRleCBkMTIwMjEzYjcwYS4uNjM2MjliYWI5
NGYgMTAwNjQ0Ci0tLSBhL2N0ZGIvcHJvdG9jb2wvcHJvdG9jb2xfdXRpbC5jCisrKyBiL2N0ZGIv
cHJvdG9jb2wvcHJvdG9jb2xfdXRpbC5jCkBAIC0yNjksNyArMjY5LDYgQEAgaW50IGN0ZGJfc29j
a19hZGRyX2Zyb21fc3RyaW5nKGNvbnN0IGNoYXIgKnN0ciwKIAljaGFyICpwOwogCWNoYXIgc1s2
NF07IC8qIE11Y2ggbG9uZ2VyIHRoYW4gSU5FVDZfQUREUlNUUkxFTiAqLwogCXVuc2lnbmVkIHBv
cnQ7Ci0JY2hhciAqZW5kcCA9IE5VTEw7CiAJc2l6ZV90IGxlbjsKIAlpbnQgcmV0OwogCkBAIC0y
OTAsOCArMjg5LDggQEAgaW50IGN0ZGJfc29ja19hZGRyX2Zyb21fc3RyaW5nKGNvbnN0IGNoYXIg
KnN0ciwKIAkJcmV0dXJuIEVJTlZBTDsKIAl9CiAKLQlwb3J0ID0gc3RydG91bF9lcnIocCsxLCAm
ZW5kcCwgMTAsICZyZXQpOwotCWlmIChyZXQgIT0gMCB8fCAqZW5kcCAhPSAnXDAnKSB7CisJcG9y
dCA9IHNtYl9zdHJ0b3VsKHArMSwgTlVMTCwgMTAsICZyZXQsIFNNQl9TVFJfRlVMTF9TVFJfQ09O
Vik7CisJaWYgKHJldCAhPSAwKSB7CiAJCS8qIEVtcHR5IHN0cmluZyBvciB0cmFpbGluZyBnYXJi
YWdlICovCiAJCXJldHVybiBFSU5WQUw7CiAJfQpAQCAtMzExLDcgKzMxMCw2IEBAIGludCBjdGRi
X3NvY2tfYWRkcl9tYXNrX2Zyb21fc3RyaW5nKGNvbnN0IGNoYXIgKnN0ciwKIAljaGFyICpwOwog
CWNoYXIgc1s2NF07IC8qIE11Y2ggbG9uZ2VyIHRoYW4gSU5FVDZfQUREUlNUUkxFTiAqLwogCXVu
c2lnbmVkIGludCBtOwotCWNoYXIgKmVuZHAgPSBOVUxMOwogCXNzaXplX3QgbGVuOwogCWludCBy
ZXQgPSAwOwogCkBAIC0zMjksOCArMzI3LDggQEAgaW50IGN0ZGJfc29ja19hZGRyX21hc2tfZnJv
bV9zdHJpbmcoY29uc3QgY2hhciAqc3RyLAogCQlyZXR1cm4gRUlOVkFMOwogCX0KIAotCW0gPSBz
dHJ0b3VsX2VycihwKzEsICZlbmRwLCAxMCwgJnJldCk7Ci0JaWYgKHJldCAhPSAwIHx8ICplbmRw
ICE9ICdcMCcpIHsKKwltID0gc21iX3N0cnRvdWwocCsxLCBOVUxMLCAxMCwgJnJldCwgU01CX1NU
Ul9GVUxMX1NUUl9DT05WKTsKKwlpZiAocmV0ICE9IDApIHsKIAkJLyogRW1wdHkgc3RyaW5nIG9y
IHRyYWlsaW5nIGdhcmJhZ2UgKi8KIAkJcmV0dXJuIEVJTlZBTDsKIAl9CmRpZmYgLS1naXQgYS9j
dGRiL3NlcnZlci9jdGRiX3JlY292ZXJ5X2hlbHBlci5jIGIvY3RkYi9zZXJ2ZXIvY3RkYl9yZWNv
dmVyeV9oZWxwZXIuYwppbmRleCBlZWQ3MWRhNWRmOC4uMTYxYWVhNTgzNTggMTAwNjQ0Ci0tLSBh
L2N0ZGIvc2VydmVyL2N0ZGJfcmVjb3ZlcnlfaGVscGVyLmMKKysrIGIvY3RkYi9zZXJ2ZXIvY3Rk
Yl9yZWNvdmVyeV9oZWxwZXIuYwpAQCAtMjc1MSw3ICsyNzUxLDExIEBAIGludCBtYWluKGludCBh
cmdjLCBjaGFyICphcmd2W10pCiAKIAl3cml0ZV9mZCA9IGF0b2koYXJndlsxXSk7CiAJc29ja3Bh
dGggPSBhcmd2WzJdOwotCWdlbmVyYXRpb24gPSAodWludDMyX3Qpc3RydG91bF9lcnIoYXJndlsz
XSwgTlVMTCwgMCwgJnJldCk7CisJZ2VuZXJhdGlvbiA9ICh1aW50MzJfdClzbWJfc3RydG91bChh
cmd2WzNdLAorCQkJCQkgICBOVUxMLAorCQkJCQkgICAwLAorCQkJCQkgICAmcmV0LAorCQkJCQkg
ICBTTUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAocmV0ICE9IDApIHsKIAkJZnByaW50ZihzdGRlcnIs
ICJyZWNvdmVyeTogdW5hYmxlIHRvIGluaXRpYWxpemUgZ2VuZXJhdGlvblxuIik7CiAJCWdvdG8g
ZmFpbGVkOwpkaWZmIC0tZ2l0IGEvY3RkYi90b29scy9jdGRiLmMgYi9jdGRiL3Rvb2xzL2N0ZGIu
YwppbmRleCAzYzYxYzU0MmVjNC4uNzNkODA5ODM4ODUgMTAwNjQ0Ci0tLSBhL2N0ZGIvdG9vbHMv
Y3RkYi5jCisrKyBiL2N0ZGIvdG9vbHMvY3RkYi5jCkBAIC0zMjYsNyArMzI2LDExIEBAIHN0YXRp
YyBib29sIHBhcnNlX25vZGVzdHJpbmcoVEFMTE9DX0NUWCAqbWVtX2N0eCwgc3RydWN0IGN0ZGJf
Y29udGV4dCAqY3RkYiwKIAkJd2hpbGUgKHRvayAhPSBOVUxMKSB7CiAJCQl1aW50MzJfdCBwbm47
CiAKLQkJCXBubiA9ICh1aW50MzJfdClzdHJ0b3VsX2Vycih0b2ssIE5VTEwsIDAsICZlcnJvcik7
CisJCQlwbm4gPSAodWludDMyX3Qpc21iX3N0cnRvdWwodG9rLAorCQkJCQkJICAgIE5VTEwsCisJ
CQkJCQkgICAgMCwKKwkJCQkJCSAgICAmZXJyb3IsCisJCQkJCQkgICAgU01CX1NUUl9TVEFOREFS
RCk7CiAJCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJCWZwcmludGYoc3RkZXJyLCAiSW52YWxpZCBu
b2RlICVzXG4iLCB0b2spOwogCQkJCQlyZXR1cm4gZmFsc2U7CkBAIC01NDUsNyArNTQ5LDcgQEAg
c3RhdGljIGJvb2wgZGJfZXhpc3RzKFRBTExPQ19DVFggKm1lbV9jdHgsIHN0cnVjdCBjdGRiX2Nv
bnRleHQgKmN0ZGIsCiAJfQogCiAJaWYgKHN0cm5jbXAoZGJfYXJnLCAiMHgiLCAyKSA9PSAwKSB7
Ci0JCWlkID0gc3RydG91bF9lcnIoZGJfYXJnLCBOVUxMLCAwLCAmcmV0KTsKKwkJaWQgPSBzbWJf
c3RydG91bChkYl9hcmcsIE5VTEwsIDAsICZyZXQsIFNNQl9TVFJfU1RBTkRBUkQpOwogCQlpZiAo
cmV0ICE9IDApIHsKIAkJCXJldHVybiBmYWxzZTsKIAkJfQpAQCAtMTA5NCw3ICsxMDk4LDcgQEAg
c3RhdGljIGludCBjb250cm9sX3NldHZhcihUQUxMT0NfQ1RYICptZW1fY3R4LCBzdHJ1Y3QgY3Rk
Yl9jb250ZXh0ICpjdGRiLAogCX0KIAogCXR1bmFibGUubmFtZSA9IGFyZ3ZbMF07Ci0JdHVuYWJs
ZS52YWx1ZSA9IHN0cnRvdWxfZXJyKGFyZ3ZbMV0sIE5VTEwsIDAsICZyZXQpOworCXR1bmFibGUu
dmFsdWUgPSBzbWJfc3RydG91bChhcmd2WzFdLCBOVUxMLCAwLCAmcmV0LCBTTUJfU1RSX1NUQU5E
QVJEKTsKIAlpZiAocmV0ICE9IDApIHsKIAkJcmV0dXJuIHJldDsKIAl9CkBAIC0xODg0LDcgKzE4
ODgsNyBAQCBzdGF0aWMgaW50IGNvbnRyb2xfcHJvY2Vzc19leGlzdHMoVEFMTE9DX0NUWCAqbWVt
X2N0eCwKIAogCXBpZCA9IGF0b2koYXJndlswXSk7CiAJaWYgKGFyZ2MgPT0gMikgewotCQlzcnZp
ZCA9IHN0cnRvdWxsX2Vycihhcmd2WzFdLCBOVUxMLCAwLCAmcmV0KTsKKwkJc3J2aWQgPSBzbWJf
c3RydG91bGwoYXJndlsxXSwgTlVMTCwgMCwgJnJldCwgU01CX1NUUl9TVEFOREFSRCk7CiAJCWlm
IChyZXQgIT0gMCkgewogCQkJcmV0dXJuIHJldDsKIAkJfQpAQCAtMjc5Myw3ICsyNzk3LDcgQEAg
c3RhdGljIGludCBjb250cm9sX2JhbihUQUxMT0NfQ1RYICptZW1fY3R4LCBzdHJ1Y3QgY3RkYl9j
b250ZXh0ICpjdGRiLAogCX0KIAogCWJhbl9zdGF0ZS5wbm4gPSBjdGRiLT5jbWRfcG5uOwotCWJh
bl9zdGF0ZS50aW1lID0gc3RydG91bF9lcnIoYXJndlswXSwgTlVMTCwgMCwgJnJldCk7CisJYmFu
X3N0YXRlLnRpbWUgPSBzbWJfc3RydG91bChhcmd2WzBdLCBOVUxMLCAwLCAmcmV0LCBTTUJfU1RS
X1NUQU5EQVJEKTsKIAlpZiAocmV0ICE9IDApIHsKIAkJcmV0dXJuIHJldDsKIAl9CkBAIC0zMTE3
LDcgKzMxMjEsNyBAQCBzdGF0aWMgaW50IGNvbnRyb2xfZ2V0dGlja2xlcyhUQUxMT0NfQ1RYICpt
ZW1fY3R4LCBzdHJ1Y3QgY3RkYl9jb250ZXh0ICpjdGRiLAogCX0KIAogCWlmIChhcmdjID09IDIp
IHsKLQkJcG9ydCA9IHN0cnRvdWxfZXJyKGFyZ3ZbMV0sIE5VTEwsIDEwLCAmcmV0KTsKKwkJcG9y
dCA9IHNtYl9zdHJ0b3VsKGFyZ3ZbMV0sIE5VTEwsIDEwLCAmcmV0LCBTTUJfU1RSX1NUQU5EQVJE
KTsKIAkJaWYgKHJldCAhPSAwKSB7CiAJCQlyZXR1cm4gcmV0OwogCQl9CkBAIC0zODI2LDcgKzM4
MzAsNyBAQCBzdGF0aWMgaW50IGNvbnRyb2xfbW92ZWlwKFRBTExPQ19DVFggKm1lbV9jdHgsIHN0
cnVjdCBjdGRiX2NvbnRleHQgKmN0ZGIsCiAJCXJldHVybiAxOwogCX0KIAotCXBubiA9IHN0cnRv
dWxfZXJyKGFyZ3ZbMV0sIE5VTEwsIDEwLCAmcmV0KTsKKwlwbm4gPSBzbWJfc3RydG91bChhcmd2
WzFdLCBOVUxMLCAxMCwgJnJldCwgU01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKHBubiA9PSBDVERC
X1VOS05PV05fUE5OIHx8IHJldCAhPSAwKSB7CiAJCWZwcmludGYoc3RkZXJyLCAiSW52YWxpZCBQ
Tk4gJXNcbiIsIGFyZ3ZbMV0pOwogCQlyZXR1cm4gMTsKQEAgLTUyNzksNyArNTI4MywxMSBAQCBz
dGF0aWMgaW50IGNvbnRyb2xfdHN0b3JlKFRBTExPQ19DVFggKm1lbV9jdHgsIHN0cnVjdCBjdGRi
X2NvbnRleHQgKmN0ZGIsCiAJWkVST19TVFJVQ1QoaGVhZGVyKTsKIAogCWlmIChhcmdjID4gMykg
ewotCQloZWFkZXIucnNuID0gKHVpbnQ2NF90KXN0cnRvdWxsX2Vycihhcmd2WzNdLCBOVUxMLCAw
LCAmcmV0KTsKKwkJaGVhZGVyLnJzbiA9ICh1aW50NjRfdClzbWJfc3RydG91bGwoYXJndlszXSwK
KwkJCQkJCSAgICBOVUxMLAorCQkJCQkJICAgIDAsCisJCQkJCQkgICAgJnJldCwKKwkJCQkJCSAg
ICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKHJldCAhPSAwKSB7CiAJCQlyZXR1cm4gcmV0Owog
CQl9CkBAIC02Mjk0LDcgKzYzMDIsMTEgQEAgaW50IG1haW4oaW50IGFyZ2MsIGNvbnN0IGNoYXIg
KmFyZ3ZbXSkKIAogCQljdGRiX3RpbWVvdXQgPSBnZXRlbnYoIkNUREJfVElNRU9VVCIpOwogCQlp
ZiAoY3RkYl90aW1lb3V0ICE9IE5VTEwpIHsKLQkJCW9wdGlvbnMubWF4cnVudGltZSA9IHN0cnRv
dWxfZXJyKGN0ZGJfdGltZW91dCwgTlVMTCwgMCwgJnJldCk7CisJCQlvcHRpb25zLm1heHJ1bnRp
bWUgPSBzbWJfc3RydG91bChjdGRiX3RpbWVvdXQsCisJCQkJCQkJIE5VTEwsCisJCQkJCQkJIDAs
CisJCQkJCQkJICZyZXQsCisJCQkJCQkJIFNNQl9TVFJfU1RBTkRBUkQpOwogCQkJaWYgKHJldCAh
PSAwKSB7CiAJCQkJZnByaW50ZihzdGRlcnIsICJJbnZhbGlkIHZhbHVlIENUREJfVElNRU9VVFxu
Iik7CiAJCQkJZXhpdCgxKTsKLS0gCjIuMjAuMQoKCkZyb20gNTA0MmVkMjEwYTc2NjVkOWQ5ZDc3
MWE2M2E0MWZhNzFmOTE1MDMzZCBNb24gU2VwIDE3IDAwOjAwOjAwIDIwMDEKRnJvbTogU3dlbiBT
Y2hpbGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgpEYXRlOiBUdWUsIDQgSnVuIDIwMTkgMDg6NTc6
MDMgKzAyMDAKU3ViamVjdDogW1BBVENIIDA4LzE2XSBsaWI6IFVwZGF0ZSBhbGwgY29uc3VtZXJz
IG9mIHN0cnRvdWxfZXJyKCksCiBzdHJ0b3VsbF9lcnIoKSB0byBuZXcgQVBJCgpTaWduZWQtb2Zm
LWJ5OiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+Ci0tLQogbGliL2xkYi1zYW1i
YS9sZGJfbWF0Y2hpbmdfcnVsZXMuYyB8IDE4ICsrKysrLS0tCiBsaWIvbGRiLXNhbWJhL2xkaWZf
aGFuZGxlcnMuYyAgICAgIHwgIDIgKy0KIGxpYi9wYXJhbS9sb2FkcGFybS5jICAgICAgICAgICAg
ICAgfCAgNCArLQogbGliL3V0aWwvYWNjZXNzLmMgICAgICAgICAgICAgICAgICB8ICA5ICsrLS0K
IGxpYi91dGlsL2FzbjEuYyAgICAgICAgICAgICAgICAgICAgfCAgNiArLS0KIGxpYi91dGlsL3Rl
c3RzL3V0aWwuYyAgICAgICAgICAgICAgfCA3MiArKysrKysrKysrKysrKystLS0tLS0tLS0tLS0t
LS0KIGxpYi91dGlsL3V0aWxfc3RyLmMgICAgICAgICAgICAgICAgfCAgNyArKy0KIDcgZmlsZXMg
Y2hhbmdlZCwgNjMgaW5zZXJ0aW9ucygrKSwgNTUgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEv
bGliL2xkYi1zYW1iYS9sZGJfbWF0Y2hpbmdfcnVsZXMuYyBiL2xpYi9sZGItc2FtYmEvbGRiX21h
dGNoaW5nX3J1bGVzLmMKaW5kZXggMDc1NGU3ZTA2NmIuLjRiMzU3YmI3MDZhIDEwMDY0NAotLS0g
YS9saWIvbGRiLXNhbWJhL2xkYl9tYXRjaGluZ19ydWxlcy5jCisrKyBiL2xpYi9sZGItc2FtYmEv
bGRiX21hdGNoaW5nX3J1bGVzLmMKQEAgLTM4Miw3ICszODIsNiBAQCBzdGF0aWMgaW50IGRzZGJf
bWF0Y2hfZm9yX2Ruc190b190b21ic3RvbmVfdGltZShzdHJ1Y3QgbGRiX2NvbnRleHQgKmxkYiwK
IAkJREJHX0VSUigiSW52YWxpZCB0aW1lc3RhbXAgcGFzc2VkXG4iKTsKIAkJcmV0dXJuIExEQl9F
UlJfSU5WQUxJRF9BVFRSSUJVVEVfU1lOVEFYOwogCX0gZWxzZSB7Ci0JCWNoYXIgKnAgPSBOVUxM
OwogCQlpbnQgZXJyb3IgPSAwOwogCQljaGFyIHNbdmFsdWVfdG9fbWF0Y2gtPmxlbmd0aCsxXTsK
IApAQCAtMzkyLDggKzM5MSwxMiBAQCBzdGF0aWMgaW50IGRzZGJfbWF0Y2hfZm9yX2Ruc190b190
b21ic3RvbmVfdGltZShzdHJ1Y3QgbGRiX2NvbnRleHQgKmxkYiwKIAkJCURCR19FUlIoIkVtcHR5
IHRpbWVzdGFtcCBwYXNzZWRcbiIpOwogCQkJcmV0dXJuIExEQl9FUlJfSU5WQUxJRF9BVFRSSUJV
VEVfU1lOVEFYOwogCQl9Ci0JCXRvbWJzdG9uZV90aW1lID0gc3RydG91bGxfZXJyKHMsICZwLCAx
MCwgJmVycm9yKTsKLQkJaWYgKGVycm9yICE9IDAgfHwgKnAgIT0gJ1wwJykgeworCQl0b21ic3Rv
bmVfdGltZSA9IHNtYl9zdHJ0b3VsbChzLAorCQkJCQkgICAgICBOVUxMLAorCQkJCQkgICAgICAx
MCwKKwkJCQkJICAgICAgJmVycm9yLAorCQkJCQkgICAgICBTTUJfU1RSX0ZVTExfU1RSX0NPTlYp
OworCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJREJHX0VSUigiSW52YWxpZCB0aW1lc3RhbXAgc3Ry
aW5nIHBhc3NlZFxuIik7CiAJCQlyZXR1cm4gTERCX0VSUl9JTlZBTElEX0FUVFJJQlVURV9TWU5U
QVg7CiAJCX0KQEAgLTUxNCw3ICs1MTcsNiBAQCBzdGF0aWMgaW50IGRzZGJfbWF0Y2hfZm9yX2V4
cHVuZ2Uoc3RydWN0IGxkYl9jb250ZXh0ICpsZGIsCiAJaWYgKHZhbHVlX3RvX21hdGNoLT5sZW5n
dGggPj02NCkgewogCQlyZXR1cm4gTERCX0VSUl9JTlZBTElEX0FUVFJJQlVURV9TWU5UQVg7CiAJ
fSBlbHNlIHsKLQkJY2hhciAqcCA9IE5VTEw7CiAJCWludCBlcnJvciA9IDA7CiAJCWNoYXIgc1t2
YWx1ZV90b19tYXRjaC0+bGVuZ3RoKzFdOwogCkBAIC01MjMsOCArNTI1LDEyIEBAIHN0YXRpYyBp
bnQgZHNkYl9tYXRjaF9mb3JfZXhwdW5nZShzdHJ1Y3QgbGRiX2NvbnRleHQgKmxkYiwKIAkJaWYg
KHNbMF0gPT0gJ1wwJyB8fCBzWzBdID09ICctJykgewogCQkJcmV0dXJuIExEQl9FUlJfSU5WQUxJ
RF9BVFRSSUJVVEVfU1lOVEFYOwogCQl9Ci0JCXRvbWJzdG9uZV90aW1lID0gc3RydG91bGxfZXJy
KHMsICZwLCAxMCwgJmVycm9yKTsKLQkJaWYgKGVycm9yICE9IDAgfHwgKnAgIT0gJ1wwJykgewor
CQl0b21ic3RvbmVfdGltZSA9IHNtYl9zdHJ0b3VsbChzLAorCQkJCQkgICAgICBOVUxMLAorCQkJ
CQkgICAgICAxMCwKKwkJCQkJICAgICAgJmVycm9yLAorCQkJCQkgICAgICBTTUJfU1RSX0ZVTExf
U1RSX0NPTlYpOworCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJcmV0dXJuIExEQl9FUlJfSU5WQUxJ
RF9BVFRSSUJVVEVfU1lOVEFYOwogCQl9CiAJfQpkaWZmIC0tZ2l0IGEvbGliL2xkYi1zYW1iYS9s
ZGlmX2hhbmRsZXJzLmMgYi9saWIvbGRiLXNhbWJhL2xkaWZfaGFuZGxlcnMuYwppbmRleCAyM2Qw
ODYwZGQ5Yi4uZTc0YTcxODJlY2YgMTAwNjQ0Ci0tLSBhL2xpYi9sZGItc2FtYmEvbGRpZl9oYW5k
bGVycy5jCisrKyBiL2xpYi9sZGItc2FtYmEvbGRpZl9oYW5kbGVycy5jCkBAIC02MjIsNyArNjIy
LDcgQEAgc3RhdGljIGludCBsZGlmX3JlYWRfcHJlZml4TWFwKHN0cnVjdCBsZGJfY29udGV4dCAq
bGRiLCB2b2lkICptZW1fY3R4LAogCQl9CiAKIAkJYmxvYi0+Y3RyLmRzZGIubWFwcGluZ3NbYmxv
Yi0+Y3RyLmRzZGIubnVtX21hcHBpbmdzXS5pZF9wcmVmaXggPQotCQkJc3RydG91bF9lcnIobGlu
ZSwgJm9pZCwgMTAsICZlcnJvcik7CisJCQlzbWJfc3RydG91bChsaW5lLCAmb2lkLCAxMCwgJmVy
cm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAogCQlpZiAob2lkWzBdICE9ICc6JyB8fCBlcnJvciAh
PSAwKSB7CiAJCQl0YWxsb2NfZnJlZSh0bXBfY3R4KTsKZGlmZiAtLWdpdCBhL2xpYi9wYXJhbS9s
b2FkcGFybS5jIGIvbGliL3BhcmFtL2xvYWRwYXJtLmMKaW5kZXggZTAzYzE1NTZkN2UuLjg0ZDg3
NzBhZmEzIDEwMDY0NAotLS0gYS9saWIvcGFyYW0vbG9hZHBhcm0uYworKysgYi9saWIvcGFyYW0v
bG9hZHBhcm0uYwpAQCAtMzM5LDcgKzMzOSw3IEBAIHVuc2lnbmVkIGxvbmcgbHBfdWxvbmcoY29u
c3QgY2hhciAqcykKIAkJcmV0dXJuIC0xOwogCX0KIAotCXJldCA9IHN0cnRvdWxfZXJyKHMsIE5V
TEwsIDAsICZlcnJvcik7CisJcmV0ID0gc21iX3N0cnRvdWwocywgTlVMTCwgMCwgJmVycm9yLCBT
TUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQlEQkdfREVCVUcoImxwX3Vs
b25nKCVzKTogY29udmVyc2lvbiBmYWlsZWRcbiIscyk7CiAJCXJldHVybiAtMTsKQEAgLTM2MSw3
ICszNjEsNyBAQCB1bnNpZ25lZCBsb25nIGxvbmcgbHBfdWxvbmdsb25nKGNvbnN0IGNoYXIgKnMp
CiAJCXJldHVybiAtMTsKIAl9CiAKLQlyZXQgPSBzdHJ0b3VsbF9lcnIocywgTlVMTCwgMCwgJmVy
cm9yKTsKKwlyZXQgPSBzbWJfc3RydG91bGwocywgTlVMTCwgMCwgJmVycm9yLCBTTUJfU1RSX1NU
QU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQlEQkdfREVCVUcoImxwX3Vsb25nbG9uZygl
cyk6IGNvbnZlcnNpb24gZmFpbGVkXG4iLHMpOwogCQlyZXR1cm4gLTE7CmRpZmYgLS1naXQgYS9s
aWIvdXRpbC9hY2Nlc3MuYyBiL2xpYi91dGlsL2FjY2Vzcy5jCmluZGV4IDk2MGZlNGIwNjZjLi4x
MGExNDc3MTg5OSAxMDA2NDQKLS0tIGEvbGliL3V0aWwvYWNjZXNzLmMKKysrIGIvbGliL3V0aWwv
YWNjZXNzLmMKQEAgLTcwLDEyICs3MCwxNSBAQCBzdGF0aWMgYm9vbCBtYXNrZWRfbWF0Y2goY29u
c3QgY2hhciAqdG9rLCBjb25zdCBjaGFyICpzbGFzaCwgY29uc3QgY2hhciAqcykKIAkJCXJldHVy
biBmYWxzZTsKIAkJfQogICAgICAgICB9IGVsc2UgewotCQljaGFyICplbmRwID0gTlVMTDsKIAkJ
aW50IGVycm9yID0gMDsKIAkJdW5zaWduZWQgbG9uZyB2YWw7CiAKLQkJdmFsID0gc3RydG91bF9l
cnIoc2xhc2grMSwgJmVuZHAsIDAsICZlcnJvcik7Ci0JCWlmIChlcnJvciAhPSAwIHx8ICplbmRw
ICE9ICdcMCcpIHsKKwkJdmFsID0gc21iX3N0cnRvdWwoc2xhc2grMSwKKwkJCQkgIE5VTEwsCisJ
CQkJICAwLAorCQkJCSAgJmVycm9yLAorCQkJCSAgU01CX1NUUl9GVUxMX1NUUl9DT05WKTsKKwkJ
aWYgKGVycm9yICE9IDApIHsKIAkJCXJldHVybiBmYWxzZTsKIAkJfQogCQlpZiAoIW1ha2VfbmV0
bWFzaygmc3NfbWFzaywgJnNzX3RvaywgdmFsKSkgewpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvYXNu
MS5jIGIvbGliL3V0aWwvYXNuMS5jCmluZGV4IDcwZmY1ZjBhZDg4Li41MWRhNTQyNDk1NiAxMDA2
NDQKLS0tIGEvbGliL3V0aWwvYXNuMS5jCisrKyBiL2xpYi91dGlsL2FzbjEuYwpAQCAtMjc4LDE0
ICsyNzgsMTQgQEAgYm9vbCBiZXJfd3JpdGVfT0lEX1N0cmluZyhUQUxMT0NfQ1RYICptZW1fY3R4
LCBEQVRBX0JMT0IgKmJsb2IsIGNvbnN0IGNoYXIgKk9JRCkKIAlpbnQgZXJyb3IgPSAwOwogCiAJ
aWYgKCFpc2RpZ2l0KCpwKSkgcmV0dXJuIGZhbHNlOwotCXYgPSBzdHJ0b3VsX2VycihwLCAmbmV3
cCwgMTAsICZlcnJvcik7CisJdiA9IHNtYl9zdHJ0b3VsKHAsICZuZXdwLCAxMCwgJmVycm9yLCBT
TUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAobmV3cFswXSAhPSAnLicgfHwgZXJyb3IgIT0gMCkgewog
CQlyZXR1cm4gZmFsc2U7CiAJfQogCXAgPSBuZXdwICsgMTsKIAogCWlmICghaXNkaWdpdCgqcCkp
IHJldHVybiBmYWxzZTsKLQl2MiA9IHN0cnRvdWxfZXJyKHAsICZuZXdwLCAxMCwgJmVycm9yKTsK
Kwl2MiA9IHNtYl9zdHJ0b3VsKHAsICZuZXdwLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJE
KTsKIAlpZiAobmV3cFswXSAhPSAnLicgfHwgZXJyb3IgIT0gMCkgewogCQlyZXR1cm4gZmFsc2U7
CiAJfQpAQCAtMzAwLDcgKzMwMCw3IEBAIGJvb2wgYmVyX3dyaXRlX09JRF9TdHJpbmcoVEFMTE9D
X0NUWCAqbWVtX2N0eCwgREFUQV9CTE9CICpibG9iLCBjb25zdCBjaGFyICpPSUQpCiAJaSA9IDE7
CiAJd2hpbGUgKCpwKSB7CiAJCWlmICghaXNkaWdpdCgqcCkpIHJldHVybiBmYWxzZTsKLQkJdiA9
IHN0cnRvdWxfZXJyKHAsICZuZXdwLCAxMCwgJmVycm9yKTsKKwkJdiA9IHNtYl9zdHJ0b3VsKHAs
ICZuZXdwLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKG5ld3BbMF0gPT0g
Jy4nIHx8IGVycm9yICE9IDApIHsKIAkJCXAgPSBuZXdwICsgMTsKIAkJCS8qIGNoZWNrIGZvciBl
bXB0eSBsYXN0IGNvbXBvbmVudCAqLwpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvdGVzdHMvdXRpbC5j
IGIvbGliL3V0aWwvdGVzdHMvdXRpbC5jCmluZGV4IGRlOWRjYTFmZmM1Li44NTRkMWQyMDIzZiAx
MDA2NDQKLS0tIGEvbGliL3V0aWwvdGVzdHMvdXRpbC5jCisrKyBiL2xpYi91dGlsL3Rlc3RzL3V0
aWwuYwpAQCAtNDIyLDMyICs0MjIsMzIgQEAgZG9uZToKIAlyZXR1cm4gcmV0OwogfQogCi1zdGF0
aWMgYm9vbCB0ZXN0X3N0cnRvdWxfZXJyX2Vycm5vX2NoZWNrKHN0cnVjdCB0b3J0dXJlX2NvbnRl
eHQgKnRjdHgpCitzdGF0aWMgYm9vbCB0ZXN0X3NtYl9zdHJ0b3VsX2Vycm5vX2NoZWNrKHN0cnVj
dCB0b3J0dXJlX2NvbnRleHQgKnRjdHgpCiB7CiAJY29uc3QgY2hhciAqbnVtYmVyID0gIjEyMyI7
CiAJdW5zaWduZWQgbG9uZyBpbnQgdmFsID0gMDsKIAl1bnNpZ25lZCBsb25nIGxvbmcgaW50IHZh
bGwgPSAwOwogCWludCBlcnI7CiAKLQkvKiBzZWxlY3QgYW4gZXJyb3IgY29kZSB3aGljaCBpcyBu
b3Qgc2V0IGJ5IHRoZSBzdHJ0b3VsX2VyciByb3V0aW5lcyAqLworCS8qIHNlbGVjdCBhbiBlcnJv
ciBjb2RlIHdoaWNoIGlzIG5vdCBzZXQgYnkgdGhlIHNtYl9zdHJ0b3VsIHJvdXRpbmVzICovCiAJ
ZXJybm8gPSBFQUdBSU47CiAJZXJyID0gRUFHQUlOOwotCXZhbCA9IHN0cnRvdWxfZXJyKG51bWJl
ciwgTlVMTCwgMCwgJmVycik7Ci0JdG9ydHVyZV9hc3NlcnQodGN0eCwgZXJybm8gPT0gRUFHQUlO
LCAic3RydG91bF9lcnI6IEV4cGVjdGVkIEVBR0FJTiIpOwotCXRvcnR1cmVfYXNzZXJ0KHRjdHgs
IGVyciA9PSAwLCAic3RydG91bF9lcnI6IEV4cGVjdGVkIGVyciA9IDAiKTsKLQl0b3J0dXJlX2Fz
c2VydCh0Y3R4LCB2YWwgPT0gMTIzLCAic3RydG91bF9lcnI6IEV4cGVjdGVkIHZhbHVlIDEyMyIp
OworCXZhbCA9IHNtYl9zdHJ0b3VsKG51bWJlciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9TVEFO
REFSRCk7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgZXJybm8gPT0gRUFHQUlOLCAic21iX3N0cnRv
dWw6IEV4cGVjdGVkIEVBR0FJTiIpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAi
c21iX3N0cnRvdWw6IEV4cGVjdGVkIGVyciA9IDAiKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCB2
YWwgPT0gMTIzLCAic21iX3N0cnRvdWw6IEV4cGVjdGVkIHZhbHVlIDEyMyIpOwogCiAJLyogc2V0
IGVyciB0byBhbiBpbXBvc3NpYmxlIHZhbHVlIGFnYWluIGJlZm9yZSBjb250aW51aW5nICovCiAJ
ZXJyID0gRUFHQUlOOwotCXZhbGwgPSBzdHJ0b3VsbF9lcnIobnVtYmVyLCBOVUxMLCAwLCAmZXJy
KTsKLQl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnJubyA9PSBFQUdBSU4sICJzdHJ0b3VsbF9lcnI6
IEV4cGVjdGVkIEVBR0FJTiIpOwotCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAic3Ry
dG91bF9lcnI6IEV4cGVjdGVkIGVyciA9IDAiKTsKLQl0b3J0dXJlX2Fzc2VydCh0Y3R4LCB2YWxs
ID09IDEyMywgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCB2YWx1ZSAxMjMiKTsKKwl2YWxsID0gc21i
X3N0cnRvdWxsKG51bWJlciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9TVEFOREFSRCk7CisJdG9y
dHVyZV9hc3NlcnQodGN0eCwgZXJybm8gPT0gRUFHQUlOLCAic21iX3N0cnRvdWxsOiBFeHBlY3Rl
ZCBFQUdBSU4iKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInNtYl9zdHJ0b3Vs
OiBFeHBlY3RlZCBlcnIgPSAwIik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgdmFsbCA9PSAxMjMs
ICJzbWJfc3RydG91bDogRXhwZWN0ZWQgdmFsdWUgMTIzIik7CiAKIAlyZXR1cm4gdHJ1ZTsKIH0K
IAotc3RhdGljIGJvb2wgdGVzdF9zdHJ0b3VsX2Vycl9uZWdhdGl2ZShzdHJ1Y3QgdG9ydHVyZV9j
b250ZXh0ICp0Y3R4KQorc3RhdGljIGJvb2wgdGVzdF9zbWJfc3RydG91bF9uZWdhdGl2ZShzdHJ1
Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQogewogCWNvbnN0IGNoYXIgKm51bWJlciA9ICItMTMy
IjsKIAljb25zdCBjaGFyICpudW1iZXIyID0gIjEzMi0iOwpAQCAtNDU2LDEyICs0NTYsMTIgQEAg
c3RhdGljIGJvb2wgdGVzdF9zdHJ0b3VsX2Vycl9uZWdhdGl2ZShzdHJ1Y3QgdG9ydHVyZV9jb250
ZXh0ICp0Y3R4KQogCWludCBlcnI7CiAKIAllcnIgPSAwOwotCXN0cnRvdWxfZXJyKG51bWJlciwg
TlVMTCwgMCwgJmVycik7Ci0JdG9ydHVyZV9hc3NlcnQodGN0eCwgZXJyID09IEVJTlZBTCwgInN0
cnRvdWxfZXJyOiBFeHBlY3RlZCBFSU5WQUwiKTsKKwlzbWJfc3RydG91bChudW1iZXIsIE5VTEws
IDAsICZlcnIsIFNNQl9TVFJfU1RBTkRBUkQpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9
PSBFSU5WQUwsICJzbWJfc3RydG91bDogRXhwZWN0ZWQgRUlOVkFMIik7CiAKIAllcnIgPSAwOwot
CXN0cnRvdWxsX2VycihudW1iZXIsIE5VTEwsIDAsICZlcnIpOwotCXRvcnR1cmVfYXNzZXJ0KHRj
dHgsIGVyciA9PSBFSU5WQUwsICJzdHJ0b3VsbF9lcnI6IEV4cGVjdGVkIEVJTlZBTCIpOworCXNt
Yl9zdHJ0b3VsbChudW1iZXIsIE5VTEwsIDAsICZlcnIsIFNNQl9TVFJfU1RBTkRBUkQpOworCXRv
cnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSBFSU5WQUwsICJzbWJfc3RydG91bGw6IEV4cGVjdGVk
IEVJTlZBTCIpOwogCiAJLyogaXQgaXMgYWxsb3dlZCB0byBoYXZlIGEgIi0iIHNpZ24gYWZ0ZXIg
YSBudW1iZXIsCiAJICogZS5nLiBhcyBwYXJ0IG9mIGEgZm9ybXVsYXIsIGhvd2V2ZXIsIGl0IGlz
IG5vdCBzdXBwb3NlZCB0bwpAQCAtNDY5LDM5ICs0NjksMzkgQEAgc3RhdGljIGJvb2wgdGVzdF9z
dHJ0b3VsX2Vycl9uZWdhdGl2ZShzdHJ1Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQogCSAqLwog
CiAJZXJyID0gMDsKLQl2YWwgPSBzdHJ0b3VsX2VycihudW1iZXIyLCBOVUxMLCAwLCAmZXJyKTsK
LQl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxfZXJyOiBFeHBlY3RlZCBu
byBlcnJvciIpOwotCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIHZhbCA9PSAxMzIsICJzdHJ0b3VsX2Vy
cjogV3JvbmcgdmFsdWUiKTsKKwl2YWwgPSBzbWJfc3RydG91bChudW1iZXIyLCBOVUxMLCAwLCAm
ZXJyLCBTTUJfU1RSX1NUQU5EQVJEKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwg
InNtYl9zdHJ0b3VsOiBFeHBlY3RlZCBubyBlcnJvciIpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgs
IHZhbCA9PSAxMzIsICJzbWJfc3RydG91bDogV3JvbmcgdmFsdWUiKTsKIAogCWVyciA9IDA7Ci0J
dmFsbCA9IHN0cnRvdWxsX2VycihudW1iZXIyLCBOVUxMLCAwLCAmZXJyKTsKLQl0b3J0dXJlX2Fz
c2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxsX2VycjogRXhwZWN0ZWQgbm8gZXJyb3IiKTsK
LQl0b3J0dXJlX2Fzc2VydCh0Y3R4LCB2YWxsID09IDEzMiwgInN0cnRvdWxsX2VycjogV3Jvbmcg
dmFsdWUiKTsKKwl2YWxsID0gc21iX3N0cnRvdWxsKG51bWJlcjIsIE5VTEwsIDAsICZlcnIsIFNN
Ql9TVFJfU1RBTkRBUkQpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAic21iX3N0
cnRvdWxsOiBFeHBlY3RlZCBubyBlcnJvciIpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIHZhbGwg
PT0gMTMyLCAic21iX3N0cnRvdWxsOiBXcm9uZyB2YWx1ZSIpOwogCiAJcmV0dXJuIHRydWU7CiB9
CiAKLXN0YXRpYyBib29sIHRlc3Rfc3RydG91bF9lcnJfbm9fbnVtYmVyKHN0cnVjdCB0b3J0dXJl
X2NvbnRleHQgKnRjdHgpCitzdGF0aWMgYm9vbCB0ZXN0X3NtYl9zdHJ0b3VsX25vX251bWJlcihz
dHJ1Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQogewogCWNvbnN0IGNoYXIgKm51bWJlciA9ICJn
aGlqayI7CiAJY29uc3QgY2hhciAqYmxhbmsgPSAiIjsKIAlpbnQgZXJyOwogCiAJZXJyID0gMDsK
LQlzdHJ0b3VsX2VycihudW1iZXIsIE5VTEwsIDAsICZlcnIpOwotCXRvcnR1cmVfYXNzZXJ0KHRj
dHgsIGVyciA9PSBFSU5WQUwsICJzdHJ0b3VsX2VycjogRXhwZWN0ZWQgRUlOVkFMIik7CisJc21i
X3N0cnRvdWwobnVtYmVyLCBOVUxMLCAwLCAmZXJyLCBTTUJfU1RSX1NUQU5EQVJEKTsKKwl0b3J0
dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic21iX3N0cnRvdWw6IEV4cGVjdGVkIEVJ
TlZBTCIpOwogCiAJZXJyID0gMDsKLQlzdHJ0b3VsbF9lcnIobnVtYmVyLCBOVUxMLCAwLCAmZXJy
KTsKLQl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic3RydG91bGxfZXJyOiBF
eHBlY3RlZCBFSU5WQUwiKTsKKwlzbWJfc3RydG91bGwobnVtYmVyLCBOVUxMLCAwLCAmZXJyLCBT
TUJfU1RSX1NUQU5EQVJEKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAi
c21iX3N0cnRvdWxsOiBFeHBlY3RlZCBFSU5WQUwiKTsKIAogCWVyciA9IDA7Ci0Jc3RydG91bF9l
cnIoYmxhbmssIE5VTEwsIDAsICZlcnIpOwotCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSBF
SU5WQUwsICJzdHJ0b3VsX2VycjogRXhwZWN0ZWQgRUlOVkFMIik7CisJc21iX3N0cnRvdWwoYmxh
bmssIE5VTEwsIDAsICZlcnIsIFNNQl9TVFJfU1RBTkRBUkQpOworCXRvcnR1cmVfYXNzZXJ0KHRj
dHgsIGVyciA9PSBFSU5WQUwsICJzbWJfc3RydG91bDogRXhwZWN0ZWQgRUlOVkFMIik7CiAKIAll
cnIgPSAwOwotCXN0cnRvdWxsX2VycihibGFuaywgTlVMTCwgMCwgJmVycik7Ci0JdG9ydHVyZV9h
c3NlcnQodGN0eCwgZXJyID09IEVJTlZBTCwgInN0cnRvdWxsX2VycjogRXhwZWN0ZWQgRUlOVkFM
Iik7CisJc21iX3N0cnRvdWxsKGJsYW5rLCBOVUxMLCAwLCAmZXJyLCBTTUJfU1RSX1NUQU5EQVJE
KTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic21iX3N0cnRvdWxsOiBF
eHBlY3RlZCBFSU5WQUwiKTsKIAogCXJldHVybiB0cnVlOwogfQpAQCAtNTE4LDEzICs1MTgsMTMg
QEAgc3RydWN0IHRvcnR1cmVfc3VpdGUgKnRvcnR1cmVfbG9jYWxfdXRpbChUQUxMT0NfQ1RYICpt
ZW1fY3R4KQogCQkJCSAgICAgICJkaXJlY3RvcnlfY3JlYXRlX29yX2V4aXN0IiwKIAkJCQkgICAg
ICB0ZXN0X2RpcmVjdG9yeV9jcmVhdGVfb3JfZXhpc3QpOwogCXRvcnR1cmVfc3VpdGVfYWRkX3Np
bXBsZV90ZXN0KHN1aXRlLAotCQkJCSAgICAgICJzdHJ0b3VsKGwpX2VyciBlcnJubyIsCi0JCQkJ
ICAgICAgdGVzdF9zdHJ0b3VsX2Vycl9lcnJub19jaGVjayk7CisJCQkJICAgICAgInNtYl9zdHJ0
b3VsKGwpIGVycm5vIiwKKwkJCQkgICAgICB0ZXN0X3NtYl9zdHJ0b3VsX2Vycm5vX2NoZWNrKTsK
IAl0b3J0dXJlX3N1aXRlX2FkZF9zaW1wbGVfdGVzdChzdWl0ZSwKLQkJCQkgICAgICAic3RydG91
bChsKV9lcnIgbmVnYXRpdmUiLAotCQkJCSAgICAgIHRlc3Rfc3RydG91bF9lcnJfbmVnYXRpdmUp
OworCQkJCSAgICAgICJzbWJfc3RydG91bChsKSBuZWdhdGl2ZSIsCisJCQkJICAgICAgdGVzdF9z
bWJfc3RydG91bF9uZWdhdGl2ZSk7CiAJdG9ydHVyZV9zdWl0ZV9hZGRfc2ltcGxlX3Rlc3Qoc3Vp
dGUsCi0JCQkJICAgICAgInN0cnRvdWwobClfZXJyIG5vIG51bWJlciIsCi0JCQkJICAgICAgdGVz
dF9zdHJ0b3VsX2Vycl9ub19udW1iZXIpOworCQkJCSAgICAgICJzbWJfc3RydG91bChsKSBubyBu
dW1iZXIiLAorCQkJCSAgICAgIHRlc3Rfc21iX3N0cnRvdWxfbm9fbnVtYmVyKTsKIAlyZXR1cm4g
c3VpdGU7CiB9CmRpZmYgLS1naXQgYS9saWIvdXRpbC91dGlsX3N0ci5jIGIvbGliL3V0aWwvdXRp
bF9zdHIuYwppbmRleCAyOWE0NDgzNmJkZS4uMzM1NmRmMzRmMDQgMTAwNjQ0Ci0tLSBhL2xpYi91
dGlsL3V0aWxfc3RyLmMKKysrIGIvbGliL3V0aWwvdXRpbF9zdHIuYwpAQCAtNjksNyArNjksNyBA
QCBfUFVCTElDXyBib29sIGNvbnZfc3RyX3NpemVfZXJyb3IoY29uc3QgY2hhciAqIHN0ciwgdWlu
dDY0X3QgKiB2YWwpCiAJCXJldHVybiBmYWxzZTsKIAl9CiAKLQlsdmFsID0gc3RydG91bGxfZXJy
KHN0ciwgJmVuZCwgMTAsICZlcnJvcik7CisJbHZhbCA9IHNtYl9zdHJ0b3VsbChzdHIsICZlbmQs
IDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCWlmIChlcnJvciAhPSAwKSB7CiAJCXJl
dHVybiBmYWxzZTsKIAl9CkBAIC0xMDMsNyArMTAzLDYgQEAgX1BVQkxJQ18gYm9vbCBjb252X3N0
cl9zaXplX2Vycm9yKGNvbnN0IGNoYXIgKiBzdHIsIHVpbnQ2NF90ICogdmFsKQogICovCiBfUFVC
TElDXyBib29sIGNvbnZfc3RyX3U2NChjb25zdCBjaGFyICogc3RyLCB1aW50NjRfdCAqIHZhbCkK
IHsKLQljaGFyICoJCSAgICBlbmQgPSBOVUxMOwogCXVuc2lnbmVkIGxvbmcgbG9uZyAgbHZhbDsK
IAlpbnQgZXJyb3IgPSAwOwogCkBAIC0xMTEsOCArMTEwLDggQEAgX1BVQkxJQ18gYm9vbCBjb252
X3N0cl91NjQoY29uc3QgY2hhciAqIHN0ciwgdWludDY0X3QgKiB2YWwpCiAJCXJldHVybiBmYWxz
ZTsKIAl9CiAKLQlsdmFsID0gc3RydG91bGxfZXJyKHN0ciwgJmVuZCwgMTAsICZlcnJvcik7Ci0J
aWYgKGVycm9yICE9IDAgfHwgKmVuZCAhPSAnXDAnKSB7CisJbHZhbCA9IHNtYl9zdHJ0b3VsbChz
dHIsIE5VTEwsIDEwLCAmZXJyb3IsIFNNQl9TVFJfRlVMTF9TVFJfQ09OVik7CisJaWYgKGVycm9y
ICE9IDApIHsKIAkJcmV0dXJuIGZhbHNlOwogCX0KIAotLSAKMi4yMC4xCgoKRnJvbSAzZjIyYjIw
ZWU5MTdlMWJmNmRkYTIxNTg3MTc4ODViNmVhMDRmZDg5IE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAw
MQpGcm9tOiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+CkRhdGU6IFR1ZSwgNCBK
dW4gMjAxOSAwODo1OTowNyArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMDkvMTZdIGxpYmNsaTogVXBk
YXRlIGFsbCBjb25zdW1lcnMgb2Ygc3RydG91bF9lcnIoKSwKIHN0cnRvdWxsX2VycigpIHRvIG5l
dyBBUEkKClNpZ25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4K
LS0tCiBsaWJjbGkvc2VjdXJpdHkvZG9tX3NpZC5jIHwgNiArKystLS0KIDEgZmlsZSBjaGFuZ2Vk
LCAzIGluc2VydGlvbnMoKyksIDMgZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvbGliY2xpL3Nl
Y3VyaXR5L2RvbV9zaWQuYyBiL2xpYmNsaS9zZWN1cml0eS9kb21fc2lkLmMKaW5kZXggYWMzNGE5
MmYxOWMuLmVjZjg5MjZjMTJjIDEwMDY0NAotLS0gYS9saWJjbGkvc2VjdXJpdHkvZG9tX3NpZC5j
CisrKyBiL2xpYmNsaS9zZWN1cml0eS9kb21fc2lkLmMKQEAgLTE0OCw3ICsxNDgsNyBAQCBib29s
IGRvbV9zaWRfcGFyc2VfZW5kcChjb25zdCBjaGFyICpzaWRzdHIsc3RydWN0IGRvbV9zaWQgKnNp
ZG91dCwKIAkJZ290byBmb3JtYXRfZXJyb3I7CiAJfQogCi0JY29udiA9IHN0cnRvdWxfZXJyKHAs
ICZxLCAxMCwgJmVycm9yKTsKKwljb252ID0gc21iX3N0cnRvdWwocCwgJnEsIDEwLCAmZXJyb3Is
IFNNQl9TVFJfU1RBTkRBUkQpOwogCWlmIChlcnJvciAhPSAwIHx8ICgqcSAhPSAnLScpIHx8IGNv
bnYgPiBVSU5UOF9NQVgpIHsKIAkJZ290byBmb3JtYXRfZXJyb3I7CiAJfQpAQCAtMTYwLDcgKzE2
MCw3IEBAIGJvb2wgZG9tX3NpZF9wYXJzZV9lbmRwKGNvbnN0IGNoYXIgKnNpZHN0cixzdHJ1Y3Qg
ZG9tX3NpZCAqc2lkb3V0LAogCX0KIAogCS8qIGdldCBpZGVudGF1dGggKi8KLQljb252ID0gc3Ry
dG91bGxfZXJyKHEsICZxLCAwLCAmZXJyb3IpOworCWNvbnYgPSBzbWJfc3RydG91bGwocSwgJnEs
IDAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKGNvbnYgJiBBVVRIT1JJVFlfTUFT
SyB8fCBlcnJvciAhPSAwKSB7CiAJCWdvdG8gZm9ybWF0X2Vycm9yOwogCX0KQEAgLTE4OSw3ICsx
ODksNyBAQCBib29sIGRvbV9zaWRfcGFyc2VfZW5kcChjb25zdCBjaGFyICpzaWRzdHIsc3RydWN0
IGRvbV9zaWQgKnNpZG91dCwKIAkJCWdvdG8gZm9ybWF0X2Vycm9yOwogCQl9CiAKLQkJY29udiA9
IHN0cnRvdWxsX2VycihxLCAmZW5kLCAxMCwgJmVycm9yKTsKKwkJY29udiA9IHNtYl9zdHJ0b3Vs
bChxLCAmZW5kLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKGNvbnYgPiBV
SU5UMzJfTUFYIHx8IGVycm9yICE9IDApIHsKIAkJCWdvdG8gZm9ybWF0X2Vycm9yOwogCQl9Ci0t
IAoyLjIwLjEKCgpGcm9tIGIyOThjMmNhZTEwM2I4YzU3YzBmYWRjMGI1ODUzYzY2OTRkMDg5ZDgg
TW9uIFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXgu
aWJtLmNvbT4KRGF0ZTogVHVlLCA0IEp1biAyMDE5IDA5OjAxOjAyICswMjAwClN1YmplY3Q6IFtQ
QVRDSCAxMC8xNl0gbnNzd2l0Y2g6IFVwZGF0ZSBhbGwgY29uc3VtZXJzIG9mIHN0cnRvdWxfZXJy
KCksCiBzdHJ0b3VsbF9lcnIoKSB0byBuZXcgQVBJCgpTaWduZWQtb2ZmLWJ5OiBTd2VuIFNjaGls
bGlnIDxzd2VuQGxpbnV4LmlibS5jb20+Ci0tLQogbnNzd2l0Y2gvbGlid2JjbGllbnQvd2JjX2lk
bWFwLmMgfCAxOCArKysrKysrKysrKysrKystLS0KIG5zc3dpdGNoL2xpYndiY2xpZW50L3diY19z
aWQuYyAgIHwgMjQgKysrKysrKysrKysrKysrKy0tLS0tLS0tCiBuc3N3aXRjaC93YmluZm8uYyAg
ICAgICAgICAgICAgICB8ICA5ICsrKystLS0tLQogMyBmaWxlcyBjaGFuZ2VkLCAzNSBpbnNlcnRp
b25zKCspLCAxNiBkZWxldGlvbnMoLSkKCmRpZmYgLS1naXQgYS9uc3N3aXRjaC9saWJ3YmNsaWVu
dC93YmNfaWRtYXAuYyBiL25zc3dpdGNoL2xpYndiY2xpZW50L3diY19pZG1hcC5jCmluZGV4IDZh
Zjk2YmRkYjU5Li4yNzBhM2MzYzNlYyAxMDA2NDQKLS0tIGEvbnNzd2l0Y2gvbGlid2JjbGllbnQv
d2JjX2lkbWFwLmMKKysrIGIvbnNzd2l0Y2gvbGlid2JjbGllbnQvd2JjX2lkbWFwLmMKQEAgLTM4
MCwxNSArMzgwLDI3IEBAIHdiY0VyciB3YmNDdHhTaWRzVG9Vbml4SWRzKHN0cnVjdCB3YmNDb250
ZXh0ICpjdHgsCiAJCXN3aXRjaCAocFswXSkgewogCQljYXNlICdVJzoKIAkJCWlkLT50eXBlID0g
V0JDX0lEX1RZUEVfVUlEOwotCQkJaWQtPmlkLnVpZCA9IHN0cnRvdWxfZXJyKHArMSwgJnEsIDEw
LCAmZXJyb3IpOworCQkJaWQtPmlkLnVpZCA9IHNtYl9zdHJ0b3VsKHArMSwKKwkJCQkJCSAmcSwK
KwkJCQkJCSAxMCwKKwkJCQkJCSAmZXJyb3IsCisJCQkJCQkgU01CX1NUUl9TVEFOREFSRCk7CiAJ
CQlicmVhazsKIAkJY2FzZSAnRyc6CiAJCQlpZC0+dHlwZSA9IFdCQ19JRF9UWVBFX0dJRDsKLQkJ
CWlkLT5pZC5naWQgPSBzdHJ0b3VsX2VycihwKzEsICZxLCAxMCwgJmVycm9yKTsKKwkJCWlkLT5p
ZC5naWQgPSBzbWJfc3RydG91bChwKzEsCisJCQkJCQkgJnEsCisJCQkJCQkgMTAsCisJCQkJCQkg
JmVycm9yLAorCQkJCQkJIFNNQl9TVFJfU1RBTkRBUkQpOwogCQkJYnJlYWs7CiAJCWNhc2UgJ0In
OgogCQkJaWQtPnR5cGUgPSBXQkNfSURfVFlQRV9CT1RIOwotCQkJaWQtPmlkLnVpZCA9IHN0cnRv
dWxfZXJyKHArMSwgJnEsIDEwLCAmZXJyb3IpOworCQkJaWQtPmlkLnVpZCA9IHNtYl9zdHJ0b3Vs
KHArMSwKKwkJCQkJCSAmcSwKKwkJCQkJCSAxMCwKKwkJCQkJCSAmZXJyb3IsCisJCQkJCQkgU01C
X1NUUl9TVEFOREFSRCk7CiAJCQlicmVhazsKIAkJZGVmYXVsdDoKIAkJCWlkLT50eXBlID0gV0JD
X0lEX1RZUEVfTk9UX1NQRUNJRklFRDsKZGlmZiAtLWdpdCBhL25zc3dpdGNoL2xpYndiY2xpZW50
L3diY19zaWQuYyBiL25zc3dpdGNoL2xpYndiY2xpZW50L3diY19zaWQuYwppbmRleCA1MTRhN2U4
ZDczOC4uY2VjN2I1MTliZmQgMTAwNjQ0Ci0tLSBhL25zc3dpdGNoL2xpYndiY2xpZW50L3diY19z
aWQuYworKysgYi9uc3N3aXRjaC9saWJ3YmNsaWVudC93YmNfc2lkLmMKQEAgLTEyMiw3ICsxMjIs
NyBAQCB3YmNFcnIgd2JjU3RyaW5nVG9TaWQoY29uc3QgY2hhciAqc3RyLAogCS8qIEdldCB0aGUg
U0lEIHJldmlzaW9uIG51bWJlciAqLwogCiAJcCA9IHN0cisyOwotCXggPSAodWludDY0X3Qpc3Ry
dG91bF9lcnIocCwgJnEsIDEwLCAmZXJyb3IpOworCXggPSAodWludDY0X3Qpc21iX3N0cnRvdWwo
cCwgJnEsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCWlmICh4ID09IDAgfHwgeCA+
IFVJTlQ4X01BWCB8fCAhcSB8fCAqcSAhPSAnLScgfHwgZXJyb3IgIT0gMCkgewogCQl3YmNfc3Rh
dHVzID0gV0JDX0VSUl9JTlZBTElEX1NJRDsKIAkJQkFJTF9PTl9XQkNfRVJST1Iod2JjX3N0YXR1
cyk7CkBAIC0xMzUsNyArMTM1LDcgQEAgd2JjRXJyIHdiY1N0cmluZ1RvU2lkKGNvbnN0IGNoYXIg
KnN0ciwKIAkgKiBiZSBleHByZXNzZWQgYXMgYSBoZXggdmFsdWUsIGFjY29yZGluZyB0byBNUy1E
VFlQLgogCSAqLwogCXAgPSBxKzE7Ci0JeCA9IHN0cnRvdWxsX2VycihwLCAmcSwgMCwgJmVycm9y
KTsKKwl4ID0gc21iX3N0cnRvdWxsKHAsICZxLCAwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQp
OwogCWlmICghcSB8fCAqcSAhPSAnLScgfHwgKHggJiBBVVRIT1JJVFlfTUFTSykgfHwgZXJyb3Ig
IT0gMCkgewogCQl3YmNfc3RhdHVzID0gV0JDX0VSUl9JTlZBTElEX1NJRDsKIAkJQkFJTF9PTl9X
QkNfRVJST1Iod2JjX3N0YXR1cyk7CkBAIC0xNTEsNyArMTUxLDcgQEAgd2JjRXJyIHdiY1N0cmlu
Z1RvU2lkKGNvbnN0IGNoYXIgKnN0ciwKIAlwID0gcSArMTsKIAlzaWQtPm51bV9hdXRocyA9IDA7
CiAJd2hpbGUgKHNpZC0+bnVtX2F1dGhzIDwgV0JDX01BWFNVQkFVVEhTKSB7Ci0JCXggPSBzdHJ0
b3VsbF9lcnIocCwgJnEsIDEwLCAmZXJyb3IpOworCQl4ID0gc21iX3N0cnRvdWxsKHAsICZxLCAx
MCwgJmVycm9yLCBTTUJfU1RSX0FMTE9XX05PX0NPTlZFUlNJT04pOwogCQlpZiAocCA9PSBxKQog
CQkJYnJlYWs7CiAJCWlmICh4ID4gVUlOVDMyX01BWCB8fCBlcnJvciAhPSAwKSB7CkBAIC0zODks
NyArMzg5LDcgQEAgd2JjRXJyIHdiY0N0eExvb2t1cFNpZHMoc3RydWN0IHdiY0NvbnRleHQgKmN0
eCwKIAogCXAgPSBleHRyYV9kYXRhOwogCi0JbnVtX2RvbWFpbnMgPSBzdHJ0b3VsX2VycihwLCAm
cSwgMTAsICZlcnJvcik7CisJbnVtX2RvbWFpbnMgPSBzbWJfc3RydG91bChwLCAmcSwgMTAsICZl
cnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKCpxICE9ICdcbicgfHwgZXJyb3IgIT0gMCkg
ewogCQlnb3RvIHdiY19lcnJfaW52YWxpZDsKIAl9CkBAIC00MjksNyArNDI5LDcgQEAgd2JjRXJy
IHdiY0N0eExvb2t1cFNpZHMoc3RydWN0IHdiY0NvbnRleHQgKmN0eCwKIAkJcCA9IHErMTsKIAl9
CiAKLQludW1fbmFtZXMgPSBzdHJ0b3VsX2VycihwLCAmcSwgMTAsICZlcnJvcik7CisJbnVtX25h
bWVzID0gc21iX3N0cnRvdWwocCwgJnEsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwog
CWlmICgqcSAhPSAnXG4nIHx8IGVycm9yICE9IDApIHsKIAkJZ290byB3YmNfZXJyX2ludmFsaWQ7
CiAJfQpAQCAtNDQ5LDcgKzQ0OSwxMSBAQCB3YmNFcnIgd2JjQ3R4TG9va3VwU2lkcyhzdHJ1Y3Qg
d2JjQ29udGV4dCAqY3R4LAogCiAJZm9yIChpPTA7IGk8bnVtX25hbWVzOyBpKyspIHsKIAotCQlu
YW1lc1tpXS5kb21haW5faW5kZXggPSBzdHJ0b3VsX2VycihwLCAmcSwgMTAsICZlcnJvcik7CisJ
CW5hbWVzW2ldLmRvbWFpbl9pbmRleCA9IHNtYl9zdHJ0b3VsKHAsCisJCQkJCQkgICAgJnEsCisJ
CQkJCQkgICAgMTAsCisJCQkJCQkgICAgJmVycm9yLAorCQkJCQkJICAgIFNNQl9TVFJfU1RBTkRB
UkQpOwogCQlpZiAobmFtZXNbaV0uZG9tYWluX2luZGV4IDwgMCB8fCBlcnJvciAhPSAwKSB7CiAJ
CQlnb3RvIHdiY19lcnJfaW52YWxpZDsKIAkJfQpAQCAtNDYyLDcgKzQ2Niw3IEBAIHdiY0VyciB3
YmNDdHhMb29rdXBTaWRzKHN0cnVjdCB3YmNDb250ZXh0ICpjdHgsCiAJCX0KIAkJcCA9IHErMTsK
IAotCQluYW1lc1tpXS50eXBlID0gc3RydG91bF9lcnIocCwgJnEsIDEwLCAmZXJyb3IpOworCQlu
YW1lc1tpXS50eXBlID0gc21iX3N0cnRvdWwocCwgJnEsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RB
TkRBUkQpOwogCQlpZiAoKnEgIT0gJyAnIHx8IGVycm9yICE9IDApIHsKIAkJCWdvdG8gd2JjX2Vy
cl9pbnZhbGlkOwogCQl9CkBAIC01ODUsNyArNTg5LDExIEBAIHdiY0VyciB3YmNDdHhMb29rdXBS
aWRzKHN0cnVjdCB3YmNDb250ZXh0ICpjdHgsIHN0cnVjdCB3YmNEb21haW5TaWQgKmRvbV9zaWQs
CiAJCQlnb3RvIGRvbmU7CiAJCX0KIAotCQl0eXBlc1tpXSA9IChlbnVtIHdiY1NpZFR5cGUpc3Ry
dG91bF9lcnIocCwgJnEsIDEwLCAmZXJyb3IpOworCQl0eXBlc1tpXSA9IChlbnVtIHdiY1NpZFR5
cGUpc21iX3N0cnRvdWwocCwKKwkJCQkJCQkmcSwKKwkJCQkJCQkxMCwKKwkJCQkJCQkmZXJyb3Is
CisJCQkJCQkJU01CX1NUUl9TVEFOREFSRCk7CiAKIAkJaWYgKCpxICE9ICcgJyB8fCBlcnJvciAh
PSAwKSB7CiAJCQl3YmNfc3RhdHVzID0gV0JDX0VSUl9JTlZBTElEX1JFU1BPTlNFOwpkaWZmIC0t
Z2l0IGEvbnNzd2l0Y2gvd2JpbmZvLmMgYi9uc3N3aXRjaC93YmluZm8uYwppbmRleCBiOGYwNDUz
NjI5OS4uYWU4OWY4NzZhOWQgMTAwNjQ0Ci0tLSBhL25zc3dpdGNoL3diaW5mby5jCisrKyBiL25z
c3dpdGNoL3diaW5mby5jCkBAIC0xNDAsNyArMTQwLDcgQEAgc3RhdGljIGJvb2wgcGFyc2Vfd2Jp
bmZvX2RvbWFpbl91c2VyKGNvbnN0IGNoYXIgKmRvbXVzZXIsIGZzdHJpbmcgZG9tYWluLAogICog
UmV0dXJuIHRydWUgaWYgaW5wdXQgd2FzIHZhbGlkLCBmYWxzZSBvdGhlcndpc2UuICovCiBzdGF0
aWMgYm9vbCBwYXJzZV9tYXBwaW5nX2FyZyhjaGFyICphcmcsIGludCAqaWQsIGNoYXIgKipzaWQp
CiB7Ci0JY2hhciAqdG1wLCAqZW5kcHRyOworCWNoYXIgKnRtcDsKIAlpbnQgZXJyb3IgPSAwOwog
CiAJaWYgKCFhcmcgfHwgISphcmcpCkBAIC0xNTQsOSArMTU0LDggQEAgc3RhdGljIGJvb2wgcGFy
c2VfbWFwcGluZ19hcmcoY2hhciAqYXJnLCBpbnQgKmlkLCBjaGFyICoqc2lkKQogCiAJLyogQmVj
YXVzZSBhdG9pKCkgY2FuIHJldHVybiAwIG9uIGludmFsaWQgaW5wdXQsIHdoaWNoIHdvdWxkIGJl
IGEgdmFsaWQKIAkgKiBVSUQvR0lEIHdlIG11c3QgdXNlIHN0cnRvdWwoKSBhbmQgZG8gZXJyb3Ig
Y2hlY2tpbmcgKi8KLQkqaWQgPSBzdHJ0b3VsX2Vycih0bXAsICZlbmRwdHIsIDEwLCAmZXJyb3Ip
OwotCi0JaWYgKGVuZHB0clswXSAhPSAnXDAnIHx8IGVycm9yICE9IDApCisJKmlkID0gc21iX3N0
cnRvdWwodG1wLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX0ZVTExfU1RSX0NPTlYpOworCWlm
IChlcnJvciAhPSAwKQogCQlyZXR1cm4gZmFsc2U7CiAKIAlyZXR1cm4gdHJ1ZTsKQEAgLTE0MjEs
NyArMTQyMCw3IEBAIHN0YXRpYyBib29sIHdiaW5mb19sb29rdXByaWRzKGNvbnN0IGNoYXIgKmRv
bWFpbiwgY29uc3QgY2hhciAqYXJnKQogCQlpbnQgZXJyb3IgPSAwOwogCQl1aW50MzJfdCByaWQ7
CiAKLQkJcmlkID0gc3RydG91bF9lcnIocmlkc3RyLCBOVUxMLCAxMCwgJmVycm9yKTsKKwkJcmlk
ID0gc21iX3N0cnRvdWwocmlkc3RyLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJE
KTsKIAkJaWYgKGVycm9yICE9IDApIHsKIAkJCWRfcHJpbnRmKCJmYWlsZWQgdG8gY29udmVydCBy
aWRcbiIpOwogCQkJZ290byBkb25lOwotLSAKMi4yMC4xCgoKRnJvbSA2Y2U4MmNmNmRlMThjMzk1
NjJjMGI1Mzk3MjVmYmZlOTBkYTJjMGZlIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBT
d2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+CkRhdGU6IFR1ZSwgNCBKdW4gMjAxOSAw
OTowNDoxNSArMDIwMApTdWJqZWN0OiBbUEFUQ0ggMTEvMTZdIHNvdXJjZTM6IFVwZGF0ZSBhbGwg
Y29uc3VtZXJzIG9mIHN0cnRvdWxfZXJyKCksCiBzdHJ0b3VsbF9lcnIoKSB0byBuZXcgQVBJCgpT
aWduZWQtb2ZmLWJ5OiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxpbnV4LmlibS5jb20+Ci0tLQogc291
cmNlMy9ncm91cGRiL21hcHBpbmcuYyAgICAgICAgICAgICAgfCAgNSArKy0KIHNvdXJjZTMvZ3Jv
dXBkYi9tYXBwaW5nX3RkYi5jICAgICAgICAgIHwgMjEgKysrKysrLS0tLQogc291cmNlMy9saWIv
aW50ZXJmYWNlLmMgICAgICAgICAgICAgICAgfCAxNyArKysrKystLS0KIHNvdXJjZTMvbGliL21l
c3NhZ2VzX2RnbS5jICAgICAgICAgICAgIHwgIDQgKy0KIHNvdXJjZTMvbGliL25hbWVtYXBfY2Fj
aGUuYyAgICAgICAgICAgIHwgMTAgKystLS0KIHNvdXJjZTMvbGliL3N5c3F1b3Rhcy5jICAgICAg
ICAgICAgICAgIHwgIDYgKystCiBzb3VyY2UzL2xpYi90bGRhcF91dGlsLmMgICAgICAgICAgICAg
ICB8ICAyICstCiBzb3VyY2UzL2xpYi91dGlsX3N0ci5jICAgICAgICAgICAgICAgICB8ICA2ICst
LQogc291cmNlMy9tb2R1bGVzL3Zmc19jZXBoX3NuYXBzaG90cy5jICAgfCAyMCArKysrKy0tLS0t
CiBzb3VyY2UzL21vZHVsZXMvdmZzX3ByZW9wZW4uYyAgICAgICAgICB8ICAyICstCiBzb3VyY2Uz
L21vZHVsZXMvdmZzX3NuYXBwZXIuYyAgICAgICAgICB8ICAyICstCiBzb3VyY2UzL21vZHVsZXMv
dmZzX3VuaXR5ZWRfbWVkaWEuYyAgICB8ICA3ICsrKy0KIHNvdXJjZTMvcGFzc2RiL2FjY291bnRf
cG9sLmMgICAgICAgICAgIHwgIDYgKystCiBzb3VyY2UzL3Bhc3NkYi9wZGJfbGRhcC5jICAgICAg
ICAgICAgICB8IDUzICsrKysrKysrKysrKysrKysrKystLS0tLS0tCiBzb3VyY2UzL3Bhc3NkYi9w
ZGJfdGRiLmMgICAgICAgICAgICAgICB8ICA2ICsrLQogc291cmNlMy9ycGNjbGllbnQvY21kX3Nh
bXIuYyAgICAgICAgICAgfCAgMiArLQogc291cmNlMy9ycGNjbGllbnQvY21kX3Nwb29sc3MuYyAg
ICAgICAgfCAgNiArKy0KIHNvdXJjZTMvdXRpbHMvbmV0X2lkbWFwLmMgICAgICAgICAgICAgIHwg
IDUgKy0tCiBzb3VyY2UzL3V0aWxzL25ldF9yZWdpc3RyeS5jICAgICAgICAgICB8ICA4ICsrKy0K
IHNvdXJjZTMvdXRpbHMvbmV0X3JwY19yZWdpc3RyeS5jICAgICAgIHwgIDIgKy0KIHNvdXJjZTMv
dXRpbHMvbmV0X3NhbS5jICAgICAgICAgICAgICAgIHwgIDkgKysrLS0KIHNvdXJjZTMvdXRpbHMv
cGRiZWRpdC5jICAgICAgICAgICAgICAgIHwgIDkgKysrLS0KIHNvdXJjZTMvdXRpbHMvcmVnZWRp
dF9kaWFsb2cuYyAgICAgICAgIHwgIDUgKy0tCiBzb3VyY2UzL3dpbmJpbmRkL2lkbWFwX2xkYXAu
YyAgICAgICAgICB8ICA2ICstLQogc291cmNlMy93aW5iaW5kZC93aW5iaW5kZF9sb29rdXByaWRz
LmMgfCAgMiArLQogc291cmNlMy93aW5iaW5kZC93aW5iaW5kZF91dGlsLmMgICAgICAgfCAyMCAr
KysrKysrKy0tCiAyNiBmaWxlcyBjaGFuZ2VkLCAxNTkgaW5zZXJ0aW9ucygrKSwgODIgZGVsZXRp
b25zKC0pCgpkaWZmIC0tZ2l0IGEvc291cmNlMy9ncm91cGRiL21hcHBpbmcuYyBiL3NvdXJjZTMv
Z3JvdXBkYi9tYXBwaW5nLmMKaW5kZXggNzdlYjBkNmU1Y2QuLjFlMjVjNTYzN2RjIDEwMDY0NAot
LS0gYS9zb3VyY2UzL2dyb3VwZGIvbWFwcGluZy5jCisrKyBiL3NvdXJjZTMvZ3JvdXBkYi9tYXBw
aW5nLmMKQEAgLTI0NSwxMCArMjQ1LDExIEBAIGludCBzbWJfY3JlYXRlX2dyb3VwKGNvbnN0IGNo
YXIgKnVuaXhfZ3JvdXAsIGdpZF90ICpuZXdfZ2lkKQogCQkJbnJlYWQgPSByZWFkKGZkLCBvdXRw
dXQsIHNpemVvZihvdXRwdXQpLTEpOwogCQkJaWYgKG5yZWFkID4gMCkgewogCQkJCW91dHB1dFtu
cmVhZF0gPSAnXDAnOwotCQkJCSpuZXdfZ2lkID0gKGdpZF90KXN0cnRvdWxfZXJyKG91dHB1dCwK
KwkJCQkqbmV3X2dpZCA9IChnaWRfdClzbWJfc3RydG91bChvdXRwdXQsCiAJCQkJCQkJICAgICAg
TlVMTCwKIAkJCQkJCQkgICAgICAxMCwKLQkJCQkJCQkgICAgICAmZXJyb3IpOworCQkJCQkJCSAg
ICAgICZlcnJvciwKKwkJCQkJCQkgICAgICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJCQlpZiAoZXJy
b3IgIT0gMCkgewogCQkJCQkqbmV3X2dpZCA9IDA7CiAJCQkJCWNsb3NlKGZkKTsKZGlmZiAtLWdp
dCBhL3NvdXJjZTMvZ3JvdXBkYi9tYXBwaW5nX3RkYi5jIGIvc291cmNlMy9ncm91cGRiL21hcHBp
bmdfdGRiLmMKaW5kZXggYzgwZmYxZjg1OWEuLmI3ZmY3MjRiYTA1IDEwMDY0NAotLS0gYS9zb3Vy
Y2UzL2dyb3VwZGIvbWFwcGluZ190ZGIuYworKysgYi9zb3VyY2UzL2dyb3VwZGIvbWFwcGluZ190
ZGIuYwpAQCAtODU3LDcgKzg1Nyw2IEBAIHN0YXRpYyBpbnQgY29udmVydF9sZGJfcmVjb3JkKFRE
Ql9DT05URVhUICpsdGRiLCBUREJfREFUQSBrZXksCiAJc2l6ZV90IGxlbjsKIAljaGFyICpuYW1l
OwogCWNoYXIgKnZhbDsKLQljaGFyICpxOwogCXVpbnQzMl90IG51bV9tZW0gPSAwOwogCXN0cnVj
dCBkb21fc2lkICptZW1iZXJzID0gTlVMTDsKIAlpbnQgZXJyb3IgPSAwOwpAQCAtOTc1LDggKzk3
NCwxMiBAQCBzdGF0aWMgaW50IGNvbnZlcnRfbGRiX3JlY29yZChUREJfQ09OVEVYVCAqbHRkYiwg
VERCX0RBVEEga2V5LAogCQkJLyogd2UgaWdub3JlIHVua25vd24gb3IgdW5pbnRlcmVzdGluZyBh
dHRyaWJ1dGVzCiAJCQkgKiAob2JqZWN0Y2xhc3MsIGV0Yy4pICovCiAJCQlpZiAoc3RyY2FzZWNt
cF9tKG5hbWUsICJnaWROdW1iZXIiKSA9PSAwKSB7Ci0JCQkJbWFwLT5naWQgPSBzdHJ0b3VsX2Vy
cih2YWwsICZxLCAxMCwgJmVycm9yKTsKLQkJCQlpZiAoKnEgfHwgKGVycm9yICE9IDApKSB7CisJ
CQkJbWFwLT5naWQgPSBzbWJfc3RydG91bCh2YWwsCisJCQkJCQkgICAgICAgTlVMTCwKKwkJCQkJ
CSAgICAgICAxMCwKKwkJCQkJCSAgICAgICAmZXJyb3IsCisJCQkJCQkgICAgICAgU01CX1NUUl9G
VUxMX1NUUl9DT05WKTsKKwkJCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJCQllcnJubyA9IEVJTzsK
IAkJCQkJZ290byBmYWlsZWQ7CiAJCQkJfQpAQCAtOTg2LDExICs5ODksMTMgQEAgc3RhdGljIGlu
dCBjb252ZXJ0X2xkYl9yZWNvcmQoVERCX0NPTlRFWFQgKmx0ZGIsIFREQl9EQVRBIGtleSwKIAkJ
CQkJZ290byBmYWlsZWQ7CiAJCQkJfQogCQkJfSBlbHNlIGlmIChzdHJjYXNlY21wX20obmFtZSwg
InNpZE5hbWVVc2UiKSA9PSAwKSB7Ci0JCQkJbWFwLT5zaWRfbmFtZV91c2UgPSBzdHJ0b3VsX2Vy
cih2YWwsCi0JCQkJCQkJCSZxLAotCQkJCQkJCQkxMCwKLQkJCQkJCQkJJmVycm9yKTsKLQkJCQlp
ZiAoKnEgfHwgKGVycm9yICE9IDApKSB7CisJCQkJbWFwLT5zaWRfbmFtZV91c2UgPQorCQkJCQlz
bWJfc3RydG91bCh2YWwsCisJCQkJCQkgICAgTlVMTCwKKwkJCQkJCSAgICAxMCwKKwkJCQkJCSAg
ICAmZXJyb3IsCisJCQkJCQkgICAgU01CX1NUUl9GVUxMX1NUUl9DT05WKTsKKwkJCQlpZiAoZXJy
b3IgIT0gMCkgewogCQkJCQllcnJubyA9IEVJTzsKIAkJCQkJZ290byBmYWlsZWQ7CiAJCQkJfQpk
aWZmIC0tZ2l0IGEvc291cmNlMy9saWIvaW50ZXJmYWNlLmMgYi9zb3VyY2UzL2xpYi9pbnRlcmZh
Y2UuYwppbmRleCAzMTA2NmI4YjVjYy4uYWY4MTY5NWFiYWIgMTAwNjQ0Ci0tLSBhL3NvdXJjZTMv
bGliL2ludGVyZmFjZS5jCisrKyBiL3NvdXJjZTMvbGliL2ludGVyZmFjZS5jCkBAIC0zNzAsNyAr
MzcwLDExIEBAIHN0YXRpYyB2b2lkIHBhcnNlX2V4dHJhX2luZm8oY2hhciAqa2V5LCB1aW50NjRf
dCAqc3BlZWQsIHVpbnQzMl90ICpjYXAsCiAJCQkqdmFsKysgPSAwOwogCiAJCQlpZiAoc3RyZXF1
YWxfbShrZXksICJzcGVlZCIpKSB7Ci0JCQkJKnNwZWVkID0gKHVpbnQ2NF90KXN0cnRvdWxsX2Vy
cih2YWwsIE5VTEwsIDAsICZlcnJvcik7CisJCQkJKnNwZWVkID0gKHVpbnQ2NF90KXNtYl9zdHJ0
b3VsbCh2YWwsCisJCQkJCQkJCU5VTEwsCisJCQkJCQkJCTAsCisJCQkJCQkJCSZlcnJvciwKKwkJ
CQkJCQkJU01CX1NUUl9TVEFOREFSRCk7CiAJCQkJaWYgKGVycm9yICE9IDApIHsKIAkJCQkJREJH
X0RFQlVHKCJJbnZhbGlkIHNwZWVkIHZhbHVlICglcylcbiIsIHZhbCk7CiAJCQkJfQpAQCAtMzg0
LDcgKzM4OCwxMSBAQCBzdGF0aWMgdm9pZCBwYXJzZV9leHRyYV9pbmZvKGNoYXIgKmtleSwgdWlu
dDY0X3QgKnNwZWVkLCB1aW50MzJfdCAqY2FwLAogCQkJCQkJICAgICInJXMnXG4iLCB2YWwpOwog
CQkJCX0KIAkJCX0gZWxzZSBpZiAoc3RyZXF1YWxfbShrZXksICJpZl9pbmRleCIpKSB7Ci0JCQkJ
KmlmX2luZGV4ID0gKHVpbnQzMl90KXN0cnRvdWxfZXJyKHZhbCwgTlVMTCwgMCwgJmVycm9yKTsK
KwkJCQkqaWZfaW5kZXggPSAodWludDMyX3Qpc21iX3N0cnRvdWwodmFsLAorCQkJCQkJCQkgIE5V
TEwsCisJCQkJCQkJCSAgMCwKKwkJCQkJCQkJICAmZXJyb3IsCisJCQkJCQkJCSAgU01CX1NUUl9T
VEFOREFSRCk7CiAJCQkJaWYgKGVycm9yICE9IDApIHsKIAkJCQkJREJHX0RFQlVHKCJJbnZhbGlk
IGtleSB2YWx1ZSAoJXMpXG4iLCB2YWwpOwogCQkJCX0KQEAgLTUyMywxMSArNTMxLDEwIEBAIHN0
YXRpYyB2b2lkIGludGVycHJldF9pbnRlcmZhY2UoY2hhciAqdG9rZW4pCiAJCX0KIAl9IGVsc2Ug
ewogCQlpbnQgZXJyb3IgPSAwOwotCQljaGFyICplbmRwID0gTlVMTDsKIAkJdW5zaWduZWQgbG9u
ZyB2YWw7CiAKLQkJdmFsID0gc3RydG91bF9lcnIocCwgJmVuZHAsIDAsICZlcnJvcik7Ci0JCWlm
IChlcnJvciAhPSAwIHx8ICplbmRwICE9ICdcMCcpIHsKKwkJdmFsID0gc21iX3N0cnRvdWwocCwg
TlVMTCwgMCwgJmVycm9yLCBTTUJfU1RSX0ZVTExfU1RSX0NPTlYpOworCQlpZiAoZXJyb3IgIT0g
MCkgewogCQkJREVCVUcoMiwoImludGVycHJldF9pbnRlcmZhY2U6ICIKIAkJCQkiY2FuJ3QgZGV0
ZXJtaW5lIG5ldG1hc2sgdmFsdWUgZnJvbSAlc1xuIiwKIAkJCQlwKSk7CmRpZmYgLS1naXQgYS9z
b3VyY2UzL2xpYi9tZXNzYWdlc19kZ20uYyBiL3NvdXJjZTMvbGliL21lc3NhZ2VzX2RnbS5jCmlu
ZGV4IDJkOTBmNTI1ZjFkLi42MGExMmUyMDA4ZiAxMDA2NDQKLS0tIGEvc291cmNlMy9saWIvbWVz
c2FnZXNfZGdtLmMKKysrIGIvc291cmNlMy9saWIvbWVzc2FnZXNfZGdtLmMKQEAgLTE0NjksNyAr
MTQ2OSw3IEBAIHN0YXRpYyBpbnQgbWVzc2FnaW5nX2RnbV9yZWFkX3VuaXF1ZShpbnQgZmQsIHVp
bnQ2NF90ICpwdW5pcXVlKQogCX0KIAlidWZbcndfcmV0XSA9ICdcMCc7CiAKLQl1bmlxdWUgPSBz
dHJ0b3VsbF9lcnIoYnVmLCAmZW5kcHRyLCAxMCwgJmVycm9yKTsKKwl1bmlxdWUgPSBzbWJfc3Ry
dG91bGwoYnVmLCAmZW5kcHRyLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAo
ZXJyb3IgIT0gMCkgewogCQlyZXR1cm4gZXJyb3I7CiAJfQpAQCAtMTY0MCw3ICsxNjQwLDcgQEAg
aW50IG1lc3NhZ2luZ19kZ21fZm9yYWxsKGludCAoKmZuKShwaWRfdCBwaWQsIHZvaWQgKnByaXZh
dGVfZGF0YSksCiAJCXVuc2lnbmVkIGxvbmcgcGlkOwogCQlpbnQgcmV0OwogCi0JCXBpZCA9IHN0
cnRvdWxfZXJyKGRwLT5kX25hbWUsIE5VTEwsIDEwLCAmZXJyb3IpOworCQlwaWQgPSBzbWJfc3Ry
dG91bChkcC0+ZF9uYW1lLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJ
aWYgKChwaWQgPT0gMCkgfHwgKGVycm9yICE9IDApKSB7CiAJCQkvKgogCQkJICogLiBhbmQgLi4g
YW5kIG90aGVyIG1hbGZvcm1lZCBlbnRyaWVzCmRpZmYgLS1naXQgYS9zb3VyY2UzL2xpYi9uYW1l
bWFwX2NhY2hlLmMgYi9zb3VyY2UzL2xpYi9uYW1lbWFwX2NhY2hlLmMKaW5kZXggNDI2NTZlZGUw
YjcuLjcwNzViN2M1YjFlIDEwMDY0NAotLS0gYS9zb3VyY2UzL2xpYi9uYW1lbWFwX2NhY2hlLmMK
KysrIGIvc291cmNlMy9saWIvbmFtZW1hcF9jYWNoZS5jCkBAIC0xMDcsNyArMTA3LDYgQEAgc3Rh
dGljIHZvaWQgbmFtZW1hcF9jYWNoZV9maW5kX3NpZF9wYXJzZXIoCiAJY29uc3QgY2hhciAqbmFt
ZTsKIAljb25zdCBjaGFyICp0eXBlYnVmOwogCWludCBlcnJvciA9IDA7Ci0JY2hhciAqZW5kcHRy
OwogCXVuc2lnbmVkIGxvbmcgdHlwZTsKIAogCXN0YXRlLT5vayA9IGZhbHNlOwpAQCAtMTI1LDgg
KzEyNCw4IEBAIHN0YXRpYyB2b2lkIG5hbWVtYXBfY2FjaGVfZmluZF9zaWRfcGFyc2VyKAogCQly
ZXR1cm47CiAJfQogCi0JdHlwZSA9IHN0cnRvdWxfZXJyKHR5cGVidWYsICZlbmRwdHIsIDEwLCAm
ZXJyb3IpOwotCWlmICgoKmVuZHB0ciAhPSAnXDAnKSB8fCAoZXJyb3IgIT0gMCkpIHsKKwl0eXBl
ID0gc21iX3N0cnRvdWwodHlwZWJ1ZiwgTlVMTCwgMTAsICZlcnJvciwgU01CX1NUUl9GVUxMX1NU
Ul9DT05WKTsKKwlpZiAoZXJyb3IgIT0gMCkgewogCQlyZXR1cm47CiAJfQogCkBAIC0yNTEsNyAr
MjUwLDYgQEAgc3RhdGljIHZvaWQgbmFtZW1hcF9jYWNoZV9maW5kX25hbWVfcGFyc2VyKAogCWNv
bnN0IGNoYXIgKnNpZGJ1ZjsKIAljb25zdCBjaGFyICpzaWRfZW5kcHRyOwogCWNvbnN0IGNoYXIg
KnR5cGVidWY7Ci0JY2hhciAqZW5kcHRyOwogCWludCBlcnJvciA9IDA7CiAJc3RydWN0IGRvbV9z
aWQgc2lkOwogCXVuc2lnbmVkIGxvbmcgdHlwZTsKQEAgLTI3Niw4ICsyNzQsOCBAQCBzdGF0aWMg
dm9pZCBuYW1lbWFwX2NhY2hlX2ZpbmRfbmFtZV9wYXJzZXIoCiAJCXJldHVybjsKIAl9CiAKLQl0
eXBlID0gc3RydG91bF9lcnIodHlwZWJ1ZiwgJmVuZHB0ciwgMTAsICZlcnJvcik7Ci0JaWYgKCgq
ZW5kcHRyICE9ICdcMCcpIHx8IChlcnJvciAhPSAwKSkgeworCXR5cGUgPSBzbWJfc3RydG91bCh0
eXBlYnVmLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX0ZVTExfU1RSX0NPTlYpOworCWlmIChl
cnJvciAhPSAwKSB7CiAJCXJldHVybjsKIAl9CiAKZGlmZiAtLWdpdCBhL3NvdXJjZTMvbGliL3N5
c3F1b3Rhcy5jIGIvc291cmNlMy9saWIvc3lzcXVvdGFzLmMKaW5kZXggODY0ZDlkZDVjNTYuLjY2
NDM2ZTg2ZWZkIDEwMDY0NAotLS0gYS9zb3VyY2UzL2xpYi9zeXNxdW90YXMuYworKysgYi9zb3Vy
Y2UzL2xpYi9zeXNxdW90YXMuYwpAQCAtMzExLDcgKzMxMSwxMSBAQCBzdGF0aWMgaW50IGNvbW1h
bmRfZ2V0X3F1b3RhKGNvbnN0IGNoYXIgKnBhdGgsIGVudW0gU01CX1FVT1RBX1RZUEUgcXR5cGUs
IHVuaWRfdAogCiAJCQkvKiB3ZSBuZWVkIHRvIGRlYWwgd2l0aCBsb25nIGxvbmcgdW5zaWduZWQg
aGVyZSwgaWYgc3VwcG9ydGVkICovCiAKLQkJCWRwLT5xZmxhZ3MgPSBzdHJ0b3VsX2VycihsaW5l
LCAmcDIsIDEwLCAmZXJyb3IpOworCQkJZHAtPnFmbGFncyA9IHNtYl9zdHJ0b3VsKGxpbmUsCisJ
CQkJCQkgJnAyLAorCQkJCQkJIDEwLAorCQkJCQkJICZlcnJvciwKKwkJCQkJCSBTTUJfU1RSX1NU
QU5EQVJEKTsKIAkJCWlmIChlcnJvciAhPSAwKSB7CiAJCQkJZ290byBpbnZhbGlkX3BhcmFtOwog
CQkJfQpkaWZmIC0tZ2l0IGEvc291cmNlMy9saWIvdGxkYXBfdXRpbC5jIGIvc291cmNlMy9saWIv
dGxkYXBfdXRpbC5jCmluZGV4IDc4ZWQ0MmJlMTc5Li4xNTI5NDJkYWIyYyAxMDA2NDQKLS0tIGEv
c291cmNlMy9saWIvdGxkYXBfdXRpbC5jCisrKyBiL3NvdXJjZTMvbGliL3RsZGFwX3V0aWwuYwpA
QCAtMzk5LDcgKzM5OSw3IEBAIGJvb2wgdGxkYXBfcHVsbF91aW50NjQoc3RydWN0IHRsZGFwX21l
c3NhZ2UgKm1zZywgY29uc3QgY2hhciAqYXR0ciwKIAkJcmV0dXJuIGZhbHNlOwogCX0KIAotCXJl
c3VsdCA9IHN0cnRvdWxsX2VycihzdHIsIE5VTEwsIDEwLCAmZXJyb3IpOworCXJlc3VsdCA9IHNt
Yl9zdHJ0b3VsbChzdHIsIE5VTEwsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCWlm
IChlcnJvciAhPSAwKSB7CiAJCURCR19ERUJVRygiQXR0cmlidXRlIGNvbnZlcnNpb24gZmFpbGVk
ICglcylcbiIsCiAJCQkgIHN0cmVycm9yKGVycm9yKSk7CmRpZmYgLS1naXQgYS9zb3VyY2UzL2xp
Yi91dGlsX3N0ci5jIGIvc291cmNlMy9saWIvdXRpbF9zdHIuYwppbmRleCAxYTI3MjI3ZmU0MS4u
ZTY2MGUyOTVjMzMgMTAwNjQ0Ci0tLSBhL3NvdXJjZTMvbGliL3V0aWxfc3RyLmMKKysrIGIvc291
cmNlMy9saWIvdXRpbF9zdHIuYwpAQCAtODUwLDIwICs4NTAsMjAgQEAgdWludDY0X3QgU1RSX1RP
X1NNQl9CSUdfVUlOVChjb25zdCBjaGFyICpucHRyLCBjb25zdCBjaGFyICoqZW50cHRyKQogdWlu
dDY0X3QgY29udl9zdHJfc2l6ZShjb25zdCBjaGFyICogc3RyKQogewogICAgICAgICB1aW50NjRf
dCBsdmFsOwotCWNoYXIgKiBlbmQ7CisgICAgICAgIGNoYXIgKmVuZDsKIAlpbnQgZXJyb3IgPSAw
OwogCiAgICAgICAgIGlmIChzdHIgPT0gTlVMTCB8fCAqc3RyID09ICdcMCcpIHsKICAgICAgICAg
ICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQogCi0JbHZhbCA9IHN0cnRvdWxsX2VycihzdHIs
ICZlbmQsIDEwLCAmZXJyb3IpOworCWx2YWwgPSBzbWJfc3RydG91bGwoc3RyLCAmZW5kLCAxMCwg
JmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAogICAgICAgICBpZiAoZXJyb3IgIT0gMCkgewog
ICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKCplbmQg
PT0gJ1wwJykgeworCWlmICgqZW5kID09ICdcMCcpIHsKIAkJcmV0dXJuIGx2YWw7CiAJfQogCmRp
ZmYgLS1naXQgYS9zb3VyY2UzL21vZHVsZXMvdmZzX2NlcGhfc25hcHNob3RzLmMgYi9zb3VyY2Uz
L21vZHVsZXMvdmZzX2NlcGhfc25hcHNob3RzLmMKaW5kZXggNDE4MzA2OWE1YzIuLjJkMTg0NDc0
OTJhIDEwMDY0NAotLS0gYS9zb3VyY2UzL21vZHVsZXMvdmZzX2NlcGhfc25hcHNob3RzLmMKKysr
IGIvc291cmNlMy9tb2R1bGVzL3Zmc19jZXBoX3NuYXBzaG90cy5jCkBAIC04MywyNSArODMsMjUg
QEAgc3RhdGljIGludCBjZXBoX3NuYXBfZ2V0X2J0aW1lKHN0cnVjdCB2ZnNfaGFuZGxlX3N0cnVj
dCAqaGFuZGxlLAogCiAJLyogRmlyc3QgY29tcG9uZW50IGlzIHNlY29uZHMsIGV4dHJhY3QgaXQg
Ki8KIAkqcyA9ICdcMCc7Ci0Jc25hcF90aW1lc3BlYy50dl9zZWMgPSBzdHJ0b3VsbF9lcnIoc25h
cF9idGltZSwgJmVuZHB0ciwgMTAsICZlcnIpOworCXNuYXBfdGltZXNwZWMudHZfc2VjID0gc21i
X3N0cnRvdWxsKHNuYXBfYnRpbWUsCisJCQkJCSAgICAmZW5kcHRyLAorCQkJCQkgICAgMTAsCisJ
CQkJCSAgICAmZXJyLAorCQkJCQkgICAgU01CX1NUUl9GVUxMX1NUUl9DT05WKTsKIAlpZiAoZXJy
ICE9IDApIHsKIAkJcmV0dXJuIC1lcnI7CiAJfQotCWlmICgoZW5kcHRyID09IHNuYXBfYnRpbWUp
IHx8ICgqZW5kcHRyICE9ICdcMCcpKSB7Ci0JCURCR19FUlIoImNvdWxkbid0IHByb2Nlc3Mgc25h
cC50dl9zZWMgaW4gJXNcbiIsIHNuYXBfYnRpbWUpOwotCQlyZXR1cm4gLUVJTlZBTDsKLQl9CiAK
IAkvKiBzZWNvbmQgY29tcG9uZW50IGlzIG5zZWNzICovCiAJcysrOwotCXNuYXBfdGltZXNwZWMu
dHZfbnNlYyA9IHN0cnRvdWxfZXJyKHMsICZlbmRwdHIsIDEwLCAmZXJyKTsKKwlzbmFwX3RpbWVz
cGVjLnR2X25zZWMgPSBzbWJfc3RydG91bChzLAorCQkJCQkgICAgJmVuZHB0ciwKKwkJCQkJICAg
IDEwLAorCQkJCQkgICAgJmVyciwKKwkJCQkJICAgIFNNQl9TVFJfRlVMTF9TVFJfQ09OVik7CiAJ
aWYgKGVyciAhPSAwKSB7CiAJCXJldHVybiAtZXJyOwogCX0KLQlpZiAoKGVuZHB0ciA9PSBzKSB8
fCAoKmVuZHB0ciAhPSAnXDAnKSkgewotCQlEQkdfRVJSKCJjb3VsZG4ndCBwcm9jZXNzIHNuYXAu
dHZfbnNlYyBpbiAlc1xuIiwgcyk7Ci0JCXJldHVybiAtRUlOVkFMOwotCX0KIAogCS8qCiAJICog
Pj4gMzAgaXMgYSByb3VnaCBkaXZpZGUgYnkgfjEwKio5LiBObyBuZWVkIHRvIGJlIGV4YWN0LCBh
cyBAR01UCmRpZmYgLS1naXQgYS9zb3VyY2UzL21vZHVsZXMvdmZzX3ByZW9wZW4uYyBiL3NvdXJj
ZTMvbW9kdWxlcy92ZnNfcHJlb3Blbi5jCmluZGV4IDI0ZDMzZmFmYWNkLi5jNzJiYjk5YmJlZiAx
MDA2NDQKLS0tIGEvc291cmNlMy9tb2R1bGVzL3Zmc19wcmVvcGVuLmMKKysrIGIvc291cmNlMy9t
b2R1bGVzL3Zmc19wcmVvcGVuLmMKQEAgLTM2NCw3ICszNjQsNyBAQCBzdGF0aWMgYm9vbCBwcmVv
cGVuX3BhcnNlX2ZuYW1lKGNvbnN0IGNoYXIgKmZuYW1lLCB1bnNpZ25lZCBsb25nICpwbnVtLAog
CQlyZXR1cm4gZmFsc2U7CiAJfQogCi0JbnVtID0gc3RydG91bF9lcnIocCwgKGNoYXIgKiopJnEs
IDEwLCAmZXJyb3IpOworCW51bSA9IHNtYl9zdHJ0b3VsKHAsIChjaGFyICoqKSZxLCAxMCwgJmVy
cm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQlyZXR1cm4gZmFs
c2U7CiAJfQpkaWZmIC0tZ2l0IGEvc291cmNlMy9tb2R1bGVzL3Zmc19zbmFwcGVyLmMgYi9zb3Vy
Y2UzL21vZHVsZXMvdmZzX3NuYXBwZXIuYwppbmRleCAzOWI4Y2NiMDk3YS4uZDg2MmViMzE1MWQg
MTAwNjQ0Ci0tLSBhL3NvdXJjZTMvbW9kdWxlcy92ZnNfc25hcHBlci5jCisrKyBiL3NvdXJjZTMv
bW9kdWxlcy92ZnNfc25hcHBlci5jCkBAIC0xMjUwLDcgKzEyNTAsNyBAQCBzdGF0aWMgTlRTVEFU
VVMgc25hcHBlcl9zbmFwX3BhdGhfdG9faWQoVEFMTE9DX0NUWCAqbWVtX2N0eCwKIAl9CiAKIAlz
dHJfaWR4Kys7Ci0Jc25hcF9pZCA9IHN0cnRvdWxfZXJyKHN0cl9pZHgsIE5VTEwsIDEwLCAmZXJy
b3IpOworCXNuYXBfaWQgPSBzbWJfc3RydG91bChzdHJfaWR4LCBOVUxMLCAxMCwgJmVycm9yLCBT
TUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQl0YWxsb2NfZnJlZShwYXRo
X2R1cCk7CiAJCXJldHVybiBOVF9TVEFUVVNfSU5WQUxJRF9QQVJBTUVURVI7CmRpZmYgLS1naXQg
YS9zb3VyY2UzL21vZHVsZXMvdmZzX3VuaXR5ZWRfbWVkaWEuYyBiL3NvdXJjZTMvbW9kdWxlcy92
ZnNfdW5pdHllZF9tZWRpYS5jCmluZGV4IDA2YmJlOTk0MDJjLi40MzI4NTE5MWNkMiAxMDA2NDQK
LS0tIGEvc291cmNlMy9tb2R1bGVzL3Zmc191bml0eWVkX21lZGlhLmMKKysrIGIvc291cmNlMy9t
b2R1bGVzL3Zmc191bml0eWVkX21lZGlhLmMKQEAgLTEwMCw3ICsxMDAsNiBAQCB0eXBlZGVmIHN0
cnVjdCB1bV9kaXJpbmZvX3N0cnVjdCB7CiBzdGF0aWMgYm9vbCBnZXRfZGlnaXRfZ3JvdXAoY29u
c3QgY2hhciAqcGF0aCwgdWludG1heF90ICpkaWdpdCkKIHsKIAljb25zdCBjaGFyICpwID0gcGF0
aDsKLQljaGFyICplbmRwID0gTlVMTDsKIAljb2RlcG9pbnRfdCBjcDsKIAlzaXplX3Qgc2l6ZTsK
IAlpbnQgZXJyb3IgPSAwOwpAQCAtMTIxLDcgKzEyMCwxMSBAQCBzdGF0aWMgYm9vbCBnZXRfZGln
aXRfZ3JvdXAoY29uc3QgY2hhciAqcGF0aCwgdWludG1heF90ICpkaWdpdCkKIAkJCXJldHVybiBm
YWxzZTsKIAkJfQogCQlpZiAoKHNpemUgPT0gMSkgJiYgKGlzZGlnaXQoY3ApKSkgewotCQkJKmRp
Z2l0ID0gKHVpbnRtYXhfdClzdHJ0b3VsX2VycihwLCAmZW5kcCwgMTAsICZlcnJvcik7CisJCQkq
ZGlnaXQgPSAodWludG1heF90KXNtYl9zdHJ0b3VsKHAsCisJCQkJCQkJTlVMTCwKKwkJCQkJCQkx
MCwKKwkJCQkJCQkmZXJyb3IsCisJCQkJCQkJU01CX1NUUl9TVEFOREFSRCk7CiAJCQlpZiAoZXJy
b3IgIT0gMCkgewogCQkJCXJldHVybiBmYWxzZTsKIAkJCX0KZGlmZiAtLWdpdCBhL3NvdXJjZTMv
cGFzc2RiL2FjY291bnRfcG9sLmMgYi9zb3VyY2UzL3Bhc3NkYi9hY2NvdW50X3BvbC5jCmluZGV4
IDRhMTgwY2IxOWJkLi5lZTY2NzgxNWJjMSAxMDA2NDQKLS0tIGEvc291cmNlMy9wYXNzZGIvYWNj
b3VudF9wb2wuYworKysgYi9zb3VyY2UzL3Bhc3NkYi9hY2NvdW50X3BvbC5jCkBAIC00NTksNyAr
NDU5LDExIEBAIGJvb2wgY2FjaGVfYWNjb3VudF9wb2xpY3lfZ2V0KGVudW0gcGRiX3BvbGljeV90
eXBlIHR5cGUsIHVpbnQzMl90ICp2YWx1ZSkKIAkJaW50IGVycm9yID0gMDsKIAkJdWludDMyX3Qg
dG1wOwogCi0JCXRtcCA9IHN0cnRvdWxfZXJyKGNhY2hlX3ZhbHVlLCBOVUxMLCAxMCwgJmVycm9y
KTsKKwkJdG1wID0gc21iX3N0cnRvdWwoY2FjaGVfdmFsdWUsCisJCQkJICBOVUxMLAorCQkJCSAg
MTAsCisJCQkJICAmZXJyb3IsCisJCQkJICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKGVycm9y
ICE9IDApIHsKIAkJCWdvdG8gZG9uZTsKIAkJfQpkaWZmIC0tZ2l0IGEvc291cmNlMy9wYXNzZGIv
cGRiX2xkYXAuYyBiL3NvdXJjZTMvcGFzc2RiL3BkYl9sZGFwLmMKaW5kZXggODVlOWRiOGJiMWYu
LjNkYmM4ZjlmMDdhIDEwMDY0NAotLS0gYS9zb3VyY2UzL3Bhc3NkYi9wZGJfbGRhcC5jCisrKyBi
L3NvdXJjZTMvcGFzc2RiL3BkYl9sZGFwLmMKQEAgLTk5Niw3ICs5OTYsMTEgQEAgc3RhdGljIGJv
b2wgaW5pdF9zYW1fZnJvbV9sZGFwKHN0cnVjdCBsZGFwc2FtX3ByaXZhdGVzICpsZGFwX3N0YXRl
LAogCQkJCWN0eCk7CiAJCWlmICh0ZW1wKSB7CiAJCQkvKiBXZSd2ZSBnb3QgYSB1aWQsIGZlZWQg
dGhlIGNhY2hlICovCi0JCQl1bml4X3B3LnB3X3VpZCA9IHN0cnRvdWxfZXJyKHRlbXAsIE5VTEws
IDEwLCAmZXJyb3IpOworCQkJdW5peF9wdy5wd191aWQgPSBzbWJfc3RydG91bCh0ZW1wLAorCQkJ
CQkJICAgICBOVUxMLAorCQkJCQkJICAgICAxMCwKKwkJCQkJCSAgICAgJmVycm9yLAorCQkJCQkJ
ICAgICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJCWlmIChlcnJvciAhPSAwKSB7CiAJCQkJREJHX0VS
UigiRmFpbGVkIHRvIGNvbnZlcnQgVUlEXG4iKTsKIAkJCQlnb3RvIGZuX2V4aXQ7CkBAIC0xMDEw
LDcgKzEwMTQsMTEgQEAgc3RhdGljIGJvb2wgaW5pdF9zYW1fZnJvbV9sZGFwKHN0cnVjdCBsZGFw
c2FtX3ByaXZhdGVzICpsZGFwX3N0YXRlLAogCQkJCWN0eCk7CiAJCWlmICh0ZW1wKSB7CiAJCQkv
KiBXZSd2ZSBnb3QgYSB1aWQsIGZlZWQgdGhlIGNhY2hlICovCi0JCQl1bml4X3B3LnB3X2dpZCA9
IHN0cnRvdWxfZXJyKHRlbXAsIE5VTEwsIDEwLCAmZXJyb3IpOworCQkJdW5peF9wdy5wd19naWQg
PSBzbWJfc3RydG91bCh0ZW1wLAorCQkJCQkJICAgICBOVUxMLAorCQkJCQkJICAgICAxMCwKKwkJ
CQkJCSAgICAgJmVycm9yLAorCQkJCQkJICAgICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJCWlmIChl
cnJvciAhPSAwKSB7CiAJCQkJREJHX0VSUigiRmFpbGVkIHRvIGNvbnZlcnQgR0lEXG4iKTsKIAkJ
CQlnb3RvIGZuX2V4aXQ7CkBAIC0yOTM4LDcgKzI5NDYsMTEgQEAgc3RhdGljIE5UU1RBVFVTIGxk
YXBzYW1fZW51bV9ncm91cF9tZW1iZXJzaGlwcyhzdHJ1Y3QgcGRiX21ldGhvZHMgKm1ldGhvZHMs
CiAJCQkJcmV0ID0gTlRfU1RBVFVTX0lOVEVSTkFMX0RCX0NPUlJVUFRJT047CiAJCQkJZ290byBk
b25lOwogCQkJfQotCQkJcHJpbWFyeV9naWQgPSBzdHJ0b3VsX2VycihnaWRzdHIsIE5VTEwsIDEw
LCAmZXJyb3IpOworCQkJcHJpbWFyeV9naWQgPSBzbWJfc3RydG91bChnaWRzdHIsCisJCQkJCQkg
IE5VTEwsCisJCQkJCQkgIDEwLAorCQkJCQkJICAmZXJyb3IsCisJCQkJCQkgIFNNQl9TVFJfU1RB
TkRBUkQpOwogCQkJaWYgKGVycm9yICE9IDApIHsKIAkJCQlEQkdfRVJSKCJGYWlsZWQgdG8gY29u
dmVydCBHSURcbiIpOwogCQkJCWdvdG8gZG9uZTsKQEAgLTI5OTUsNyArMzAwNyw2IEBAIHN0YXRp
YyBOVFNUQVRVUyBsZGFwc2FtX2VudW1fZ3JvdXBfbWVtYmVyc2hpcHMoc3RydWN0IHBkYl9tZXRo
b2RzICptZXRob2RzLAogCQlmc3RyaW5nIHN0cjsKIAkJc3RydWN0IGRvbV9zaWQgc2lkOwogCQln
aWRfdCBnaWQ7Ci0JCWNoYXIgKmVuZDsKIAogCQlpZiAoIXNtYmxkYXBfZ2V0X3NpbmdsZV9hdHRy
aWJ1dGUoc21ibGRhcF9nZXRfbGRhcChjb25uKSwKIAkJCQkJCSAgZW50cnksICJzYW1iYVNJRCIs
CkBAIC0zMDEwLDkgKzMwMjEsOSBAQCBzdGF0aWMgTlRTVEFUVVMgbGRhcHNhbV9lbnVtX2dyb3Vw
X21lbWJlcnNoaXBzKHN0cnVjdCBwZGJfbWV0aG9kcyAqbWV0aG9kcywKIAkJCQkJCSAgc3RyLCBz
aXplb2Yoc3RyKS0xKSkKIAkJCWNvbnRpbnVlOwogCi0JCWdpZCA9IHN0cnRvdWxfZXJyKHN0ciwg
JmVuZCwgMTAsICZlcnJvcik7CisJCWdpZCA9IHNtYl9zdHJ0b3VsKHN0ciwgTlVMTCwgMTAsICZl
cnJvciwgU01CX1NUUl9GVUxMX1NUUl9DT05WKTsKIAotCQlpZiAoKFBUUl9ESUZGKGVuZCwgc3Ry
KSAhPSBzdHJsZW4oc3RyKSkgfHwgKGVycm9yICE9IDApKSB7CisJCWlmIChlcnJvciAhPSAwKSB7
CiAJCQlnb3RvIGRvbmU7CiAJCX0KIApAQCAtNDk3Niw3ICs0OTg3LDExIEBAIHN0YXRpYyBOVFNU
QVRVUyBsZGFwc2FtX2dldF9uZXdfcmlkKHN0cnVjdCBsZGFwc2FtX3ByaXZhdGVzICpwcml2LAog
CXZhbHVlID0gc21ibGRhcF90YWxsb2Nfc2luZ2xlX2F0dHJpYnV0ZShwcml2MmxkKHByaXYpLCBl
bnRyeSwKIAkJCQkJCSJzYW1iYU5leHRSaWQiLAltZW1fY3R4KTsKIAlpZiAodmFsdWUgIT0gTlVM
TCkgewotCQl0bXAgPSAodWludDMyX3Qpc3RydG91bF9lcnIodmFsdWUsIE5VTEwsIDEwLCAmZXJy
b3IpOworCQl0bXAgPSAodWludDMyX3Qpc21iX3N0cnRvdWwodmFsdWUsCisJCQkJCSAgICBOVUxM
LAorCQkJCQkgICAgMTAsCisJCQkJCSAgICAmZXJyb3IsCisJCQkJCSAgICBTTUJfU1RSX1NUQU5E
QVJEKTsKIAkJaWYgKGVycm9yICE9IDApIHsKIAkJCWdvdG8gZG9uZTsKIAkJfQpAQCAtNDk4Nyw3
ICs1MDAyLDExIEBAIHN0YXRpYyBOVFNUQVRVUyBsZGFwc2FtX2dldF9uZXdfcmlkKHN0cnVjdCBs
ZGFwc2FtX3ByaXZhdGVzICpwcml2LAogCXZhbHVlID0gc21ibGRhcF90YWxsb2Nfc2luZ2xlX2F0
dHJpYnV0ZShwcml2MmxkKHByaXYpLCBlbnRyeSwKIAkJCQkJCSJzYW1iYU5leHRVc2VyUmlkIiwg
bWVtX2N0eCk7CiAJaWYgKHZhbHVlICE9IE5VTEwpIHsKLQkJdG1wID0gKHVpbnQzMl90KXN0cnRv
dWxfZXJyKHZhbHVlLCBOVUxMLCAxMCwgJmVycm9yKTsKKwkJdG1wID0gKHVpbnQzMl90KXNtYl9z
dHJ0b3VsKHZhbHVlLAorCQkJCQkgICAgTlVMTCwKKwkJCQkJICAgIDEwLAorCQkJCQkgICAgJmVy
cm9yLAorCQkJCQkgICAgU01CX1NUUl9TVEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwKSB7CiAJ
CQlnb3RvIGRvbmU7CiAJCX0KQEAgLTQ5OTgsNyArNTAxNywxMSBAQCBzdGF0aWMgTlRTVEFUVVMg
bGRhcHNhbV9nZXRfbmV3X3JpZChzdHJ1Y3QgbGRhcHNhbV9wcml2YXRlcyAqcHJpdiwKIAl2YWx1
ZSA9IHNtYmxkYXBfdGFsbG9jX3NpbmdsZV9hdHRyaWJ1dGUocHJpdjJsZChwcml2KSwgZW50cnks
CiAJCQkJCQkic2FtYmFOZXh0R3JvdXBSaWQiLCBtZW1fY3R4KTsKIAlpZiAodmFsdWUgIT0gTlVM
TCkgewotCQl0bXAgPSAodWludDMyX3Qpc3RydG91bF9lcnIodmFsdWUsIE5VTEwsIDEwLCAmZXJy
b3IpOworCQl0bXAgPSAodWludDMyX3Qpc21iX3N0cnRvdWwodmFsdWUsCisJCQkJCSAgICBOVUxM
LAorCQkJCQkgICAgMTAsCisJCQkJCSAgICAmZXJyb3IsCisJCQkJCSAgICBTTUJfU1RSX1NUQU5E
QVJEKTsKIAkJaWYgKGVycm9yICE9IDApIHsKIAkJCWdvdG8gZG9uZTsKIAkJfQpAQCAtNTEzNiw3
ICs1MTU5LDExIEBAIHN0YXRpYyBib29sIGxkYXBzYW1fc2lkX3RvX2lkKHN0cnVjdCBwZGJfbWV0
aG9kcyAqbWV0aG9kcywKIAkJCWdvdG8gZG9uZTsKIAkJfQogCi0JCWlkLT5pZCA9IHN0cnRvdWxf
ZXJyKGdpZF9zdHIsIE5VTEwsIDEwLCAmZXJyb3IpOworCQlpZC0+aWQgPSBzbWJfc3RydG91bChn
aWRfc3RyLAorCQkJCSAgICAgTlVMTCwKKwkJCQkgICAgIDEwLAorCQkJCSAgICAgJmVycm9yLAor
CQkJCSAgICAgU01CX1NUUl9TVEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwKSB7CiAJCQlnb3Rv
IGRvbmU7CiAJCX0KQEAgLTUxNTYsNyArNTE4Myw3IEBAIHN0YXRpYyBib29sIGxkYXBzYW1fc2lk
X3RvX2lkKHN0cnVjdCBwZGJfbWV0aG9kcyAqbWV0aG9kcywKIAkJZ290byBkb25lOwogCX0KIAot
CWlkLT5pZCA9IHN0cnRvdWxfZXJyKHZhbHVlLCBOVUxMLCAxMCwgJmVycm9yKTsKKwlpZC0+aWQg
PSBzbWJfc3RydG91bCh2YWx1ZSwgTlVMTCwgMTAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7
CiAJaWYgKGVycm9yICE9IDApIHsKIAkJZ290byBkb25lOwogCX0KQEAgLTU3NDcsNyArNTc3NCw3
IEBAIHN0YXRpYyBOVFNUQVRVUyBsZGFwc2FtX2NyZWF0ZV9kb21fZ3JvdXAoc3RydWN0IHBkYl9t
ZXRob2RzICpteV9tZXRob2RzLAogCQkJcmV0dXJuIE5UX1NUQVRVU19JTlRFUk5BTF9EQl9DT1JS
VVBUSU9OOwogCQl9CiAKLQkJZ2lkID0gc3RydG91bF9lcnIodG1wLCBOVUxMLCAxMCwgJmVycm9y
KTsKKwkJZ2lkID0gc21iX3N0cnRvdWwodG1wLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NU
QU5EQVJEKTsKIAkJaWYgKGVycm9yICE9IDApIHsKIAkJCURCR19FUlIoIkZhaWxlZCB0byBjb252
ZXJ0IGdpZE51bWJlclxuIik7CiAJCQlyZXR1cm4gTlRfU1RBVFVTX1VOU1VDQ0VTU0ZVTDsKQEAg
LTYwMjQsNyArNjA1MSw3IEBAIHN0YXRpYyBOVFNUQVRVUyBsZGFwc2FtX2NoYW5nZV9ncm91cG1l
bShzdHJ1Y3QgcGRiX21ldGhvZHMgKm15X21ldGhvZHMsCiAJCQlyZXR1cm4gTlRfU1RBVFVTX0lO
VEVSTkFMX0RCX0NPUlJVUFRJT047CiAJCX0KIAotCQl1c2VyX2dpZCA9IHN0cnRvdWxfZXJyKGdp
ZHN0ciwgTlVMTCwgMTAsICZlcnJvcik7CisJCXVzZXJfZ2lkID0gc21iX3N0cnRvdWwoZ2lkc3Ry
LCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKGVycm9yICE9IDAp
IHsKIAkJCURCR19FUlIoIkZhaWxlZCB0byBjb252ZXJ0IHVzZXIgZ2lkXG4iKTsKIAkJCXJldHVy
biBOVF9TVEFUVVNfVU5TVUNDRVNTRlVMOwpkaWZmIC0tZ2l0IGEvc291cmNlMy9wYXNzZGIvcGRi
X3RkYi5jIGIvc291cmNlMy9wYXNzZGIvcGRiX3RkYi5jCmluZGV4IDA2NzE1MDMzNGEzLi4wYzk3
ZTcwYmFkNCAxMDA2NDQKLS0tIGEvc291cmNlMy9wYXNzZGIvcGRiX3RkYi5jCisrKyBiL3NvdXJj
ZTMvcGFzc2RiL3BkYl90ZGIuYwpAQCAtMTE4Myw3ICsxMTgzLDExIEBAIHN0YXRpYyBpbnQgdGRi
c2FtX2NvbGxlY3RfcmlkcyhzdHJ1Y3QgZGJfcmVjb3JkICpyZWMsIHZvaWQgKnByaXZhdGVfZGF0
YSkKIAkJcmV0dXJuIDA7CiAJfQogCi0JcmlkID0gc3RydG91bF9lcnIoKGNoYXIgKilrZXkuZHB0
citwcmVmaXhsZW4sIE5VTEwsIDE2LCAmZXJyb3IpOworCXJpZCA9IHNtYl9zdHJ0b3VsKChjaGFy
ICopa2V5LmRwdHIrcHJlZml4bGVuLAorCQkJICBOVUxMLAorCQkJICAxNiwKKwkJCSAgJmVycm9y
LAorCQkJICBTTUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQlyZXR1cm4g
MDsKIAl9CmRpZmYgLS1naXQgYS9zb3VyY2UzL3JwY2NsaWVudC9jbWRfc2Ftci5jIGIvc291cmNl
My9ycGNjbGllbnQvY21kX3NhbXIuYwppbmRleCA3YTM4NTViMWI0Yy4uOGNiZjhhYjI0YmQgMTAw
NjQ0Ci0tLSBhL3NvdXJjZTMvcnBjY2xpZW50L2NtZF9zYW1yLmMKKysrIGIvc291cmNlMy9ycGNj
bGllbnQvY21kX3NhbXIuYwpAQCAtMTQxMyw3ICsxNDEzLDcgQEAgc3RhdGljIE5UU1RBVFVTIGNt
ZF9zYW1yX2RlbGV0ZV9hbGlhcyhzdHJ1Y3QgcnBjX3BpcGVfY2xpZW50ICpjbGksCiAJCXJldHVy
biBOVF9TVEFUVVNfT0s7CiAJfQogCi0JYWxpYXNfcmlkID0gc3RydG91bF9lcnIoYXJndlsyXSwg
TlVMTCwgMTAsICZlcnJvcik7CisJYWxpYXNfcmlkID0gc21iX3N0cnRvdWwoYXJndlsyXSwgTlVM
TCwgMTAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKGVycm9yICE9IDApIHsKIAkJ
cmV0dXJuIE5UX1NUQVRVU19JTlZBTElEX1BBUkFNRVRFUjsKIAl9CmRpZmYgLS1naXQgYS9zb3Vy
Y2UzL3JwY2NsaWVudC9jbWRfc3Bvb2xzcy5jIGIvc291cmNlMy9ycGNjbGllbnQvY21kX3Nwb29s
c3MuYwppbmRleCBmNmQ2MzE3NjFiMi4uNzhjMzgxYjlhNTkgMTAwNjQ0Ci0tLSBhL3NvdXJjZTMv
cnBjY2xpZW50L2NtZF9zcG9vbHNzLmMKKysrIGIvc291cmNlMy9ycGNjbGllbnQvY21kX3Nwb29s
c3MuYwpAQCAtMjcwOCw3ICsyNzA4LDExIEBAIHN0YXRpYyBXRVJST1IgY21kX3Nwb29sc3Nfc2V0
cHJpbnRlcmRhdGEoc3RydWN0IHJwY19waXBlX2NsaWVudCAqY2xpLAogCQlXX0VSUk9SX0hBVkVf
Tk9fTUVNT1JZKGRhdGEuc3RyaW5nKTsKIAkJYnJlYWs7CiAJY2FzZSBSRUdfRFdPUkQ6Ci0JCWRh
dGEudmFsdWUgPSBzdHJ0b3VsX2Vycihhcmd2WzRdLCBOVUxMLCAxMCwgJmVycm9yKTsKKwkJZGF0
YS52YWx1ZSA9IHNtYl9zdHJ0b3VsKGFyZ3ZbNF0sCisJCQkJCSBOVUxMLAorCQkJCQkgMTAsCisJ
CQkJCSAmZXJyb3IsCisJCQkJCSBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKGVycm9yICE9IDAp
IHsKIAkJCXJlc3VsdCA9IFdFUlJfSU5WQUxJRF9QQVJBTUVURVI7CiAJCQlnb3RvIGRvbmU7CmRp
ZmYgLS1naXQgYS9zb3VyY2UzL3V0aWxzL25ldF9pZG1hcC5jIGIvc291cmNlMy91dGlscy9uZXRf
aWRtYXAuYwppbmRleCBkMWE2ZGI5NTkyMS4uMGFhNDVmNzQyY2QgMTAwNjQ0Ci0tLSBhL3NvdXJj
ZTMvdXRpbHMvbmV0X2lkbWFwLmMKKysrIGIvc291cmNlMy91dGlscy9uZXRfaWRtYXAuYwpAQCAt
NjI3LDExICs2MjcsMTAgQEAgZG9uZToKIHN0YXRpYyBib29sIHBhcnNlX3VpbnQzMihjb25zdCBj
aGFyICpzdHIsIHVpbnQzMl90ICpyZXN1bHQpCiB7CiAJdW5zaWduZWQgbG9uZyB2YWw7Ci0JY2hh
ciAqZW5kcHRyOwogCWludCBlcnJvciA9IDA7CiAKLQl2YWwgPSBzdHJ0b3VsX2VycihzdHIsICZl
bmRwdHIsIDEwLCAmZXJyb3IpOwotCWlmIChlcnJvciAhPSAwIHx8ICplbmRwdHIgIT0gJ1wwJykg
eworCXZhbCA9IHNtYl9zdHJ0b3VsKHN0ciwgTlVMTCwgMTAsICZlcnJvciwgU01CX1NUUl9GVUxM
X1NUUl9DT05WKTsKKwlpZiAoZXJyb3IgIT0gMCkgewogCQlyZXR1cm4gZmFsc2U7CiAJfQogCmRp
ZmYgLS1naXQgYS9zb3VyY2UzL3V0aWxzL25ldF9yZWdpc3RyeS5jIGIvc291cmNlMy91dGlscy9u
ZXRfcmVnaXN0cnkuYwppbmRleCA3NDIyNGRkYmYxNS4uYzZhNjgxZGU0MmIgMTAwNjQ0Ci0tLSBh
L3NvdXJjZTMvdXRpbHMvbmV0X3JlZ2lzdHJ5LmMKKysrIGIvc291cmNlMy91dGlscy9uZXRfcmVn
aXN0cnkuYwpAQCAtNTEyLDcgKzUxMiw3IEBAIHN0YXRpYyBpbnQgbmV0X3JlZ2lzdHJ5X3NldHZh
bHVlKHN0cnVjdCBuZXRfY29udGV4dCAqYywgaW50IGFyZ2MsCiAJCWludCBlcnJvciA9IDA7CiAJ
CXVpbnQzMl90IHY7CiAKLQkJdiA9IHN0cnRvdWxfZXJyKGFyZ3ZbM10sIE5VTEwsIDEwLCAmZXJy
b3IpOworCQl2ID0gc21iX3N0cnRvdWwoYXJndlszXSwgTlVMTCwgMTAsICZlcnJvciwgU01CX1NU
Ul9TVEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwKSB7CiAJCQlnb3RvIGRvbmU7CiAJCX0KQEAg
LTY1MCw3ICs2NTAsMTEgQEAgc3RhdGljIGludCBuZXRfcmVnaXN0cnlfaW5jcmVtZW50KHN0cnVj
dCBuZXRfY29udGV4dCAqYywgaW50IGFyZ2MsCiAJaWYgKGFyZ2MgPT0gMykgewogCQlpbnQgZXJy
b3IgPSAwOwogCi0JCXN0YXRlLmluY3JlbWVudCA9IHN0cnRvdWxfZXJyKGFyZ3ZbMl0sIE5VTEws
IDEwLCAmZXJyb3IpOworCQlzdGF0ZS5pbmNyZW1lbnQgPSBzbWJfc3RydG91bChhcmd2WzJdLAor
CQkJCQkgICAgICBOVUxMLAorCQkJCQkgICAgICAxMCwKKwkJCQkJICAgICAgJmVycm9yLAorCQkJ
CQkgICAgICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJaWYgKGVycm9yICE9IDApIHsKIAkJCWdvdG8g
ZG9uZTsKIAkJfQpkaWZmIC0tZ2l0IGEvc291cmNlMy91dGlscy9uZXRfcnBjX3JlZ2lzdHJ5LmMg
Yi9zb3VyY2UzL3V0aWxzL25ldF9ycGNfcmVnaXN0cnkuYwppbmRleCA4NDkzNmVlMzFhZS4uZTQ3
YmFkNGUzM2YgMTAwNjQ0Ci0tLSBhL3NvdXJjZTMvdXRpbHMvbmV0X3JwY19yZWdpc3RyeS5jCisr
KyBiL3NvdXJjZTMvdXRpbHMvbmV0X3JwY19yZWdpc3RyeS5jCkBAIC02MDYsNyArNjA2LDcgQEAg
c3RhdGljIE5UU1RBVFVTIHJwY19yZWdpc3RyeV9zZXR2YWx1ZV9pbnRlcm5hbChzdHJ1Y3QgbmV0
X2NvbnRleHQgKmMsCiAJCWludCBlcnJvciA9IDA7CiAJCXVpbnQzMl90IHY7CiAKLQkJdiA9IHN0
cnRvdWxfZXJyKGFyZ3ZbM10sIE5VTEwsIDEwLCAmZXJyb3IpOworCQl2ID0gc21iX3N0cnRvdWwo
YXJndlszXSwgTlVMTCwgMTAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJCWlmIChlcnJv
ciAhPSAwKSB7CiAJCQlnb3RvIGVycm9yOwogCQl9CmRpZmYgLS1naXQgYS9zb3VyY2UzL3V0aWxz
L25ldF9zYW0uYyBiL3NvdXJjZTMvdXRpbHMvbmV0X3NhbS5jCmluZGV4IDE2NGQ5NDA4YzU2Li43
NGU1MDBmMGYzMSAxMDA2NDQKLS0tIGEvc291cmNlMy91dGlscy9uZXRfc2FtLmMKKysrIGIvc291
cmNlMy91dGlscy9uZXRfc2FtLmMKQEAgLTQ4Myw3ICs0ODMsNiBAQCBzdGF0aWMgaW50IG5ldF9z
YW1fcG9saWN5X3NldChzdHJ1Y3QgbmV0X2NvbnRleHQgKmMsIGludCBhcmdjLCBjb25zdCBjaGFy
ICoqYXJndgogCXVpbnQzMl90IHZhbHVlID0gMDsKIAl1aW50MzJfdCBvbGRfdmFsdWUgPSAwOwog
CWVudW0gcGRiX3BvbGljeV90eXBlIGZpZWxkOwotCWNoYXIgKmVuZHB0cjsKIAlpbnQgZXJyID0g
MDsKIAogICAgICAgICBpZiAoYXJnYyAhPSAyIHx8IGMtPmRpc3BsYXlfdXNhZ2UpIHsKQEAgLTUw
MSw5ICs1MDAsMTMgQEAgc3RhdGljIGludCBuZXRfc2FtX3BvbGljeV9zZXQoc3RydWN0IG5ldF9j
b250ZXh0ICpjLCBpbnQgYXJnYywgY29uc3QgY2hhciAqKmFyZ3YKIAkJdmFsdWUgPSAtMTsKIAl9
CiAJZWxzZSB7Ci0JCXZhbHVlID0gc3RydG91bF9lcnIoYXJndlsxXSwgJmVuZHB0ciwgMTAsICZl
cnIpOworCQl2YWx1ZSA9IHNtYl9zdHJ0b3VsKGFyZ3ZbMV0sCisJCQkJICAgIE5VTEwsCisJCQkJ
ICAgIDEwLAorCQkJCSAgICAmZXJyLAorCQkJCSAgICBTTUJfU1RSX0ZVTExfU1RSX0NPTlYpOwog
Ci0JCWlmIChlcnIgIT0gMCB8fCAqZW5kcHRyICE9ICdcMCcpIHsKKwkJaWYgKGVyciAhPSAwKSB7
CiAJCQlkX3ByaW50ZihfKCJVbmFibGUgdG8gc2V0IHBvbGljeSBcIiVzXCIhIEludmFsaWQgdmFs
dWUgIgogCQkJCSAiXCIlc1wiLlxuIiksCiAJCQkJIGFjY291bnRfcG9saWN5LCBhcmd2WzFdKTsK
ZGlmZiAtLWdpdCBhL3NvdXJjZTMvdXRpbHMvcGRiZWRpdC5jIGIvc291cmNlMy91dGlscy9wZGJl
ZGl0LmMKaW5kZXggNDYyYzc1MzIxN2UuLjc0ZjhjM2IwYjJmIDEwMDY0NAotLS0gYS9zb3VyY2Uz
L3V0aWxzL3BkYmVkaXQuYworKysgYi9zb3VyY2UzL3V0aWxzL3BkYmVkaXQuYwpAQCAtNTk0LDE1
ICs1OTQsMTggQEAgc3RhdGljIGludCBzZXRfdXNlcl9pbmZvKGNvbnN0IGNoYXIgKnVzZXJuYW1l
LCBjb25zdCBjaGFyICpmdWxsbmFtZSwKIAl9CiAKIAlpZiAoa2lja29mZl90aW1lKSB7Ci0JCWNo
YXIgKmVuZHB0cjsKIAkJdGltZV90IHZhbHVlID0gZ2V0X3RpbWVfdF9tYXgoKTsKIAogCQlpZiAo
c3RyY21wKGtpY2tvZmZfdGltZSwgIm5ldmVyIikgIT0gMCkgewogCQkJaW50IGVycm9yID0gMDsK
IAkJCXVpbnQzMl90IG51bTsKIAotCQkJbnVtID0gc3RydG91bF9lcnIoa2lja29mZl90aW1lLCAm
ZW5kcHRyLCAxMCwgJmVycm9yKTsKLQkJCWlmIChlcnJvciAhPSAwIHx8ICplbmRwdHIgIT0gJ1ww
JykgeworCQkJbnVtID0gc21iX3N0cnRvdWwoa2lja29mZl90aW1lLAorCQkJCQkgIE5VTEwsCisJ
CQkJCSAgMTAsCisJCQkJCSAgJmVycm9yLAorCQkJCQkgIFNNQl9TVFJfRlVMTF9TVFJfQ09OVik7
CisJCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJCWZwcmludGYoc3RkZXJyLCAiRmFpbGVkIHRvIHBh
cnNlIGtpY2tvZmYgdGltZVxuIik7CiAJCQkJcmV0dXJuIC0xOwogCQkJfQpkaWZmIC0tZ2l0IGEv
c291cmNlMy91dGlscy9yZWdlZGl0X2RpYWxvZy5jIGIvc291cmNlMy91dGlscy9yZWdlZGl0X2Rp
YWxvZy5jCmluZGV4IDdkZDlmMGZhZGVhLi5jNzBkZDQ0YTc0MyAxMDA2NDQKLS0tIGEvc291cmNl
My91dGlscy9yZWdlZGl0X2RpYWxvZy5jCisrKyBiL3NvdXJjZTMvdXRpbHMvcmVnZWRpdF9kaWFs
b2cuYwpAQCAtMTAzMCw3ICsxMDMwLDYgQEAgYm9vbCBkaWFsb2dfc2VjdGlvbl90ZXh0X2ZpZWxk
X2dldF91aW50KHN0cnVjdCBkaWFsb2dfc2VjdGlvbiAqc2VjdGlvbiwKIAkJCQkgICAgICAgIHVu
c2lnbmVkIGxvbmcgbG9uZyAqb3V0KQogewogCWNvbnN0IGNoYXIgKmJ1ZjsKLQljaGFyICplbmRw
OwogCWludCBlcnJvciA9IDA7CiAJc3RydWN0IGRpYWxvZ19zZWN0aW9uX3RleHRfZmllbGQgKnRl
eHRfZmllbGQgPQogCQl0YWxsb2NfZ2V0X3R5cGVfYWJvcnQoc2VjdGlvbiwgc3RydWN0IGRpYWxv
Z19zZWN0aW9uX3RleHRfZmllbGQpOwpAQCAtMTA0MSw4ICsxMDQwLDggQEAgYm9vbCBkaWFsb2df
c2VjdGlvbl90ZXh0X2ZpZWxkX2dldF91aW50KHN0cnVjdCBkaWFsb2dfc2VjdGlvbiAqc2VjdGlv
biwKIAlpZiAoYnVmID09IE5VTEwpIHsKIAkJcmV0dXJuIGZhbHNlOwogCX0KLQkqb3V0ID0gc3Ry
dG91bGxfZXJyKGJ1ZiwgJmVuZHAsIDAsICZlcnJvcik7Ci0JaWYgKGVycm9yICE9IDAgfHwgKmVu
ZHAgIT0gJ1wwJykgeworCSpvdXQgPSBzbWJfc3RydG91bGwoYnVmLCBOVUxMLCAwLCAmZXJyb3Is
IFNNQl9TVFJfRlVMTF9TVFJfQ09OVik7CisJaWYgKGVycm9yICE9IDApIHsKIAkJcmV0dXJuIGZh
bHNlOwogCX0KIApkaWZmIC0tZ2l0IGEvc291cmNlMy93aW5iaW5kZC9pZG1hcF9sZGFwLmMgYi9z
b3VyY2UzL3dpbmJpbmRkL2lkbWFwX2xkYXAuYwppbmRleCA4MjJhYmI5ZjU1OS4uODZjYjZmMWJj
NTEgMTAwNjQ0Ci0tLSBhL3NvdXJjZTMvd2luYmluZGQvaWRtYXBfbGRhcC5jCisrKyBiL3NvdXJj
ZTMvd2luYmluZGQvaWRtYXBfbGRhcC5jCkBAIC0zMDAsNyArMzAwLDcgQEAgc3RhdGljIE5UU1RB
VFVTIGlkbWFwX2xkYXBfYWxsb2NhdGVfaWRfaW50ZXJuYWwoc3RydWN0IGlkbWFwX2RvbWFpbiAq
ZG9tLAogCQlnb3RvIGRvbmU7CiAJfQogCi0JeGlkLT5pZCA9IHN0cnRvdWxfZXJyKGlkX3N0ciwg
TlVMTCwgMTAsICZlcnJvcik7CisJeGlkLT5pZCA9IHNtYl9zdHJ0b3VsKGlkX3N0ciwgTlVMTCwg
MTAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKGVycm9yICE9IDApIHsKIAkJcmV0
ID0gTlRfU1RBVFVTX1VOU1VDQ0VTU0ZVTDsKIAkJZ290byBkb25lOwpAQCAtNzc1LDcgKzc3NSw3
IEBAIGFnYWluOgogCQkJY29udGludWU7CiAJCX0KIAotCQlpZCA9IHN0cnRvdWxfZXJyKHRtcCwg
TlVMTCwgMTAsICZlcnJvcik7CisJCWlkID0gc21iX3N0cnRvdWwodG1wLCBOVUxMLCAxMCwgJmVy
cm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJVEFMTE9DX0ZSRUUodG1wKTsKIAkJaWYgKGVycm9y
ICE9IDApIHsKIAkJCURFQlVHKDUsICgiUmVxdWVzdGVkIGlkICgldSkgb3V0IG9mIHJhbmdlICgl
dSAtICV1KS4gIgpAQCAtMTAxOSw3ICsxMDE5LDcgQEAgYWdhaW46CiAJCQljb250aW51ZTsKIAkJ
fQogCi0JCWlkID0gc3RydG91bF9lcnIodG1wLCBOVUxMLCAxMCwgJmVycm9yKTsKKwkJaWQgPSBz
bWJfc3RydG91bCh0bXAsIE5VTEwsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCQlU
QUxMT0NfRlJFRSh0bXApOwogCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJREVCVUcoNSwgKCJSZXF1
ZXN0ZWQgaWQgKCV1KSBvdXQgb2YgcmFuZ2UgKCV1IC0gJXUpLiAiCmRpZmYgLS1naXQgYS9zb3Vy
Y2UzL3dpbmJpbmRkL3dpbmJpbmRkX2xvb2t1cHJpZHMuYyBiL3NvdXJjZTMvd2luYmluZGQvd2lu
YmluZGRfbG9va3Vwcmlkcy5jCmluZGV4IDk1OWE0YTdkYjM4Li4zYjdiNDE3NmQxOCAxMDA2NDQK
LS0tIGEvc291cmNlMy93aW5iaW5kZC93aW5iaW5kZF9sb29rdXByaWRzLmMKKysrIGIvc291cmNl
My93aW5iaW5kZC93aW5iaW5kZF9sb29rdXByaWRzLmMKQEAgLTE4NCw3ICsxODQsNyBAQCBzdGF0
aWMgYm9vbCBwYXJzZV9yaWRsaXN0KFRBTExPQ19DVFggKm1lbV9jdHgsIGNoYXIgKnJpZHN0ciwK
IAkJY2hhciAqcTsKIAkJaW50IGVycm9yID0gMDsKIAotCQlyaWRzW2ldID0gc3RydG91bF9lcnIo
cCwgJnEsIDEwLCAmZXJyb3IpOworCQlyaWRzW2ldID0gc21iX3N0cnRvdWwocCwgJnEsIDEwLCAm
ZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCQlpZiAoZXJyb3IgIT0gMCB8fCAqcSAhPSAnXG4n
KSB7CiAJCQlERUJVRygwLCAoIkdvdCBpbnZhbGlkIHJpZHN0cjogJXNcbiIsIHApKTsKIAkJCXJl
dHVybiBmYWxzZTsKZGlmZiAtLWdpdCBhL3NvdXJjZTMvd2luYmluZGQvd2luYmluZGRfdXRpbC5j
IGIvc291cmNlMy93aW5iaW5kZC93aW5iaW5kZF91dGlsLmMKaW5kZXggOTFhMmY2ZWYxOTcuLmI3
OWY5MGZiMGNlIDEwMDY0NAotLS0gYS9zb3VyY2UzL3dpbmJpbmRkL3dpbmJpbmRkX3V0aWwuYwor
KysgYi9zb3VyY2UzL3dpbmJpbmRkL3dpbmJpbmRkX3V0aWwuYwpAQCAtNTA3LDcgKzUwNywxMSBA
QCBzdGF0aWMgdm9pZCB0cnVzdGRvbV9saXN0X2RvbmUoc3RydWN0IHRldmVudF9yZXEgKnJlcSkK
IAkJCWJyZWFrOwogCQl9CiAKLQkJdHJ1c3RfZmxhZ3MgPSAodWludDMyX3Qpc3RydG91bF9lcnIo
cSwgTlVMTCwgMTAsICZlcnJvcik7CisJCXRydXN0X2ZsYWdzID0gKHVpbnQzMl90KXNtYl9zdHJ0
b3VsKHEsCisJCQkJCQkgICAgTlVMTCwKKwkJCQkJCSAgICAxMCwKKwkJCQkJCSAgICAmZXJyb3Is
CisJCQkJCQkgICAgU01CX1NUUl9TVEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwKSB7CiAJCQlE
QkdfRVJSKCJGYWlsZWQgdG8gY29udmVydCB0cnVzdF9mbGFnc1xuIik7CiAJCQlicmVhazsKQEAg
LTUxOSw3ICs1MjMsMTEgQEAgc3RhdGljIHZvaWQgdHJ1c3Rkb21fbGlzdF9kb25lKHN0cnVjdCB0
ZXZlbnRfcmVxICpyZXEpCiAJCQlicmVhazsKIAkJfQogCi0JCXRydXN0X3R5cGUgPSAodWludDMy
X3Qpc3RydG91bF9lcnIocSwgTlVMTCwgMTAsICZlcnJvcik7CisJCXRydXN0X3R5cGUgPSAodWlu
dDMyX3Qpc21iX3N0cnRvdWwocSwKKwkJCQkJCSAgIE5VTEwsCisJCQkJCQkgICAxMCwKKwkJCQkJ
CSAgICZlcnJvciwKKwkJCQkJCSAgIFNNQl9TVFJfU1RBTkRBUkQpOwogCQlpZiAoZXJyb3IgIT0g
MCkgewogCQkJREJHX0VSUigiRmFpbGVkIHRvIGNvbnZlcnQgdHJ1c3RfdHlwZVxuIik7CiAJCQli
cmVhazsKQEAgLTUzMSw3ICs1MzksMTEgQEAgc3RhdGljIHZvaWQgdHJ1c3Rkb21fbGlzdF9kb25l
KHN0cnVjdCB0ZXZlbnRfcmVxICpyZXEpCiAJCQlicmVhazsKIAkJfQogCi0JCXRydXN0X2F0dHJp
YnMgPSAodWludDMyX3Qpc3RydG91bF9lcnIocSwgTlVMTCwgMTAsICZlcnJvcik7CisJCXRydXN0
X2F0dHJpYnMgPSAodWludDMyX3Qpc21iX3N0cnRvdWwocSwKKwkJCQkJCSAgICAgIE5VTEwsCisJ
CQkJCQkgICAgICAxMCwKKwkJCQkJCSAgICAgICZlcnJvciwKKwkJCQkJCSAgICAgIFNNQl9TVFJf
U1RBTkRBUkQpOwogCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJREJHX0VSUigiRmFpbGVkIHRvIGNv
bnZlcnQgdHJ1c3RfYXR0cmlic1xuIik7CiAJCQlicmVhazsKQEAgLTIxNzAsNyArMjE4Miw3IEBA
IGJvb2wgcGFyc2VfeGlkbGlzdChUQUxMT0NfQ1RYICptZW1fY3R4LCBjb25zdCBjaGFyICp4aWRz
dHIsCiAKIAkJcCArPSAxOwogCi0JCWlkID0gc3RydG91bGxfZXJyKHAsICZlbmRwLCAxMCwgJmVy
cm9yKTsKKwkJaWQgPSBzbWJfc3RydG91bGwocCwgJmVuZHAsIDEwLCAmZXJyb3IsIFNNQl9TVFJf
U1RBTkRBUkQpOwogCQlpZiAoZXJyb3IgIT0gMCkgewogCQkJZ290byBmYWlsOwogCQl9Ci0tIAoy
LjIwLjEKCgpGcm9tIGJmNTUxZWYzNjcyYWRkYzg0ODI4NWZiNGFiZTY0ZjE1OWRkOTI1MDkgTW9u
IFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJt
LmNvbT4KRGF0ZTogVHVlLCA0IEp1biAyMDE5IDA5OjA2OjM3ICswMjAwClN1YmplY3Q6IFtQQVRD
SCAxMi8xNl0gc291cmNlNDogVXBkYXRlIGFsbCBjb25zdW1lcnMgb2Ygc3RydG91bF9lcnIoKSwK
IHN0cnRvdWxsX2VycigpIHRvIG5ldyBBUEkKClNpZ25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcg
PHN3ZW5AbGludXguaWJtLmNvbT4KLS0tCiBzb3VyY2U0L2Ruc19zZXJ2ZXIvZGx6X2JpbmQ5LmMg
ICAgICAgICAgICAgICAgICAgICAgfCAgMiArLQogc291cmNlNC9kc2RiL2NvbW1vbi9kc2RiX2Ru
LmMgICAgICAgICAgICAgICAgICAgICAgIHwgIDIgKy0KIHNvdXJjZTQvZHNkYi9jb21tb24vdXRp
bC5jICAgICAgICAgICAgICAgICAgICAgICAgICB8ICA2ICsrKy0tLQogc291cmNlNC9kc2RiL3Nh
bWRiL2xkYl9tb2R1bGVzL2RpcnN5bmMuYyAgICAgICAgICAgIHwgIDUgKysrLS0KIHNvdXJjZTQv
ZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9wYXJ0aXRpb25fbWV0YWRhdGEuYyB8ICAyICstCiBzb3Vy
Y2U0L2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvc2FtbGRiLmMgICAgICAgICAgICAgfCAgNiArKyst
LS0KIHNvdXJjZTQvZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9zY2hlbWFfbG9hZC5jICAgICAgICB8
ICA2ICsrKysrLQogc291cmNlNC9kc2RiL3NjaGVtYS9zY2hlbWFfcHJlZml4bWFwLmMgICAgICAg
ICAgICAgIHwgIDIgKy0KIHNvdXJjZTQvbGliL3JlZ2lzdHJ5L2xkYi5jICAgICAgICAgICAgICAg
ICAgICAgICAgICB8IDEyICsrKysrKysrKystLQogc291cmNlNC9saWIvc29ja2V0L2ludGVyZmFj
ZS5jICAgICAgICAgICAgICAgICAgICAgIHwgIDkgKysrKysrLS0tCiBzb3VyY2U0L2xpYmNsaS9y
ZXNvbHZlL2Ruc19leC5jICAgICAgICAgICAgICAgICAgICAgfCAgMiArLQogc291cmNlNC9uYnRf
c2VydmVyL3dpbnMvd2luc2RiLmMgICAgICAgICAgICAgICAgICAgIHwgIDUgKysrLS0KIHNvdXJj
ZTQvcnBjX3NlcnZlci9sc2EvZGNlc3J2X2xzYS5jICAgICAgICAgICAgICAgICB8ICA1ICsrKy0t
CiBzb3VyY2U0L3RvcnR1cmUvbmJlbmNoL25iZW5jaC5jICAgICAgICAgICAgICAgICAgICAgfCAg
NiArKysrKy0KIHNvdXJjZTQvdG9ydHVyZS9zbWIyL3NoYXJlbW9kZS5jICAgICAgICAgICAgICAg
ICAgICB8ICAyICstCiAxNSBmaWxlcyBjaGFuZ2VkLCA0NyBpbnNlcnRpb25zKCspLCAyNSBkZWxl
dGlvbnMoLSkKCmRpZmYgLS1naXQgYS9zb3VyY2U0L2Ruc19zZXJ2ZXIvZGx6X2JpbmQ5LmMgYi9z
b3VyY2U0L2Ruc19zZXJ2ZXIvZGx6X2JpbmQ5LmMKaW5kZXggNWRiMTEzMWU0ZGQuLjg3MmViM2Uw
YzFmIDEwMDY0NAotLS0gYS9zb3VyY2U0L2Ruc19zZXJ2ZXIvZGx6X2JpbmQ5LmMKKysrIGIvc291
cmNlNC9kbnNfc2VydmVyL2Rsel9iaW5kOS5jCkBAIC0zNDEsNyArMzQxLDcgQEAgc3RhdGljIGJv
b2wgYjlfZG5zX3R5cGUoY29uc3QgY2hhciAqdHlwZSwgZW51bSBkbnNfcmVjb3JkX3R5cGUgKmR0
eXBlKQogCWNoYXIgKmlzdHIgPSBzdHJ0b2tfcihzdHIsIHNlcCwgJnNhdmVwdHIpOyBcCiAJaW50
IGVycm9yID0gMDtcCiAJaWYgKChpc3RyKSA9PSBOVUxMKSByZXR1cm4gZmFsc2U7IFwKLQkocmV0
KSA9IHN0cnRvdWxfZXJyKGlzdHIsIE5VTEwsIDEwLCAmZXJyb3IpOyBcCisJKHJldCkgPSBzbWJf
c3RydG91bChpc3RyLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsgXAogCWlm
IChlcnJvciAhPSAwKSB7XAogCQlyZXR1cm4gZmFsc2U7XAogCX1cCmRpZmYgLS1naXQgYS9zb3Vy
Y2U0L2RzZGIvY29tbW9uL2RzZGJfZG4uYyBiL3NvdXJjZTQvZHNkYi9jb21tb24vZHNkYl9kbi5j
CmluZGV4IDIxMTlhNGZhYWYzLi5mZDAwOWE3YWY5OCAxMDA2NDQKLS0tIGEvc291cmNlNC9kc2Ri
L2NvbW1vbi9kc2RiX2RuLmMKKysrIGIvc291cmNlNC9kc2RiL2NvbW1vbi9kc2RiX2RuLmMKQEAg
LTEzNSw3ICsxMzUsNyBAQCBzdHJ1Y3QgZHNkYl9kbiAqZHNkYl9kbl9wYXJzZV90cnVzdGVkKFRB
TExPQ19DVFggKm1lbV9jdHgsIHN0cnVjdCBsZGJfY29udGV4dCAqbAogCX0KIAogCWVycm5vID0g
MDsKLQlibGVuID0gc3RydG91bF9lcnIocDEsICZwMiwgMTAsICZlcnJvcik7CisJYmxlbiA9IHNt
Yl9zdHJ0b3VsKHAxLCAmcDIsIDEwLCAmZXJyb3IsIFNNQl9TVFJfU1RBTkRBUkQpOwogCWlmIChl
cnJvciAhPSAwKSB7CiAJCURFQlVHKDEwLCAoX19sb2NhdGlvbl9fICI6IGZhaWxlZFxuIikpOwog
CQlnb3RvIGZhaWxlZDsKZGlmZiAtLWdpdCBhL3NvdXJjZTQvZHNkYi9jb21tb24vdXRpbC5jIGIv
c291cmNlNC9kc2RiL2NvbW1vbi91dGlsLmMKaW5kZXggYTM4ZjUwNjFlN2QuLmU1MjFlZDA5OTk5
IDEwMDY0NAotLS0gYS9zb3VyY2U0L2RzZGIvY29tbW9uL3V0aWwuYworKysgYi9zb3VyY2U0L2Rz
ZGIvY29tbW9uL3V0aWwuYwpAQCAtMzg0NSw3ICszODQ1LDcgQEAgTlRTVEFUVVMgZHNkYl9nZXRf
ZXh0ZW5kZWRfZG5fdWludDY0KHN0cnVjdCBsZGJfZG4gKmRuLCB1aW50NjRfdCAqdmFsLCBjb25z
dCBjaGEKIAkJbWVtY3B5KHMsIHYtPmRhdGEsIHYtPmxlbmd0aCk7CiAJCXNbdi0+bGVuZ3RoXSA9
IDA7CiAKLQkJKnZhbCA9IHN0cnRvdWxsX2VycihzLCBOVUxMLCAwLCAmZXJyb3IpOworCQkqdmFs
ID0gc21iX3N0cnRvdWxsKHMsIE5VTEwsIDAsICZlcnJvciwgU01CX1NUUl9TVEFOREFSRCk7CiAJ
CWlmIChlcnJvciAhPSAwKSB7CiAJCQlyZXR1cm4gTlRfU1RBVFVTX0lOVkFMSURfUEFSQU1FVEVS
OwogCQl9CkBAIC0zODgxLDcgKzM4ODEsNyBAQCBOVFNUQVRVUyBkc2RiX2dldF9leHRlbmRlZF9k
bl91aW50MzIoc3RydWN0IGxkYl9kbiAqZG4sIHVpbnQzMl90ICp2YWwsIGNvbnN0IGNoYQogCQlj
aGFyIHNbdi0+bGVuZ3RoICsgMV07CiAJCW1lbWNweShzLCB2LT5kYXRhLCB2LT5sZW5ndGgpOwog
CQlzW3YtPmxlbmd0aF0gPSAwOwotCQkqdmFsID0gc3RydG91bF9lcnIocywgTlVMTCwgMCwgJmVy
cm9yKTsKKwkJKnZhbCA9IHNtYl9zdHJ0b3VsKHMsIE5VTEwsIDAsICZlcnJvciwgU01CX1NUUl9T
VEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwKSB7CiAJCQlyZXR1cm4gTlRfU1RBVFVTX0lOVkFM
SURfUEFSQU1FVEVSOwogCQl9CkBAIC0zOTQ3LDcgKzM5NDcsNyBAQCB1aW50MzJfdCBkc2RiX2Ru
X3ZhbF9ybWRfZmxhZ3MoY29uc3Qgc3RydWN0IGxkYl92YWwgKnZhbCkKIAlpZiAoIXApIHsKIAkJ
cmV0dXJuIDA7CiAJfQotCWZsYWdzID0gc3RydG91bF9lcnIocCsxMSwgJmVuZCwgMTAsICZlcnJv
cik7CisJZmxhZ3MgPSBzbWJfc3RydG91bChwKzExLCAmZW5kLCAxMCwgJmVycm9yLCBTTUJfU1RS
X1NUQU5EQVJEKTsKIAlpZiAoIWVuZCB8fCAqZW5kICE9ICc+JyB8fCBlcnJvciAhPSAwKSB7CiAJ
CS8qIGl0IG11c3QgZW5kIGluIGEgPiAqLwogCQlyZXR1cm4gMDsKZGlmZiAtLWdpdCBhL3NvdXJj
ZTQvZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9kaXJzeW5jLmMgYi9zb3VyY2U0L2RzZGIvc2FtZGIv
bGRiX21vZHVsZXMvZGlyc3luYy5jCmluZGV4IDc0YTEwN2M4NDc2Li4wMGYyNGJkNmQ1OSAxMDA2
NDQKLS0tIGEvc291cmNlNC9kc2RiL3NhbWRiL2xkYl9tb2R1bGVzL2RpcnN5bmMuYworKysgYi9z
b3VyY2U0L2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvZGlyc3luYy5jCkBAIC0xNjEsMTEgKzE2MSwx
MiBAQCBzdGF0aWMgaW50IGRpcnN5bmNfZmlsdGVyX2VudHJ5KHN0cnVjdCBsZGJfcmVxdWVzdCAq
cmVxLAogCQkJICogdG8gdXBkYXRlIHRoZSBtYXggVVNOIGluIHRoZSBjb29raWUgaWYgd2UKIAkJ
CSAqIGRlY2lkZSB0byBrZWVwIHRoaXMgZW50cnkKIAkJCSAqLwotCQkJdmFsID0gc3RydG91bGxf
ZXJyKAorCQkJdmFsID0gc21iX3N0cnRvdWxsKAogCQkJCShjb25zdCBjaGFyKiltc2ctPmVsZW1l
bnRzW2ldLnZhbHVlc1swXS5kYXRhLAogCQkJCU5VTEwsCiAJCQkJMCwKLQkJCQkmZXJyb3IpOwor
CQkJCSZlcnJvciwKKwkJCQlTTUJfU1RSX1NUQU5EQVJEKTsKIAkJCWlmIChlcnJvciAhPSAwKSB7
CiAJCQkJbGRiX3NldF9lcnJzdHJpbmcobGRiLAogCQkJCQkJICAiRmFpbGVkIHRvIGNvbnZlcnQg
VVNOIik7CmRpZmYgLS1naXQgYS9zb3VyY2U0L2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvcGFydGl0
aW9uX21ldGFkYXRhLmMgYi9zb3VyY2U0L2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvcGFydGl0aW9u
X21ldGFkYXRhLmMKaW5kZXggMzQ5Zjc5YzI2NDUuLjQ0Y2UyYzY2NjM5IDEwMDY0NAotLS0gYS9z
b3VyY2U0L2RzZGIvc2FtZGIvbGRiX21vZHVsZXMvcGFydGl0aW9uX21ldGFkYXRhLmMKKysrIGIv
c291cmNlNC9kc2RiL3NhbWRiL2xkYl9tb2R1bGVzL3BhcnRpdGlvbl9tZXRhZGF0YS5jCkBAIC03
NCw3ICs3NCw3IEBAIHN0YXRpYyBpbnQgcGFydGl0aW9uX21ldGFkYXRhX2dldF91aW50NjQoc3Ry
dWN0IGxkYl9tb2R1bGUgKm1vZHVsZSwKIAkJcmV0dXJuIGxkYl9tb2R1bGVfb29tKG1vZHVsZSk7
CiAJfQogCi0JKnZhbHVlID0gc3RydG91bGxfZXJyKHZhbHVlX3N0ciwgTlVMTCwgMTAsICZlcnJv
cik7CisJKnZhbHVlID0gc21iX3N0cnRvdWxsKHZhbHVlX3N0ciwgTlVMTCwgMTAsICZlcnJvciwg
U01CX1NUUl9TVEFOREFSRCk7CiAJaWYgKGVycm9yICE9IDApIHsKIAkJcmV0dXJuIGxkYl9tb2R1
bGVfZXJyb3IobW9kdWxlLCBMREJfRVJSX09QRVJBVElPTlNfRVJST1IsCiAJCQkJCSJwYXJ0aXRp
b25fbWV0YWRhdGE6IGNvbnZlcmlzaW9uIGZhaWxlZCIpOwpkaWZmIC0tZ2l0IGEvc291cmNlNC9k
c2RiL3NhbWRiL2xkYl9tb2R1bGVzL3NhbWxkYi5jIGIvc291cmNlNC9kc2RiL3NhbWRiL2xkYl9t
b2R1bGVzL3NhbWxkYi5jCmluZGV4IDA5NGYyNTRjOGZjLi40ZGE4NTY0Yzc3YSAxMDA2NDQKLS0t
IGEvc291cmNlNC9kc2RiL3NhbWRiL2xkYl9tb2R1bGVzL3NhbWxkYi5jCisrKyBiL3NvdXJjZTQv
ZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9zYW1sZGIuYwpAQCAtMzMwNSw3ICszMzA1LDcgQEAgc3Rh
dGljIGludCBjaGVja19hZGRyZXNzX3JvdW5kdHJpcChjb25zdCBjaGFyICphZGRyZXNzLCBpbnQg
ZmFtaWx5LAogICovCiBzdGF0aWMgaW50IHZlcmlmeV9jaWRyKGNvbnN0IGNoYXIgKmNpZHIpCiB7
Ci0JY2hhciAqYWRkcmVzcyA9IE5VTEwsICpzbGFzaCA9IE5VTEwsICplbmRwdHIgPSBOVUxMOwor
CWNoYXIgKmFkZHJlc3MgPSBOVUxMLCAqc2xhc2ggPSBOVUxMOwogCWJvb2wgaGFzX2NvbG9uLCBo
YXNfZG90OwogCWludCByZXMsIHJldDsKIAl1bnNpZ25lZCBsb25nIG1hc2s7CkBAIC0zMzMwLDE0
ICszMzMwLDE0IEBAIHN0YXRpYyBpbnQgdmVyaWZ5X2NpZHIoY29uc3QgY2hhciAqY2lkcikKIAkv
KiB0ZXJtaW5hdGUgdGhlIGFkZHJlc3MgZm9yIHN0cmNociwgaW5ldF9wdG9uICovCiAJKnNsYXNo
ID0gJ1wwJzsKIAotCW1hc2sgPSBzdHJ0b3VsX2VycihzbGFzaCArIDEsICZlbmRwdHIsIDEwLCAm
ZXJyb3IpOworCW1hc2sgPSBzbWJfc3RydG91bChzbGFzaCArIDEsIE5VTEwsIDEwLCAmZXJyb3Is
IFNNQl9TVFJfRlVMTF9TVFJfQ09OVik7CiAJaWYgKG1hc2sgPT0gMCl7CiAJCURCR19JTkZPKCJX
aW5kb3dzIGRvZXMgbm90IGxpa2UgdGhlIHplcm8gbWFzaywgIgogCQkJICJzbyBub3IgZG8gd2U6
ICVzXG4iLCBjaWRyKTsKIAkJZ290byBlcnJvcjsKIAl9CiAKLQlpZiAoZXJyb3IgIT0gMCB8fCAq
ZW5kcHRyICE9ICdcMCcpeworCWlmIChlcnJvciAhPSAwKXsKIAkJREJHX0lORk8oIkNJRFIgbWFz
ayBpcyBub3QgYSBwcm9wZXIgaW50ZWdlcjogJXNcbiIsIGNpZHIpOwogCQlnb3RvIGVycm9yOwog
CX0KZGlmZiAtLWdpdCBhL3NvdXJjZTQvZHNkYi9zYW1kYi9sZGJfbW9kdWxlcy9zY2hlbWFfbG9h
ZC5jIGIvc291cmNlNC9kc2RiL3NhbWRiL2xkYl9tb2R1bGVzL3NjaGVtYV9sb2FkLmMKaW5kZXgg
M2IwNzgxNjg1Y2YuLjQwZWE0MmI1NWU0IDEwMDY0NAotLS0gYS9zb3VyY2U0L2RzZGIvc2FtZGIv
bGRiX21vZHVsZXMvc2NoZW1hX2xvYWQuYworKysgYi9zb3VyY2U0L2RzZGIvc2FtZGIvbGRiX21v
ZHVsZXMvc2NoZW1hX2xvYWQuYwpAQCAtMTcwLDcgKzE3MCwxMSBAQCBzdGF0aWMgaW50IHNjaGVt
YV9tZXRhZGF0YV9nZXRfdWludDY0KHN0cnVjdCBzY2hlbWFfbG9hZF9wcml2YXRlX2RhdGEgKmRh
dGEsCiAJICogbmV4dCB0aW1lCiAJICovCiAJZGF0YS0+dGRiX3NlcW51bSA9IHRkYl9zZXFudW07
Ci0JZGF0YS0+c2NoZW1hX3NlcV9udW1fY2FjaGUgPSBzdHJ0b3VsbF9lcnIodmFsdWVfc3RyLCBO
VUxMLCAxMCwgJmVycm9yKTsKKwlkYXRhLT5zY2hlbWFfc2VxX251bV9jYWNoZSA9IHNtYl9zdHJ0
b3VsbCh2YWx1ZV9zdHIsCisJCQkJCQkgIE5VTEwsCisJCQkJCQkgIDEwLAorCQkJCQkJICAmZXJy
b3IsCisJCQkJCQkgIFNNQl9TVFJfU1RBTkRBUkQpOwogCWlmIChlcnJvciAhPSAwKSB7CiAJCXRh
bGxvY19mcmVlKHRtcF9jdHgpOwogCQlyZXR1cm4gbGRiX21vZHVsZV9lcnJvcihkYXRhLT5tb2R1
bGUsIExEQl9FUlJfT1BFUkFUSU9OU19FUlJPUiwKZGlmZiAtLWdpdCBhL3NvdXJjZTQvZHNkYi9z
Y2hlbWEvc2NoZW1hX3ByZWZpeG1hcC5jIGIvc291cmNlNC9kc2RiL3NjaGVtYS9zY2hlbWFfcHJl
Zml4bWFwLmMKaW5kZXggNDgyYTM1ZjIxNjUuLjcwNmU0OGEwMzRlIDEwMDY0NAotLS0gYS9zb3Vy
Y2U0L2RzZGIvc2NoZW1hL3NjaGVtYV9wcmVmaXhtYXAuYworKysgYi9zb3VyY2U0L2RzZGIvc2No
ZW1hL3NjaGVtYV9wcmVmaXhtYXAuYwpAQCAtMjI0LDcgKzIyNCw3IEBAIHN0YXRpYyBXRVJST1Ig
X2RzZGJfcGZtX21ha2VfYmluYXJ5X29pZChjb25zdCBjaGFyICpmdWxsX29pZCwgVEFMTE9DX0NU
WCAqbWVtX2N0CiAJCXJldHVybiBXRVJSX0lOVkFMSURfUEFSQU1FVEVSOwogCX0KIAlvaWRfc3Vi
aWQrKzsKLQlsYXN0X3N1YmlkID0gc3RydG91bF9lcnIob2lkX3N1YmlkLCBOVUxMLCAxMCwgJmVy
cm9yKTsKKwlsYXN0X3N1YmlkID0gc21iX3N0cnRvdWwob2lkX3N1YmlkLCBOVUxMLCAxMCwgJmVy
cm9yLCBTTUJfU1RSX1NUQU5EQVJEKTsKIAlpZiAoZXJyb3IgIT0gMCkgewogCQlyZXR1cm4gV0VS
Ul9JTlZBTElEX1BBUkFNRVRFUjsKIAl9CmRpZmYgLS1naXQgYS9zb3VyY2U0L2xpYi9yZWdpc3Ry
eS9sZGIuYyBiL3NvdXJjZTQvbGliL3JlZ2lzdHJ5L2xkYi5jCmluZGV4IGQwZTlmNDZmNGUxLi5j
MGIxM2UwZDRjZSAxMDA2NDQKLS0tIGEvc291cmNlNC9saWIvcmVnaXN0cnkvbGRiLmMKKysrIGIv
c291cmNlNC9saWIvcmVnaXN0cnkvbGRiLmMKQEAgLTc5LDcgKzc5LDExIEBAIHN0YXRpYyB2b2lk
IHJlZ19sZGJfdW5wYWNrX3ZhbHVlKFRBTExPQ19DVFggKm1lbV9jdHgsCiAJCQkvKiBUaGUgZGF0
YSBpcyBhIHBsYWluIERXT1JEICovCiAJCQl1aW50MzJfdCB0bXA7CiAKLQkJCXRtcCA9IHN0cnRv
dWxfZXJyKChjaGFyICopdmFsLT5kYXRhLCBOVUxMLCAwLCAmZXJyb3IpOworCQkJdG1wID0gc21i
X3N0cnRvdWwoKGNoYXIgKil2YWwtPmRhdGEsCisJCQkJCSAgTlVMTCwKKwkJCQkJICAwLAorCQkJ
CQkgICZlcnJvciwKKwkJCQkJICBTTUJfU1RSX1NUQU5EQVJEKTsKIAkJCWlmIChlcnJvciAhPSAw
KSB7CiAJCQkJZGF0YS0+ZGF0YSA9IE5VTEw7CiAJCQkJZGF0YS0+bGVuZ3RoID0gMDsKQEAgLTEw
Miw3ICsxMDYsMTEgQEAgc3RhdGljIHZvaWQgcmVnX2xkYl91bnBhY2tfdmFsdWUoVEFMTE9DX0NU
WCAqbWVtX2N0eCwKIAkJCS8qIFRoZSBkYXRhIGlzIGEgcGxhaW4gUVdPUkQgKi8KIAkJCXVpbnQ2
NF90IHRtcDsKIAotCQkJdG1wID0gc3RydG91bGxfZXJyKChjaGFyICopdmFsLT5kYXRhLCBOVUxM
LCAwLCAmZXJyb3IpOworCQkJdG1wID0gc21iX3N0cnRvdWxsKChjaGFyICopdmFsLT5kYXRhLAor
CQkJCQkgICBOVUxMLAorCQkJCQkgICAwLAorCQkJCQkgICAmZXJyb3IsCisJCQkJCSAgIFNNQl9T
VFJfU1RBTkRBUkQpOwogCQkJaWYgKGVycm9yICE9IDApIHsKIAkJCQlkYXRhLT5kYXRhID0gTlVM
TDsKIAkJCQlkYXRhLT5sZW5ndGggPSAwOwpkaWZmIC0tZ2l0IGEvc291cmNlNC9saWIvc29ja2V0
L2ludGVyZmFjZS5jIGIvc291cmNlNC9saWIvc29ja2V0L2ludGVyZmFjZS5jCmluZGV4IDliZjAw
MmMyZjAxLi45M2I2MGY3ZDMyZiAxMDA2NDQKLS0tIGEvc291cmNlNC9saWIvc29ja2V0L2ludGVy
ZmFjZS5jCisrKyBiL3NvdXJjZTQvbGliL3NvY2tldC9pbnRlcmZhY2UuYwpAQCAtMjI0LDExICsy
MjQsMTQgQEAgc3RhdGljIHZvaWQgaW50ZXJwcmV0X2ludGVyZmFjZShUQUxMT0NfQ1RYICptZW1f
Y3R4LAogCQkJcmV0dXJuOwogCQl9CiAJfSBlbHNlIHsKLQkJY2hhciAqZW5kcCA9IE5VTEw7CiAJ
CWludCBlcnJvciA9IDA7CiAKLQkJdW5zaWduZWQgbG9uZyB2YWwgPSBzdHJ0b3VsX2VycihwLCAm
ZW5kcCwgMCwgJmVycm9yKTsKLQkJaWYgKGVycm9yICE9IDAgfHwgKmVuZHAgIT0gJ1wwJykgewor
CQl1bnNpZ25lZCBsb25nIHZhbCA9IHNtYl9zdHJ0b3VsKHAsCisJCQkJCQlOVUxMLAorCQkJCQkJ
MCwKKwkJCQkJCSZlcnJvciwKKwkJCQkJCVNNQl9TVFJfRlVMTF9TVFJfQ09OVik7CisJCWlmIChl
cnJvciAhPSAwKSB7CiAJCQlERUJVRygyLCgiaW50ZXJwcmV0X2ludGVyZmFjZTogIgogCQkJCSJj
YW4ndCBkZXRlcm1pbmUgbmV0bWFzayB2YWx1ZSBmcm9tICVzXG4iLAogCQkJCXApKTsKZGlmZiAt
LWdpdCBhL3NvdXJjZTQvbGliY2xpL3Jlc29sdmUvZG5zX2V4LmMgYi9zb3VyY2U0L2xpYmNsaS9y
ZXNvbHZlL2Ruc19leC5jCmluZGV4IDg2ZWViNWY1OTIxLi45ZWUxOWZmYjRmZCAxMDA2NDQKLS0t
IGEvc291cmNlNC9saWJjbGkvcmVzb2x2ZS9kbnNfZXguYworKysgYi9zb3VyY2U0L2xpYmNsaS9y
ZXNvbHZlL2Ruc19leC5jCkBAIC01MzYsNyArNTM2LDcgQEAgc3RhdGljIHZvaWQgcGlwZV9oYW5k
bGVyKHN0cnVjdCB0ZXZlbnRfY29udGV4dCAqZXYsIHN0cnVjdCB0ZXZlbnRfZmQgKmZkZSwKIAkJ
CWNvbXBvc2l0ZV9lcnJvcihjLCBOVF9TVEFUVVNfT0JKRUNUX05BTUVfTk9UX0ZPVU5EKTsKIAkJ
CXJldHVybjsKIAkJfQotCQlwb3J0ID0gc3RydG91bF9lcnIocCwgTlVMTCwgMTAsICZlcnJvcik7
CisJCXBvcnQgPSBzbWJfc3RydG91bChwLCBOVUxMLCAxMCwgJmVycm9yLCBTTUJfU1RSX1NUQU5E
QVJEKTsKIAkJaWYgKHBvcnQgPiBVSU5UMTZfTUFYIHx8IGVycm9yICE9IDApIHsKIAkJCWNvbXBv
c2l0ZV9lcnJvcihjLCBOVF9TVEFUVVNfT0JKRUNUX05BTUVfTk9UX0ZPVU5EKTsKIAkJCXJldHVy
bjsKZGlmZiAtLWdpdCBhL3NvdXJjZTQvbmJ0X3NlcnZlci93aW5zL3dpbnNkYi5jIGIvc291cmNl
NC9uYnRfc2VydmVyL3dpbnMvd2luc2RiLmMKaW5kZXggNTE4NGQ3ZGU3YjAuLjQxYTlmZDg1NTBk
IDEwMDY0NAotLS0gYS9zb3VyY2U0L25idF9zZXJ2ZXIvd2lucy93aW5zZGIuYworKysgYi9zb3Vy
Y2U0L25idF9zZXJ2ZXIvd2lucy93aW5zZGIuYwpAQCAtMTgzLDExICsxODMsMTIgQEAgc3RhdGlj
IE5UU1RBVFVTIHdpbnNkYl9uYnRfbmFtZShUQUxMT0NfQ1RYICptZW1fY3R4LCBzdHJ1Y3QgbGRi
X2RuICpkbiwgc3RydWN0IG4KIAogCWlmIChjb21wX251bSA+IGN1ciAmJiBzdHJjYXNlY21wKCJ0
eXBlIiwgbGRiX2RuX2dldF9jb21wb25lbnRfbmFtZShkbiwgY3VyKSkgPT0gMCkgewogCQluYW1l
LT50eXBlID0KLQkJCXN0cnRvdWxfZXJyKAorCQkJc21iX3N0cnRvdWwoCiAJCQkJKGNoYXIgKils
ZGJfZG5fZ2V0X2NvbXBvbmVudF92YWwoZG4sIGN1ciktPmRhdGEsCiAJCQkJTlVMTCwKIAkJCQkw
LAotCQkJCSZlcnJvcik7CisJCQkJJmVycm9yLAorCQkJCVNNQl9TVFJfU1RBTkRBUkQpOwogCQlp
ZiAoZXJyb3IgIT0gMCkgewogCQkJc3RhdHVzID0gTlRfU1RBVFVTX0lOVEVSTkFMX0RCX0NPUlJV
UFRJT047CiAJCQlnb3RvIGZhaWxlZDsKZGlmZiAtLWdpdCBhL3NvdXJjZTQvcnBjX3NlcnZlci9s
c2EvZGNlc3J2X2xzYS5jIGIvc291cmNlNC9ycGNfc2VydmVyL2xzYS9kY2VzcnZfbHNhLmMKaW5k
ZXggNjRkMmVjOTk5MWEuLjM5NDMzNWE2NDFmIDEwMDY0NAotLS0gYS9zb3VyY2U0L3JwY19zZXJ2
ZXIvbHNhL2RjZXNydl9sc2EuYworKysgYi9zb3VyY2U0L3JwY19zZXJ2ZXIvbHNhL2RjZXNydl9s
c2EuYwpAQCAtMTcwNiwxMCArMTcwNiwxMSBAQCBzdGF0aWMgTlRTVEFUVVMgdXBkYXRlX3VpbnQz
Ml90X3ZhbHVlKFRBTExPQ19DVFggKm1lbV9jdHgsCiAJCWZsYWdzID0gTERCX0ZMQUdfTU9EX0FE
RDsKIAogCX0gZWxzZSB7Ci0JCW9yaWdfdWludCA9IHN0cnRvdWxfZXJyKChjb25zdCBjaGFyICop
b3JpZ192YWwtPmRhdGEsCisJCW9yaWdfdWludCA9IHNtYl9zdHJ0b3VsKChjb25zdCBjaGFyICop
b3JpZ192YWwtPmRhdGEsCiAJCQkJCU5VTEwsCiAJCQkJCTAsCi0JCQkJCSZlcnJvcik7CisJCQkJ
CSZlcnJvciwKKwkJCQkJU01CX1NUUl9TVEFOREFSRCk7CiAJCWlmIChlcnJvciAhPSAwIHx8IG9y
aWdfdWludCAhPSB2YWx1ZSkgewogCQkJLyogcmVwbGFjZSBhbHNvIGlmIGNhbid0IGdldCB2YWx1
ZSAqLwogCQkJZmxhZ3MgPSBMREJfRkxBR19NT0RfUkVQTEFDRTsKZGlmZiAtLWdpdCBhL3NvdXJj
ZTQvdG9ydHVyZS9uYmVuY2gvbmJlbmNoLmMgYi9zb3VyY2U0L3RvcnR1cmUvbmJlbmNoL25iZW5j
aC5jCmluZGV4IDgzMzk1MTIzYzMzLi42ZTJkYmUwYjkwNyAxMDA2NDQKLS0tIGEvc291cmNlNC90
b3J0dXJlL25iZW5jaC9uYmVuY2guYworKysgYi9zb3VyY2U0L3RvcnR1cmUvbmJlbmNoL25iZW5j
aC5jCkBAIC0xNDAsNyArMTQwLDExIEBAIGFnYWluOgogCiAJCS8qIGFjY2VwdCBudW1lcmljIG9y
IHN0cmluZyBzdGF0dXMgY29kZXMgKi8KIAkJaWYgKHN0cm5jbXAocGFyYW1zW2ktMV0sICIweCIs
IDIpID09IDApIHsKLQkJCXRtcCA9IHN0cnRvdWxfZXJyKHBhcmFtc1tpLTFdLCBOVUxMLCAxNiwg
JmVycm9yKTsKKwkJCXRtcCA9IHNtYl9zdHJ0b3VsKHBhcmFtc1tpLTFdLAorCQkJCQkgIE5VTEws
CisJCQkJCSAgMTYsCisJCQkJCSAgJmVycm9yLAorCQkJCQkgIFNNQl9TVFJfU1RBTkRBUkQpOwog
CQkJaWYgKGVycm9yICE9IDApIHsKIAkJCQl0bXAgPSBlcnJvcjsKIAkJCX0KZGlmZiAtLWdpdCBh
L3NvdXJjZTQvdG9ydHVyZS9zbWIyL3NoYXJlbW9kZS5jIGIvc291cmNlNC90b3J0dXJlL3NtYjIv
c2hhcmVtb2RlLmMKaW5kZXggYjc2YWE0Y2NkN2QuLjk0MDMyYjNlN2VhIDEwMDY0NAotLS0gYS9z
b3VyY2U0L3RvcnR1cmUvc21iMi9zaGFyZW1vZGUuYworKysgYi9zb3VyY2U0L3RvcnR1cmUvc21i
Mi9zaGFyZW1vZGUuYwpAQCAtMTkyLDcgKzE5Miw3IEBAIGJvb2wgdG9ydHVyZV9zbWIyX2NoZWNr
X3NoYXJlbW9kZShzdHJ1Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQogCXNoYXJlbW9kZSA9IHNt
YjJfdXRpbF9zaGFyZV9hY2Nlc3Moc2hhcmVtb2RlX3N0cmluZyk7CiAKIAlhY2Nlc3Nfc3RyaW5n
ID0gdG9ydHVyZV9zZXR0aW5nX3N0cmluZyh0Y3R4LCAiYWNjZXNzIiwgIjB4ZjAxZmYiKTsKLQlh
Y2Nlc3MgPSBzdHJ0b3VsX2VycihhY2Nlc3Nfc3RyaW5nLCBOVUxMLCAwLCAmZXJyb3IpOworCWFj
Y2VzcyA9IHNtYl9zdHJ0b3VsKGFjY2Vzc19zdHJpbmcsIE5VTEwsIDAsICZlcnJvciwgU01CX1NU
Ul9TVEFOREFSRCk7CiAJaWYgKGVycm9yICE9IDApIHsKIAkJdG9ydHVyZV9jb21tZW50KHRjdHgs
ICJJbml0aWFsaXppbmcgYWNjZXNzIGZhaWxlZC5cbiIpOwogCQlyZXR1cm4gZmFsc2U7Ci0tIAoy
LjIwLjEKCgpGcm9tIDc5NzZjMzJlZmNmMTE5MWNjODM5MzY0ZTEwMmU3OWVkNGFmZTg0MDggTW9u
IFNlcCAxNyAwMDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJt
LmNvbT4KRGF0ZTogRnJpLCAxMiBBcHIgMjAxOSAxNzoyODoyMyArMDIwMApTdWJqZWN0OiBbUEFU
Q0ggMTMvMTZdIHV0aWw6IGNsZWFudXAgQVBJIGNoYW5nZSBmb3Igc3RydG91bChsKSB3cmFwcGVy
cwoKU2lnbmVkLW9mZi1ieTogU3dlbiBTY2hpbGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgotLS0K
IGxpYi91dGlsL3V0aWwuaCB8IDUgLS0tLS0KIDEgZmlsZSBjaGFuZ2VkLCA1IGRlbGV0aW9ucygt
KQoKZGlmZiAtLWdpdCBhL2xpYi91dGlsL3V0aWwuaCBiL2xpYi91dGlsL3V0aWwuaAppbmRleCBk
NjVkOGM5ZmYyNC4uYzg5ZjQ4MDdkNWIgMTAwNjQ0Ci0tLSBhL2xpYi91dGlsL3V0aWwuaAorKysg
Yi9saWIvdXRpbC91dGlsLmgKQEAgLTM1LDExICszNSw2IEBAIHNtYl9zdHJ0b3VsKGNvbnN0IGNo
YXIgKm5wdHIsIGNoYXIgKiplbmRwdHIsIGludCBiYXNlLCBpbnQgKmVyciwgaW50IGZsYWdzKTsK
IHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQKIHNtYl9zdHJ0b3VsbChjb25zdCBjaGFyICpucHRyLCBj
aGFyICoqZW5kcHRyLCBpbnQgYmFzZSwgaW50ICplcnIsIGludCBmbGFncyk7CiAKLSNkZWZpbmUg
c3RydG91bF9lcnIobnB0ciwgZW5kcHRyLCBiYXNlLCBlcnIpIFwKLQlzbWJfc3RydG91bChucHRy
LCBlbmRwdHIsIGJhc2UsIGVyciwgU01CX1NUUl9TVEFOREFSRCkKLSNkZWZpbmUgc3RydG91bGxf
ZXJyKG5wdHIsIGVuZHB0ciwgYmFzZSwgZXJyKSBcCi0Jc21iX3N0cnRvdWxsKG5wdHIsIGVuZHB0
ciwgYmFzZSwgZXJyLCBTTUJfU1RSX1NUQU5EQVJEKQotCiAvKioKICAqIFdyaXRlIGR1bXAgb2Yg
YmluYXJ5IGRhdGEgdG8gYSBjYWxsYmFjawogICovCi0tIAoyLjIwLjEKCgpGcm9tIDU0OGViZjg2
OTcxYzc1OTgzZTcyMjZhZTczYTNhYmZjYmZiNWE2ZjMgTW9uIFNlcCAxNyAwMDowMDowMCAyMDAx
CkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KRGF0ZTogTW9uLCAzIEp1
biAyMDE5IDEwOjEzOjUyICswMjAwClN1YmplY3Q6IFtQQVRDSCAxNC8xNl0gdGVzdHMtdXRpbDog
QWRkaW5nIHRlc3QgdG8gdmVyaWZ5ICJhbGxvdy1uZWdhdGl2ZSIgZmxhZwoKVGhlIHN0YW5kYXJk
IHN0cmluZyB0byBpbnRlZ2VyIGNvbnZlcnNpb24gcm91dGluZXMgYWxsb3cgc3RyaW5ncwp3aXRo
IGEgbGVhZGluZyAiLSIgdG8gaW5kaWNhdGUgYSBuZWdhdGl2ZSBudW1iZXIuCkhvd2V2ZXIsIHRo
ZSByZXR1cm5lZCB2YWx1ZSBpcyBhbHdheXMgYW4gdW5zaWduZWQgdmFsdWUgcmVwcmVzZW50aW5n
CnRoZSBiaXQtcGF0dGVybiBvZiB0aGlzIG5lZ2F0aXZlIHZhbHVlLgpUeXBpY2FsbHksIHRoaXMg
YmVoYXZpb3VyIGlzIE5PVCB3YW50ZWQgYW5kIHRoZXJlZm9yZSB0aGUgc3RhbmRhcmQKYmVoYXZp
b3Igb2YgdGhlIGludGVybmFsIHNtYl9zdHJ0b3VsKGwpIHJldHVybiBhbiBlcnJvcyBpbiBzdWNo
IHNpdHVhdGlvbnMuCkl0IGNhbiBiZSBlbmFibGVkIHRob3VnaCBieSB1c2luZyB0aGUgZmxhZyBT
TUJfU1RSX0FMTE9XX05FR0FUSVZFLgpUaGlzIHRlc3QgdmVyaWZpZXMgdGhlIGNvcnJlY3QgcHJv
Y2Vzc2luZy4KClNpZ25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNv
bT4KLS0tCiBsaWIvdXRpbC90ZXN0cy91dGlsLmMgfCAzOCArKysrKysrKysrKysrKysrKysrKysr
KysrKysrKysrKysrKysrKwogMSBmaWxlIGNoYW5nZWQsIDM4IGluc2VydGlvbnMoKykKCmRpZmYg
LS1naXQgYS9saWIvdXRpbC90ZXN0cy91dGlsLmMgYi9saWIvdXRpbC90ZXN0cy91dGlsLmMKaW5k
ZXggODU0ZDFkMjAyM2YuLmYxMjAyMWZlMmEyIDEwMDY0NAotLS0gYS9saWIvdXRpbC90ZXN0cy91
dGlsLmMKKysrIGIvbGliL3V0aWwvdGVzdHMvdXRpbC5jCkBAIC0zMSw2ICszMSw5IEBACiAKICNp
bmNsdWRlICJsaWIvdXRpbC9zYW1iYV91dGlsLmgiCiAKKyNpbmNsdWRlICJsaW1pdHMuaCIKKyNp
bmNsdWRlICJzdHJpbmcuaCIKKwogc3RydWN0IHRlc3RfdHJpbV9zdHJpbmdfZGF0YSB7CiAJY29u
c3QgY2hhciAqZGVzYzsKIAljb25zdCBjaGFyICppbjsKQEAgLTUwNiw2ICs1MDksMzggQEAgc3Rh
dGljIGJvb2wgdGVzdF9zbWJfc3RydG91bF9ub19udW1iZXIoc3RydWN0IHRvcnR1cmVfY29udGV4
dCAqdGN0eCkKIAlyZXR1cm4gdHJ1ZTsKIH0KIAorc3RhdGljIGJvb2wgdGVzdF9zbWJfc3RydG91
bF9hbGxvd19uZWdhdGl2ZShzdHJ1Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQoreworCWNvbnN0
IGNoYXIgKm51bWJlciA9ICItMSI7CisJY29uc3QgY2hhciAqbnVtYmVyMiA9ICItMS0xIjsKKwl1
bnNpZ25lZCBsb25nIHJlcyA9IDA7CisJdW5zaWduZWQgbG9uZyBsb25nIHJlczIgPSAwOworCWNo
YXIgKmVuZF9wdHIgPSBOVUxMOworCWludCBlcnI7CisKKwllcnIgPSAwOworCXJlcyA9IHNtYl9z
dHJ0b3VsKG51bWJlciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9BTExPV19ORUdBVElWRSk7CisJ
dG9ydHVyZV9hc3NlcnQodGN0eCwgZXJyID09IDAsICJzdHJ0b3VsX2VycjogVW5leHBlY3RlZCBl
cnJvciIpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIHJlcyA9PSBVTE9OR19NQVgsICJzdHJ0b3Vs
X2VycjogVW5leHBlY3RlZCB2YWx1ZSIpOworCisJZXJyID0gMDsKKwlyZXMyID0gc21iX3N0cnRv
dWxsKG51bWJlciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9BTExPV19ORUdBVElWRSk7CisJdG9y
dHVyZV9hc3NlcnQodGN0eCwgZXJyID09IDAsICJzdHJ0b3VsbF9lcnI6IFVuZXhwZWN0ZWQgZXJy
b3IiKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCByZXMyID09IFVMTE9OR19NQVgsICJzdHJ0b3Vs
bF9lcnI6IFVuZXhwZWN0ZWQgdmFsdWUiKTsKKworCWVyciA9IDA7CisJc21iX3N0cnRvdWwobnVt
YmVyMiwgJmVuZF9wdHIsIDAsICZlcnIsIFNNQl9TVFJfQUxMT1dfTkVHQVRJVkUpOworCXRvcnR1
cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAic3RydG91bF9lcnI6IFVuZXhwZWN0ZWQgZXJyb3Ii
KTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlbmRfcHRyWzBdID09ICctJywgInN0cnRvdWxfZXJy
OiBVbmV4cGVjdGVkIGVuZCBwb2ludGVyIik7CisKKwllcnIgPSAwOworCXNtYl9zdHJ0b3VsbChu
dW1iZXIyLCAmZW5kX3B0ciwgMCwgJmVyciwgU01CX1NUUl9BTExPV19ORUdBVElWRSk7CisJdG9y
dHVyZV9hc3NlcnQodGN0eCwgZXJyID09IDAsICJzdHJ0b3VsbF9lcnI6IFVuZXhwZWN0ZWQgZXJy
b3IiKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlbmRfcHRyWzBdID09ICctJywgInN0cnRvdWxs
X2VycjogVW5leHBlY3RlZCBlbmQgcG9pbnRlciIpOworCisJcmV0dXJuIHRydWU7Cit9CisKIHN0
cnVjdCB0b3J0dXJlX3N1aXRlICp0b3J0dXJlX2xvY2FsX3V0aWwoVEFMTE9DX0NUWCAqbWVtX2N0
eCkKIHsKIAlzdHJ1Y3QgdG9ydHVyZV9zdWl0ZSAqc3VpdGUgPQpAQCAtNTI2LDUgKzU2MSw4IEBA
IHN0cnVjdCB0b3J0dXJlX3N1aXRlICp0b3J0dXJlX2xvY2FsX3V0aWwoVEFMTE9DX0NUWCAqbWVt
X2N0eCkKIAl0b3J0dXJlX3N1aXRlX2FkZF9zaW1wbGVfdGVzdChzdWl0ZSwKIAkJCQkgICAgICAi
c21iX3N0cnRvdWwobCkgbm8gbnVtYmVyIiwKIAkJCQkgICAgICB0ZXN0X3NtYl9zdHJ0b3VsX25v
X251bWJlcik7CisJdG9ydHVyZV9zdWl0ZV9hZGRfc2ltcGxlX3Rlc3Qoc3VpdGUsCisJCQkJICAg
ICAgInNtYl9zdHJ0b3VsKGwpIGFsbG93X25lZ2F0aXZlIiwKKwkJCQkgICAgICB0ZXN0X3NtYl9z
dHJ0b3VsX2FsbG93X25lZ2F0aXZlKTsKIAlyZXR1cm4gc3VpdGU7CiB9Ci0tIAoyLjIwLjEKCgpG
cm9tIDEyNTVhNTlhYTA5YmVjNTBlYTNjZTAzMmI4MmNmYmE5NDQzN2JmMjIgTW9uIFNlcCAxNyAw
MDowMDowMCAyMDAxCkZyb206IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KRGF0
ZTogTW9uLCAzIEp1biAyMDE5IDEwOjM3OjA3ICswMjAwClN1YmplY3Q6IFtQQVRDSCAxNS8xNl0g
dGVzdHMtdXRpbDogQWRkaW5nIHRlc3QgdG8gdmVyaWZ5CiAiZnVsbC1zdHJpbmctY29udmVyc2lv
biIgZmxhZwoKVGhlIHN0YW5kYXJkIHN0cmluZyB0byBpbnRlZ2VyIGNvbnZlcnNpb24gcm91dGlu
ZXMgc3RvcCBhdCB0aGUgZmlyc3QKY2hhcmFjdGVyIHdoaWNoIGNhbm5vdCBiZSBjb252ZXJ0ZWQg
dG8gYSBudW1iZXIuCkhvd2V2ZXIsIGlmIHN1Y2ggYSBjaGFyYWN0ZXIgaXMgZm91bmQsIGl0IGlz
IG5vdCBjb25zaWRlcmVkIGFuIGVycm9yLgpXaXRoIHRoZSBmbGFnICJTTUJfU1RSX0ZVTExfU1RS
X0NPTlYiIGVuYWJsZWQsIGFuIGVycm9yIHdpbGwgYmUgcmV0dXJuZWQKaWYgdGhlIHN0cmluZyBj
b3VsZCBub3QgYmUgY29udmVydGVkIGVudGlyZWx5LgoKU2lnbmVkLW9mZi1ieTogU3dlbiBTY2hp
bGxpZyA8c3dlbkBsaW51eC5pYm0uY29tPgotLS0KIGxpYi91dGlsL3Rlc3RzL3V0aWwuYyB8IDI4
ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDEgZmlsZSBjaGFuZ2VkLCAyOCBpbnNlcnRp
b25zKCspCgpkaWZmIC0tZ2l0IGEvbGliL3V0aWwvdGVzdHMvdXRpbC5jIGIvbGliL3V0aWwvdGVz
dHMvdXRpbC5jCmluZGV4IGYxMjAyMWZlMmEyLi40NzQxZjQ2NmIzNSAxMDA2NDQKLS0tIGEvbGli
L3V0aWwvdGVzdHMvdXRpbC5jCisrKyBiL2xpYi91dGlsL3Rlc3RzL3V0aWwuYwpAQCAtNTQxLDYg
KzU0MSwzMSBAQCBzdGF0aWMgYm9vbCB0ZXN0X3NtYl9zdHJ0b3VsX2FsbG93X25lZ2F0aXZlKHN0
cnVjdCB0b3J0dXJlX2NvbnRleHQgKnRjdHgpCiAJcmV0dXJuIHRydWU7CiB9CiAKK3N0YXRpYyBi
b29sIHRlc3Rfc21iX3N0cnRvdWxfZnVsbF9zdHJpbmcoc3RydWN0IHRvcnR1cmVfY29udGV4dCAq
dGN0eCkKK3sKKwljb25zdCBjaGFyICpudW1iZXIgPSAiMTIzICI7CisJY29uc3QgY2hhciAqbnVt
YmVyMiA9ICIxMjMiOworCWludCBlcnI7CisKKwllcnIgPSAwOworCXNtYl9zdHJ0b3VsKG51bWJl
ciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9GVUxMX1NUUl9DT05WKTsKKwl0b3J0dXJlX2Fzc2Vy
dCh0Y3R4LCBlcnIgPT0gRUlOVkFMLCAic3RydG91bF9lcnI6IEV4cGVjdGVkIEVJTlZBTCIpOwor
CisJZXJyID0gMDsKKwlzbWJfc3RydG91bGwobnVtYmVyLCBOVUxMLCAwLCAmZXJyLCBTTUJfU1RS
X0ZVTExfU1RSX0NPTlYpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSBFSU5WQUwsICJz
dHJ0b3VsbF9lcnI6IEV4cGVjdGVkIEVJTlZBTCIpOworCisJZXJyID0gMDsKKwlzbWJfc3RydG91
bChudW1iZXIyLCBOVUxMLCAwLCAmZXJyLCBTTUJfU1RSX0ZVTExfU1RSX0NPTlYpOworCXRvcnR1
cmVfYXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAic3RydG91bF9lcnI6IFVuZXhwZWN0ZWQgZXJyb3Ii
KTsKKworCWVyciA9IDA7CisJc21iX3N0cnRvdWxsKG51bWJlcjIsIE5VTEwsIDAsICZlcnIsIFNN
Ql9TVFJfRlVMTF9TVFJfQ09OVik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgZXJyID09IDAsICJz
dHJ0b3VsbF9lcnI6IFVuZXhwZWN0ZWQgZXJyb3IiKTsKKworCXJldHVybiB0cnVlOworfQorCiBz
dHJ1Y3QgdG9ydHVyZV9zdWl0ZSAqdG9ydHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1lbV9j
dHgpCiB7CiAJc3RydWN0IHRvcnR1cmVfc3VpdGUgKnN1aXRlID0KQEAgLTU2NCw1ICs1ODksOCBA
QCBzdHJ1Y3QgdG9ydHVyZV9zdWl0ZSAqdG9ydHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1l
bV9jdHgpCiAJdG9ydHVyZV9zdWl0ZV9hZGRfc2ltcGxlX3Rlc3Qoc3VpdGUsCiAJCQkJICAgICAg
InNtYl9zdHJ0b3VsKGwpIGFsbG93X25lZ2F0aXZlIiwKIAkJCQkgICAgICB0ZXN0X3NtYl9zdHJ0
b3VsX2FsbG93X25lZ2F0aXZlKTsKKwl0b3J0dXJlX3N1aXRlX2FkZF9zaW1wbGVfdGVzdChzdWl0
ZSwKKwkJCQkgICAgICAic21iX3N0cnRvdWwobCkgZnVsbCBzdHJpbmcgY29udmVyc2lvbiIsCisJ
CQkJICAgICAgdGVzdF9zbWJfc3RydG91bF9mdWxsX3N0cmluZyk7CiAJcmV0dXJuIHN1aXRlOwog
fQotLSAKMi4yMC4xCgoKRnJvbSBjMzBkMGFiNWJiNWRiYjRiNTdkMTlhYTUyNmQ1OTU1YmU1ZGRj
YjUwIE1vbiBTZXAgMTcgMDA6MDA6MDAgMjAwMQpGcm9tOiBTd2VuIFNjaGlsbGlnIDxzd2VuQGxp
bnV4LmlibS5jb20+CkRhdGU6IE1vbiwgMyBKdW4gMjAxOSAxMDo1ODoxMSArMDIwMApTdWJqZWN0
OiBbUEFUQ0ggMTYvMTZdIHRlc3RzLXV0aWw6IEFkZGluZyB0ZXN0IHRvIHZlcmlmeSAiYWxsb3cg
bm8gY29udmVyc2lvbiIKIGZsYWcKClRoZSBpbnRlcm5hbCBzdHJpbmcgY29udmVyc2lvbiByb3V0
aW5lcyBzbWJfc3RydG91bChsKSByZXR1cm4KYW4gZXJyb3IgaWYgdGhlIHByb3ZpZGVkIHN0cmlu
ZyBjb3VsZCBub3QgYmUgY29udmVydGVkIHRvIGFuIGludGVnZXIuClRoaXMgY2FuIGJlIHRoZSBj
YXNlIGlmIHRoZSBzdHJpbmcgaXMgZW1wdHkgb3IgaWYgaXQgc3RhcnRzIHdpdGggbm9uLW51bWVy
aWMKY2hhcmFjdGVycyB3aGljaCBjYW5ub3QgYmUgY29udmVydGVkLgpUaGUgc3RhbmRhcmQgQyBs
aWJyYXJ5LCBob3dldmVyLCBkb2VzIGFsbG93IHRoaXMgYW5kIHNpbXBseSByZXR1cm5zIDAgYXMg
dGhlCmNvbnZlcnRlZCB2YWx1ZS4KSWYgdGhpcyBiZWhhdmlvdXIgaXMgd2FudGVkLCBpdCBjYW4g
YmUgZW5hYmxlZCBieSB1c2luZwp0aGUgIlNNQl9TVFJfQUxMT1dfTk9fQ09OVkVSU0lPTiIgZmxh
Zy4KClNpZ25lZC1vZmYtYnk6IFN3ZW4gU2NoaWxsaWcgPHN3ZW5AbGludXguaWJtLmNvbT4KLS0t
CiBsaWIvdXRpbC90ZXN0cy91dGlsLmMgfCAzMyArKysrKysrKysrKysrKysrKysrKysrKysrKysr
KysrKysKIDEgZmlsZSBjaGFuZ2VkLCAzMyBpbnNlcnRpb25zKCspCgpkaWZmIC0tZ2l0IGEvbGli
L3V0aWwvdGVzdHMvdXRpbC5jIGIvbGliL3V0aWwvdGVzdHMvdXRpbC5jCmluZGV4IDQ3NDFmNDY2
YjM1Li40ODc2MTQ0YmNkYyAxMDA2NDQKLS0tIGEvbGliL3V0aWwvdGVzdHMvdXRpbC5jCisrKyBi
L2xpYi91dGlsL3Rlc3RzL3V0aWwuYwpAQCAtNTY2LDYgKzU2NiwzNiBAQCBzdGF0aWMgYm9vbCB0
ZXN0X3NtYl9zdHJ0b3VsX2Z1bGxfc3RyaW5nKHN0cnVjdCB0b3J0dXJlX2NvbnRleHQgKnRjdHgp
CiAJcmV0dXJuIHRydWU7CiB9CiAKK3N0YXRpYyBib29sIHRlc3Rfc21iX3N0cnRvdWxfYWxsb3df
bm9fY29udmVyc2lvbihzdHJ1Y3QgdG9ydHVyZV9jb250ZXh0ICp0Y3R4KQoreworCWNvbnN0IGNo
YXIgKm51bWJlciA9ICIiOworCWNvbnN0IGNoYXIgKm51bWJlcjIgPSAieHl6IjsKKwl1bnNpZ25l
ZCBsb25nIGludCBuMSA9IDA7CisJdW5zaWduZWQgbG9uZyBsb25nIGludCBuMiA9IDA7CisJaW50
IGVycjsKKworCWVyciA9IDA7CisJc21iX3N0cnRvdWwobnVtYmVyLCBOVUxMLCAwLCAmZXJyLCBT
TUJfU1RSX0FMTE9XX05PX0NPTlZFUlNJT04pOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIGVyciA9
PSAwLCAic3RydG91bF9lcnI6IFVuZXhwZWN0ZWQgZXJyb3IiKTsKKwl0b3J0dXJlX2Fzc2VydCh0
Y3R4LCBuMSA9PSAwLCAic3RydG91bF9lcnI6IFVuZXhwZWN0ZWQgdmFsdWUiKTsKKworCWVyciA9
IDA7CisJc21iX3N0cnRvdWxsKG51bWJlciwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9BTExPV19O
T19DT05WRVJTSU9OKTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxs
X2VycjogVW5leHBlY3RlZCBlcnJvciIpOworCXRvcnR1cmVfYXNzZXJ0KHRjdHgsIG4yID09IDAs
ICJzdHJ0b3VsbF9lcnI6IFVuZXhwZWN0ZWQgdmFsdWUiKTsKKworCWVyciA9IDA7CisJc21iX3N0
cnRvdWwobnVtYmVyMiwgTlVMTCwgMCwgJmVyciwgU01CX1NUUl9BTExPV19OT19DT05WRVJTSU9O
KTsKKwl0b3J0dXJlX2Fzc2VydCh0Y3R4LCBlcnIgPT0gMCwgInN0cnRvdWxfZXJyOiBVbmV4cGVj
dGVkIGVycm9yIik7CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgbjEgPT0gMCwgInN0cnRvdWxfZXJy
OiBVbmV4cGVjdGVkIHZhbHVlIik7CisKKwllcnIgPSAwOworCXNtYl9zdHJ0b3VsbChudW1iZXIy
LCBOVUxMLCAwLCAmZXJyLCBTTUJfU1RSX0FMTE9XX05PX0NPTlZFUlNJT04pOworCXRvcnR1cmVf
YXNzZXJ0KHRjdHgsIGVyciA9PSAwLCAic3RydG91bGxfZXJyOiBVbmV4cGVjdGVkIGVycm9yIik7
CisJdG9ydHVyZV9hc3NlcnQodGN0eCwgbjIgPT0gMCwgInN0cnRvdWxsX2VycjogVW5leHBlY3Rl
ZCB2YWx1ZSIpOworCisJcmV0dXJuIHRydWU7Cit9CiBzdHJ1Y3QgdG9ydHVyZV9zdWl0ZSAqdG9y
dHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1lbV9jdHgpCiB7CiAJc3RydWN0IHRvcnR1cmVf
c3VpdGUgKnN1aXRlID0KQEAgLTU5Miw1ICs2MjIsOCBAQCBzdHJ1Y3QgdG9ydHVyZV9zdWl0ZSAq
dG9ydHVyZV9sb2NhbF91dGlsKFRBTExPQ19DVFggKm1lbV9jdHgpCiAJdG9ydHVyZV9zdWl0ZV9h
ZGRfc2ltcGxlX3Rlc3Qoc3VpdGUsCiAJCQkJICAgICAgInNtYl9zdHJ0b3VsKGwpIGZ1bGwgc3Ry
aW5nIGNvbnZlcnNpb24iLAogCQkJCSAgICAgIHRlc3Rfc21iX3N0cnRvdWxfZnVsbF9zdHJpbmcp
OworCXRvcnR1cmVfc3VpdGVfYWRkX3NpbXBsZV90ZXN0KHN1aXRlLAorCQkJCSAgICAgICJzbWJf
c3RydG91bChsKSBhbGxvdyBubyBjb252ZXJzaW9uIiwKKwkJCQkgICAgICB0ZXN0X3NtYl9zdHJ0
b3VsX2FsbG93X25vX2NvbnZlcnNpb24pOwogCXJldHVybiBzdWl0ZTsKIH0KLS0gCjIuMjAuMQoK



--=-/8yrzXpqEyENfuCgjwZA--

--=-hY/HHbRTIxHiA8ImEvEZ
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: This is a digitally signed message part
Content-Transfer-Encoding: 7bit

-----BEGIN PGP SIGNATURE-----

iQIyBAABCgAdFiEErGbWt5PHCTgy2J0tug2knLYPYasFAlz2KTAACgkQug2knLYP
Yasaeg/43Jcv2AdvWHO7VxJGrswo5ODq5ppfwvNS0XGAaxLCq7DJPTUTp+Y5ScJ1
5M2ZugoDeCG7jisxoADGZkhM7rjyXV832BorJSd28z1Ed3ZEfpwCAt/15wf+wB7X
WRnPKrLBg5Bzrc3+BV0a3w+cmGRhRL76SYLbWMHDf6wFmQ23vKYZszzkZTThQDw8
7crxe+x1Ea7kcbMTpsDt6CjHpLMBpe7pQ5hqOSlw1ezqF1YMupwCzxQ3CAFjsOLm
Io0zh3+VfqYfZ4P8mIG95bToLVL+AtpZfBXH70crJHUuV7IGQwZaE/tei4Rt8KUw
o64+BV8838ky+fKvykKgiGDIgHzIVio/zWCoSJBwu4Jez1b1NltOa6/ai/CfabOe
lWmQVg1BQVJoVTbwuI51W/NtXj9YseuVyvCP/HwDRnuV2R254d6RvYQjFw70mVN6
OnVfObJY1eI1JIxXbRsKRPYvwSPtZixROlkpky9llHhPRJO2sRHS8Y+k7DsOJOWP
DbBlMVa4pQrrZwJSKv71BZxFTxDnCEu1CHrw+Y/Fq2ekHYZMyuCcBFieTU0FuEXl
SAQtNepqjOU1h/iX837NtlCMHvRxIYIN82bbm8IqWayUy88s2IAhMzwsvpG5XawL
TGudl5nB4nYZ3Ec/6bDgyxVGPVOcNUo0fj/9C07aaHZUyH9/FQ==
=F+h5
-----END PGP SIGNATURE-----

--=-hY/HHbRTIxHiA8ImEvEZ--


